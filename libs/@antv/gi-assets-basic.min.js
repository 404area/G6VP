/*! For license information please see index.min.js.LICENSE.txt */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("G2Plot"),require("G6"),require("GISDK"),require("Graphin"),require("React"),require("ReactDOM"),require("_"),require("antd")):"function"==typeof define&&define.amd?define(["G2Plot","G6","GISDK","Graphin","React","ReactDOM","_","antd"],t):"object"==typeof exports?exports.GI_ASSETS_BASIC=t(require("G2Plot"),require("G6"),require("GISDK"),require("Graphin"),require("React"),require("ReactDOM"),require("_"),require("antd")):e.GI_ASSETS_BASIC=t(e.G2Plot,e.G6,e.GISDK,e.Graphin,e.React,e.ReactDOM,e._,e.antd)}(self,((e,t,n,r,o,i,a,s)=>(()=>{var l={448:(e,t,n)=>{"use strict";n.d(t,{Z:()=>d});var r,o=n(24),i=n.n(o);e=n.hmd(e),(r="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&r(e),"undefined"!=typeof reactHotLoaderGlobal&&reactHotLoaderGlobal.default.signature;var a={left:{left:"100%",top:"30%",height:"80px",width:"38px",borderColor:"transparent transparent transparent var(--border-color)"},right:{right:"100%",top:"30%",height:"80px",width:"38px",borderColor:"transparent var(--border-color) transparent transparent"},bottom:{left:"10%",bottom:"calc(100% + 1px)",height:"38px",width:"80px",borderColor:"transparent transparent var(--border-color) transparent"}},s={left:{left:"calc(100% - 1px)",top:"30%",height:"80px",width:"38px",borderColor:"transparent transparent transparent var(--background-color)"},right:{right:"calc(100% - 1px)",top:"30%",height:"80px",width:"38px",borderColor:"transparent var(--background-color) transparent transparent "},bottom:{left:"10%",bottom:"100%",height:"38px",width:"80px",borderColor:"transparent transparent var(--background-color)  transparent"}},l={left:{left:"-15px",top:"8px"},right:{left:"5px",top:"8px"},bottom:{left:"15px",top:"0"}},c=function(e){var t=e.handleClick,n=e.type,r=Object.assign({position:"absolute",borderStyle:"solid",borderWidth:"20px"},a[n]),o=Object.assign({position:"absolute",cursor:"pointer",borderStyle:"solid",borderWidth:"20px"},s[n]),c=Object.assign({position:"absolute"},l[n]);return i().createElement(i().Fragment,null,i().createElement("div",{style:r}),i().createElement("div",{onClick:t,style:o},i().createElement("span",{style:c},"bottom"===n?"=":"||")))},u=c;const d=u;var p,f;(p="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&(p.register(a,"backStyleMap","/Users/pomelo/Desktop/github/GraphInsight/packages/gi-common-components/es/Handler/index.js"),p.register(s,"handlerStyleMap","/Users/pomelo/Desktop/github/GraphInsight/packages/gi-common-components/es/Handler/index.js"),p.register(l,"textStyleMap","/Users/pomelo/Desktop/github/GraphInsight/packages/gi-common-components/es/Handler/index.js"),p.register(c,"Handler","/Users/pomelo/Desktop/github/GraphInsight/packages/gi-common-components/es/Handler/index.js"),p.register(u,"default","/Users/pomelo/Desktop/github/GraphInsight/packages/gi-common-components/es/Handler/index.js")),(f="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&f(e)},608:(e,t)=>{var n;!function(){"use strict";var r={}.hasOwnProperty;function o(){for(var e=[],t=0;t<arguments.length;t++){var n=arguments[t];if(n){var i=typeof n;if("string"===i||"number"===i)e.push(n);else if(Array.isArray(n)){if(n.length){var a=o.apply(null,n);a&&e.push(a)}}else if("object"===i){if(n.toString!==Object.prototype.toString&&!n.toString.toString().includes("[native code]")){e.push(n.toString());continue}for(var s in n)r.call(n,s)&&n[s]&&e.push(s)}}}return e.join(" ")}e.exports?(o.default=o,e.exports=o):void 0===(n=function(){return o}.apply(t,[]))||(e.exports=n)}()},876:e=>{"use strict";var t=function(e){return function(e){return!!e&&"object"==typeof e}(e)&&!function(e){var t=Object.prototype.toString.call(e);return"[object RegExp]"===t||"[object Date]"===t||function(e){return e.$$typeof===n}(e)}(e)},n="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function r(e,t){return!1!==t.clone&&t.isMergeableObject(e)?s((n=e,Array.isArray(n)?[]:{}),e,t):e;var n}function o(e,t,n){return e.concat(t).map((function(e){return r(e,n)}))}function i(e){return Object.keys(e).concat(function(e){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e).filter((function(t){return Object.propertyIsEnumerable.call(e,t)})):[]}(e))}function a(e,t){try{return t in e}catch(e){return!1}}function s(e,n,l){(l=l||{}).arrayMerge=l.arrayMerge||o,l.isMergeableObject=l.isMergeableObject||t,l.cloneUnlessOtherwiseSpecified=r;var c=Array.isArray(n);return c===Array.isArray(e)?c?l.arrayMerge(e,n,l):function(e,t,n){var o={};return n.isMergeableObject(e)&&i(e).forEach((function(t){o[t]=r(e[t],n)})),i(t).forEach((function(i){(function(e,t){return a(e,t)&&!(Object.hasOwnProperty.call(e,t)&&Object.propertyIsEnumerable.call(e,t))})(e,i)||(a(e,i)&&n.isMergeableObject(t[i])?o[i]=function(e,t){if(!t.customMerge)return s;var n=t.customMerge(e);return"function"==typeof n?n:s}(i,n)(e[i],t[i],n):o[i]=r(t[i],n))})),o}(e,n,l):r(n,l)}s.all=function(e,t){if(!Array.isArray(e))throw new Error("first argument should be an array");return e.reduce((function(e,n){return s(e,n,t)}),{})};var l=s;e.exports=l},84:function(e,t,n){!function(e){"use strict";var t;function r(){}function o(){o.init.call(this)}function i(e){return void 0===e._maxListeners?o.defaultMaxListeners:e._maxListeners}function a(e,t,n,o){var a,s,l,c;if("function"!=typeof n)throw new TypeError('"listener" argument must be a function');if((s=e._events)?(s.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),s=e._events),l=s[t]):(s=e._events=new r,e._eventsCount=0),l){if("function"==typeof l?l=s[t]=o?[n,l]:[l,n]:o?l.unshift(n):l.push(n),!l.warned&&(a=i(e))&&a>0&&l.length>a){l.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+l.length+" "+t+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=e,u.type=t,u.count=l.length,c=u,"function"==typeof console.warn?console.warn(c):console.log(c)}}else l=s[t]=n,++e._eventsCount;return e}function s(e,t,n){var r=!1;function o(){e.removeListener(t,o),r||(r=!0,n.apply(e,arguments))}return o.listener=n,o}function l(e){var t=this._events;if(t){var n=t[e];if("function"==typeof n)return 1;if(n)return n.length}return 0}function c(e,t){for(var n=new Array(t);t--;)n[t]=e[t];return n}r.prototype=Object.create(null),o.EventEmitter=o,o.usingDomains=!1,o.prototype.domain=void 0,o.prototype._events=void 0,o.prototype._maxListeners=void 0,o.defaultMaxListeners=10,o.init=function(){this.domain=null,o.usingDomains&&t.active&&t.Domain,this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=new r,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},o.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=e,this},o.prototype.getMaxListeners=function(){return i(this)},o.prototype.emit=function(e){var t,n,r,o,i,a,s,l="error"===e;if(a=this._events)l=l&&null==a.error;else if(!l)return!1;if(s=this.domain,l){if(t=arguments[1],!s){if(t instanceof Error)throw t;var u=new Error('Uncaught, unspecified "error" event. ('+t+")");throw u.context=t,u}return t||(t=new Error('Uncaught, unspecified "error" event')),t.domainEmitter=this,t.domain=s,t.domainThrown=!1,s.emit("error",t),!1}if(!(n=a[e]))return!1;var d="function"==typeof n;switch(r=arguments.length){case 1:!function(e,t,n){if(t)e.call(n);else for(var r=e.length,o=c(e,r),i=0;i<r;++i)o[i].call(n)}(n,d,this);break;case 2:!function(e,t,n,r){if(t)e.call(n,r);else for(var o=e.length,i=c(e,o),a=0;a<o;++a)i[a].call(n,r)}(n,d,this,arguments[1]);break;case 3:!function(e,t,n,r,o){if(t)e.call(n,r,o);else for(var i=e.length,a=c(e,i),s=0;s<i;++s)a[s].call(n,r,o)}(n,d,this,arguments[1],arguments[2]);break;case 4:!function(e,t,n,r,o,i){if(t)e.call(n,r,o,i);else for(var a=e.length,s=c(e,a),l=0;l<a;++l)s[l].call(n,r,o,i)}(n,d,this,arguments[1],arguments[2],arguments[3]);break;default:for(o=new Array(r-1),i=1;i<r;i++)o[i-1]=arguments[i];!function(e,t,n,r){if(t)e.apply(n,r);else for(var o=e.length,i=c(e,o),a=0;a<o;++a)i[a].apply(n,r)}(n,d,this,o)}return!0},o.prototype.addListener=function(e,t){return a(this,e,t,!1)},o.prototype.on=o.prototype.addListener,o.prototype.prependListener=function(e,t){return a(this,e,t,!0)},o.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.on(e,s(this,e,t)),this},o.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.prependListener(e,s(this,e,t)),this},o.prototype.removeListener=function(e,t){var n,o,i,a,s;if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');if(!(o=this._events))return this;if(!(n=o[e]))return this;if(n===t||n.listener&&n.listener===t)0==--this._eventsCount?this._events=new r:(delete o[e],o.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(i=-1,a=n.length;a-- >0;)if(n[a]===t||n[a].listener&&n[a].listener===t){s=n[a].listener,i=a;break}if(i<0)return this;if(1===n.length){if(n[0]=void 0,0==--this._eventsCount)return this._events=new r,this;delete o[e]}else!function(e,t){for(var n=t,r=n+1,o=e.length;r<o;n+=1,r+=1)e[n]=e[r];e.pop()}(n,i);o.removeListener&&this.emit("removeListener",e,s||t)}return this},o.prototype.removeAllListeners=function(e){var t,n;if(!(n=this._events))return this;if(!n.removeListener)return 0===arguments.length?(this._events=new r,this._eventsCount=0):n[e]&&(0==--this._eventsCount?this._events=new r:delete n[e]),this;if(0===arguments.length){for(var o,i=Object.keys(n),a=0;a<i.length;++a)"removeListener"!==(o=i[a])&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=new r,this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(t)do{this.removeListener(e,t[t.length-1])}while(t[0]);return this},o.prototype.listeners=function(e){var t,n=this._events;return n&&(t=n[e])?"function"==typeof t?[t.listener||t]:function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(t):[]},o.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):l.call(e,t)},o.prototype.listenerCount=l,o.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};var u=void 0!==n.g?n.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},d=[],p=[],f="undefined"!=typeof Uint8Array?Uint8Array:Array,h=!1;function m(){h=!0;for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=0;t<64;++t)d[t]=e[t],p[e.charCodeAt(t)]=t;p["-".charCodeAt(0)]=62,p["_".charCodeAt(0)]=63}function g(e,t,n){for(var r,o=[],i=t;i<n;i+=3)r=(e[i]<<16)+(e[i+1]<<8)+e[i+2],o.push(d[(a=r)>>18&63]+d[a>>12&63]+d[a>>6&63]+d[63&a]);var a;return o.join("")}function y(e){var t;h||m();for(var n=e.length,r=n%3,o="",i=[],a=16383,s=0,l=n-r;s<l;s+=a)i.push(g(e,s,s+a>l?l:s+a));return 1===r?(t=e[n-1],o+=d[t>>2],o+=d[t<<4&63],o+="=="):2===r&&(t=(e[n-2]<<8)+e[n-1],o+=d[t>>10],o+=d[t>>4&63],o+=d[t<<2&63],o+="="),i.push(o),i.join("")}function v(e,t,n,r,o){var i,a,s=8*o-r-1,l=(1<<s)-1,c=l>>1,u=-7,d=n?o-1:0,p=n?-1:1,f=e[t+d];for(d+=p,i=f&(1<<-u)-1,f>>=-u,u+=s;u>0;i=256*i+e[t+d],d+=p,u-=8);for(a=i&(1<<-u)-1,i>>=-u,u+=r;u>0;a=256*a+e[t+d],d+=p,u-=8);if(0===i)i=1-c;else{if(i===l)return a?NaN:1/0*(f?-1:1);a+=Math.pow(2,r),i-=c}return(f?-1:1)*a*Math.pow(2,i-r)}function b(e,t,n,r,o,i){var a,s,l,c=8*i-o-1,u=(1<<c)-1,d=u>>1,p=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,f=r?0:i-1,h=r?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=u):(a=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-a))<1&&(a--,l*=2),(t+=a+d>=1?p/l:p*Math.pow(2,1-d))*l>=2&&(a++,l/=2),a+d>=u?(s=0,a=u):a+d>=1?(s=(t*l-1)*Math.pow(2,o),a+=d):(s=t*Math.pow(2,d-1)*Math.pow(2,o),a=0));o>=8;e[n+f]=255&s,f+=h,s/=256,o-=8);for(a=a<<o|s,c+=o;c>0;e[n+f]=255&a,f+=h,a/=256,c-=8);e[n+f-h]|=128*m}var x={}.toString,E=Array.isArray||function(e){return"[object Array]"==x.call(e)};function I(){return C.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function w(e,t){if(I()<t)throw new RangeError("Invalid typed array length");return C.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=C.prototype:(null===e&&(e=new C(t)),e.length=t),e}function C(e,t,n){if(!(C.TYPED_ARRAY_SUPPORT||this instanceof C))return new C(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return T(this,e)}return S(this,e,t,n)}function S(e,t,n,r){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,r){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");return t=void 0===n&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,n):new Uint8Array(t,n,r),C.TYPED_ARRAY_SUPPORT?(e=t).__proto__=C.prototype:e=A(e,t),e}(e,t,n,r):"string"==typeof t?function(e,t,n){if("string"==typeof n&&""!==n||(n="utf8"),!C.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|_(t,n),o=(e=w(e,r)).write(t,n);return o!==r&&(e=e.slice(0,o)),e}(e,t,n):function(e,t){if(k(t)){var n=0|N(t.length);return 0===(e=w(e,n)).length||t.copy(e,0,0,n),e}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(r=t.length)!=r?w(e,0):A(e,t);if("Buffer"===t.type&&E(t.data))return A(e,t.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function O(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function T(e,t){if(O(t),e=w(e,t<0?0:0|N(t)),!C.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function A(e,t){var n=t.length<0?0:0|N(t.length);e=w(e,n);for(var r=0;r<n;r+=1)e[r]=255&t[r];return e}function N(e){if(e>=I())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+I().toString(16)+" bytes");return 0|e}function k(e){return!(null==e||!e._isBuffer)}function _(e,t){if(k(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return re(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return oe(e).length;default:if(r)return re(e).length;t=(""+t).toLowerCase(),r=!0}}function j(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return W(this,t,n);case"utf8":case"utf-8":return q(this,t,n);case"ascii":return V(this,t,n);case"latin1":case"binary":return H(this,t,n);case"base64":return $(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return K(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function F(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function P(e,t,n,r,o){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=o?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(o)return-1;n=e.length-1}else if(n<0){if(!o)return-1;n=0}if("string"==typeof t&&(t=C.from(t,r)),k(t))return 0===t.length?-1:M(e,t,n,r,o);if("number"==typeof t)return t&=255,C.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):M(e,[t],n,r,o);throw new TypeError("val must be string, number or Buffer")}function M(e,t,n,r,o){var i,a=1,s=e.length,l=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;a=2,s/=2,l/=2,n/=2}function c(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(o){var u=-1;for(i=n;i<s;i++)if(c(e,i)===c(t,-1===u?0:i-u)){if(-1===u&&(u=i),i-u+1===l)return u*a}else-1!==u&&(i-=i-u),u=-1}else for(n+l>s&&(n=s-l),i=n;i>=0;i--){for(var d=!0,p=0;p<l;p++)if(c(e,i+p)!==c(t,p)){d=!1;break}if(d)return i}return-1}function R(e,t,n,r){n=Number(n)||0;var o=e.length-n;r?(r=Number(r))>o&&(r=o):r=o;var i=t.length;if(i%2!=0)throw new TypeError("Invalid hex string");r>i/2&&(r=i/2);for(var a=0;a<r;++a){var s=parseInt(t.substr(2*a,2),16);if(isNaN(s))return a;e[n+a]=s}return a}function L(e,t,n,r){return ie(re(t,e.length-n),e,n,r)}function G(e,t,n,r){return ie(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function D(e,t,n,r){return G(e,t,n,r)}function B(e,t,n,r){return ie(oe(t),e,n,r)}function z(e,t,n,r){return ie(function(e,t){for(var n,r,o,i=[],a=0;a<e.length&&!((t-=2)<0);++a)r=(n=e.charCodeAt(a))>>8,o=n%256,i.push(o),i.push(r);return i}(t,e.length-n),e,n,r)}function $(e,t,n){return 0===t&&n===e.length?y(e):y(e.slice(t,n))}function q(e,t,n){n=Math.min(e.length,n);for(var r=[],o=t;o<n;){var i,a,s,l,c=e[o],u=null,d=c>239?4:c>223?3:c>191?2:1;if(o+d<=n)switch(d){case 1:c<128&&(u=c);break;case 2:128==(192&(i=e[o+1]))&&(l=(31&c)<<6|63&i)>127&&(u=l);break;case 3:i=e[o+1],a=e[o+2],128==(192&i)&&128==(192&a)&&(l=(15&c)<<12|(63&i)<<6|63&a)>2047&&(l<55296||l>57343)&&(u=l);break;case 4:i=e[o+1],a=e[o+2],s=e[o+3],128==(192&i)&&128==(192&a)&&128==(192&s)&&(l=(15&c)<<18|(63&i)<<12|(63&a)<<6|63&s)>65535&&l<1114112&&(u=l)}null===u?(u=65533,d=1):u>65535&&(u-=65536,r.push(u>>>10&1023|55296),u=56320|1023&u),r.push(u),o+=d}return function(e){var t=e.length;if(t<=U)return String.fromCharCode.apply(String,e);for(var n="",r=0;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=U));return n}(r)}C.TYPED_ARRAY_SUPPORT=void 0===u.TYPED_ARRAY_SUPPORT||u.TYPED_ARRAY_SUPPORT,C.poolSize=8192,C._augment=function(e){return e.__proto__=C.prototype,e},C.from=function(e,t,n){return S(null,e,t,n)},C.TYPED_ARRAY_SUPPORT&&(C.prototype.__proto__=Uint8Array.prototype,C.__proto__=Uint8Array),C.alloc=function(e,t,n){return function(e,t,n,r){return O(t),t<=0?w(e,t):void 0!==n?"string"==typeof r?w(e,t).fill(n,r):w(e,t).fill(n):w(e,t)}(null,e,t,n)},C.allocUnsafe=function(e){return T(null,e)},C.allocUnsafeSlow=function(e){return T(null,e)},C.isBuffer=ae,C.compare=function(e,t){if(!k(e)||!k(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,r=t.length,o=0,i=Math.min(n,r);o<i;++o)if(e[o]!==t[o]){n=e[o],r=t[o];break}return n<r?-1:r<n?1:0},C.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},C.concat=function(e,t){if(!E(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return C.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=C.allocUnsafe(t),o=0;for(n=0;n<e.length;++n){var i=e[n];if(!k(i))throw new TypeError('"list" argument must be an Array of Buffers');i.copy(r,o),o+=i.length}return r},C.byteLength=_,C.prototype._isBuffer=!0,C.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)F(this,t,t+1);return this},C.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)F(this,t,t+3),F(this,t+1,t+2);return this},C.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)F(this,t,t+7),F(this,t+1,t+6),F(this,t+2,t+5),F(this,t+3,t+4);return this},C.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?q(this,0,e):j.apply(this,arguments)},C.prototype.equals=function(e){if(!k(e))throw new TypeError("Argument must be a Buffer");return this===e||0===C.compare(this,e)},C.prototype.inspect=function(){var e="";return this.length>0&&(e=this.toString("hex",0,50).match(/.{2}/g).join(" "),this.length>50&&(e+=" ... ")),"<Buffer "+e+">"},C.prototype.compare=function(e,t,n,r,o){if(!k(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===o&&(o=this.length),t<0||n>e.length||r<0||o>this.length)throw new RangeError("out of range index");if(r>=o&&t>=n)return 0;if(r>=o)return-1;if(t>=n)return 1;if(this===e)return 0;for(var i=(o>>>=0)-(r>>>=0),a=(n>>>=0)-(t>>>=0),s=Math.min(i,a),l=this.slice(r,o),c=e.slice(t,n),u=0;u<s;++u)if(l[u]!==c[u]){i=l[u],a=c[u];break}return i<a?-1:a<i?1:0},C.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},C.prototype.indexOf=function(e,t,n){return P(this,e,t,n,!0)},C.prototype.lastIndexOf=function(e,t,n){return P(this,e,t,n,!1)},C.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var o=this.length-t;if((void 0===n||n>o)&&(n=o),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var i=!1;;)switch(r){case"hex":return R(this,e,t,n);case"utf8":case"utf-8":return L(this,e,t,n);case"ascii":return G(this,e,t,n);case"latin1":case"binary":return D(this,e,t,n);case"base64":return B(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return z(this,e,t,n);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),i=!0}},C.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var U=4096;function V(e,t,n){var r="";n=Math.min(e.length,n);for(var o=t;o<n;++o)r+=String.fromCharCode(127&e[o]);return r}function H(e,t,n){var r="";n=Math.min(e.length,n);for(var o=t;o<n;++o)r+=String.fromCharCode(e[o]);return r}function W(e,t,n){var r,o=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>o)&&(n=o);for(var i="",a=t;a<n;++a)i+=(r=e[a])<16?"0"+r.toString(16):r.toString(16);return i}function K(e,t,n){for(var r=e.slice(t,n),o="",i=0;i<r.length;i+=2)o+=String.fromCharCode(r[i]+256*r[i+1]);return o}function Y(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function X(e,t,n,r,o,i){if(!k(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>o||t<i)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function Q(e,t,n,r){t<0&&(t=65535+t+1);for(var o=0,i=Math.min(e.length-n,2);o<i;++o)e[n+o]=(t&255<<8*(r?o:1-o))>>>8*(r?o:1-o)}function J(e,t,n,r){t<0&&(t=4294967295+t+1);for(var o=0,i=Math.min(e.length-n,4);o<i;++o)e[n+o]=t>>>8*(r?o:3-o)&255}function Z(e,t,n,r,o,i){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function ee(e,t,n,r,o){return o||Z(e,0,n,4),b(e,t,n,r,23,4),n+4}function te(e,t,n,r,o){return o||Z(e,0,n,8),b(e,t,n,r,52,8),n+8}C.prototype.slice=function(e,t){var n,r=this.length;if((e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e),C.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,t)).__proto__=C.prototype;else{var o=t-e;n=new C(o,void 0);for(var i=0;i<o;++i)n[i]=this[i+e]}return n},C.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||Y(e,t,this.length);for(var r=this[e],o=1,i=0;++i<t&&(o*=256);)r+=this[e+i]*o;return r},C.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||Y(e,t,this.length);for(var r=this[e+--t],o=1;t>0&&(o*=256);)r+=this[e+--t]*o;return r},C.prototype.readUInt8=function(e,t){return t||Y(e,1,this.length),this[e]},C.prototype.readUInt16LE=function(e,t){return t||Y(e,2,this.length),this[e]|this[e+1]<<8},C.prototype.readUInt16BE=function(e,t){return t||Y(e,2,this.length),this[e]<<8|this[e+1]},C.prototype.readUInt32LE=function(e,t){return t||Y(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},C.prototype.readUInt32BE=function(e,t){return t||Y(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},C.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||Y(e,t,this.length);for(var r=this[e],o=1,i=0;++i<t&&(o*=256);)r+=this[e+i]*o;return r>=(o*=128)&&(r-=Math.pow(2,8*t)),r},C.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||Y(e,t,this.length);for(var r=t,o=1,i=this[e+--r];r>0&&(o*=256);)i+=this[e+--r]*o;return i>=(o*=128)&&(i-=Math.pow(2,8*t)),i},C.prototype.readInt8=function(e,t){return t||Y(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},C.prototype.readInt16LE=function(e,t){t||Y(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},C.prototype.readInt16BE=function(e,t){t||Y(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},C.prototype.readInt32LE=function(e,t){return t||Y(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},C.prototype.readInt32BE=function(e,t){return t||Y(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},C.prototype.readFloatLE=function(e,t){return t||Y(e,4,this.length),v(this,e,!0,23,4)},C.prototype.readFloatBE=function(e,t){return t||Y(e,4,this.length),v(this,e,!1,23,4)},C.prototype.readDoubleLE=function(e,t){return t||Y(e,8,this.length),v(this,e,!0,52,8)},C.prototype.readDoubleBE=function(e,t){return t||Y(e,8,this.length),v(this,e,!1,52,8)},C.prototype.writeUIntLE=function(e,t,n,r){e=+e,t|=0,n|=0,r||X(this,e,t,n,Math.pow(2,8*n)-1,0);var o=1,i=0;for(this[t]=255&e;++i<n&&(o*=256);)this[t+i]=e/o&255;return t+n},C.prototype.writeUIntBE=function(e,t,n,r){e=+e,t|=0,n|=0,r||X(this,e,t,n,Math.pow(2,8*n)-1,0);var o=n-1,i=1;for(this[t+o]=255&e;--o>=0&&(i*=256);)this[t+o]=e/i&255;return t+n},C.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||X(this,e,t,1,255,0),C.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},C.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||X(this,e,t,2,65535,0),C.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):Q(this,e,t,!0),t+2},C.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||X(this,e,t,2,65535,0),C.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):Q(this,e,t,!1),t+2},C.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||X(this,e,t,4,4294967295,0),C.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):J(this,e,t,!0),t+4},C.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||X(this,e,t,4,4294967295,0),C.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):J(this,e,t,!1),t+4},C.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t|=0,!r){var o=Math.pow(2,8*n-1);X(this,e,t,n,o-1,-o)}var i=0,a=1,s=0;for(this[t]=255&e;++i<n&&(a*=256);)e<0&&0===s&&0!==this[t+i-1]&&(s=1),this[t+i]=(e/a>>0)-s&255;return t+n},C.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t|=0,!r){var o=Math.pow(2,8*n-1);X(this,e,t,n,o-1,-o)}var i=n-1,a=1,s=0;for(this[t+i]=255&e;--i>=0&&(a*=256);)e<0&&0===s&&0!==this[t+i+1]&&(s=1),this[t+i]=(e/a>>0)-s&255;return t+n},C.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||X(this,e,t,1,127,-128),C.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},C.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||X(this,e,t,2,32767,-32768),C.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):Q(this,e,t,!0),t+2},C.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||X(this,e,t,2,32767,-32768),C.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):Q(this,e,t,!1),t+2},C.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||X(this,e,t,4,2147483647,-2147483648),C.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):J(this,e,t,!0),t+4},C.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||X(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),C.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):J(this,e,t,!1),t+4},C.prototype.writeFloatLE=function(e,t,n){return ee(this,e,t,!0,n)},C.prototype.writeFloatBE=function(e,t,n){return ee(this,e,t,!1,n)},C.prototype.writeDoubleLE=function(e,t,n){return te(this,e,t,!0,n)},C.prototype.writeDoubleBE=function(e,t,n){return te(this,e,t,!1,n)},C.prototype.copy=function(e,t,n,r){if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var o,i=r-n;if(this===e&&n<t&&t<r)for(o=i-1;o>=0;--o)e[o+t]=this[o+n];else if(i<1e3||!C.TYPED_ARRAY_SUPPORT)for(o=0;o<i;++o)e[o+t]=this[o+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+i),t);return i},C.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===e.length){var o=e.charCodeAt(0);o<256&&(e=o)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!C.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var i;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(i=t;i<n;++i)this[i]=e;else{var a=k(e)?e:re(new C(e,r).toString()),s=a.length;for(i=0;i<n-t;++i)this[i+t]=a[i%s]}return this};var ne=/[^+\/0-9A-Za-z-_]/g;function re(e,t){var n;t=t||1/0;for(var r=e.length,o=null,i=[],a=0;a<r;++a){if((n=e.charCodeAt(a))>55295&&n<57344){if(!o){if(n>56319){(t-=3)>-1&&i.push(239,191,189);continue}if(a+1===r){(t-=3)>-1&&i.push(239,191,189);continue}o=n;continue}if(n<56320){(t-=3)>-1&&i.push(239,191,189),o=n;continue}n=65536+(o-55296<<10|n-56320)}else o&&(t-=3)>-1&&i.push(239,191,189);if(o=null,n<128){if((t-=1)<0)break;i.push(n)}else if(n<2048){if((t-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return i}function oe(e){return function(e){var t,n,r,o,i,a;h||m();var s=e.length;if(s%4>0)throw new Error("Invalid string. Length must be a multiple of 4");i="="===e[s-2]?2:"="===e[s-1]?1:0,a=new f(3*s/4-i),r=i>0?s-4:s;var l=0;for(t=0,n=0;t<r;t+=4,n+=3)o=p[e.charCodeAt(t)]<<18|p[e.charCodeAt(t+1)]<<12|p[e.charCodeAt(t+2)]<<6|p[e.charCodeAt(t+3)],a[l++]=o>>16&255,a[l++]=o>>8&255,a[l++]=255&o;return 2===i?(o=p[e.charCodeAt(t)]<<2|p[e.charCodeAt(t+1)]>>4,a[l++]=255&o):1===i&&(o=p[e.charCodeAt(t)]<<10|p[e.charCodeAt(t+1)]<<4|p[e.charCodeAt(t+2)]>>2,a[l++]=o>>8&255,a[l++]=255&o),a}(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(ne,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function ie(e,t,n,r){for(var o=0;o<r&&!(o+n>=t.length||o>=e.length);++o)t[o+n]=e[o];return o}function ae(e){return null!=e&&(!!e._isBuffer||se(e)||function(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&se(e.slice(0,0))}(e))}function se(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}function le(){throw new Error("setTimeout has not been defined")}function ce(){throw new Error("clearTimeout has not been defined")}var ue=le,de=ce;function pe(e){if(ue===setTimeout)return setTimeout(e,0);if((ue===le||!ue)&&setTimeout)return ue=setTimeout,setTimeout(e,0);try{return ue(e,0)}catch(t){try{return ue.call(null,e,0)}catch(t){return ue.call(this,e,0)}}}"function"==typeof u.setTimeout&&(ue=setTimeout),"function"==typeof u.clearTimeout&&(de=clearTimeout);var fe,he=[],me=!1,ge=-1;function ye(){me&&fe&&(me=!1,fe.length?he=fe.concat(he):ge=-1,he.length&&ve())}function ve(){if(!me){var e=pe(ye);me=!0;for(var t=he.length;t;){for(fe=he,he=[];++ge<t;)fe&&fe[ge].run();ge=-1,t=he.length}fe=null,me=!1,function(e){if(de===clearTimeout)return clearTimeout(e);if((de===ce||!de)&&clearTimeout)return de=clearTimeout,clearTimeout(e);try{return de(e)}catch(t){try{return de.call(null,e)}catch(t){return de.call(this,e)}}}(e)}}function be(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];he.push(new xe(e,t)),1!==he.length||me||pe(ve)}function xe(e,t){this.fun=e,this.array=t}xe.prototype.run=function(){this.fun.apply(null,this.array)};var Ee=u.performance||{};Ee.now||Ee.mozNow||Ee.msNow||Ee.oNow||Ee.webkitNow;var Ie="function"==typeof Object.create?function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e},we=/%[sdj%]/g;function Ce(e){if(!Re(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(Ae(arguments[n]));return t.join(" ")}n=1;for(var r=arguments,o=r.length,i=String(e).replace(we,(function(e){if("%%"===e)return"%";if(n>=o)return e;switch(e){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(e){return"[Circular]"}default:return e}})),a=r[n];n<o;a=r[++n])Me(a)||!De(a)?i+=" "+a:i+=" "+Ae(a);return i}function Se(e,t){if(Le(u.process))return function(){return Se(e,t).apply(this,arguments)};var n=!1;return function(){return n||(console.error(t),n=!0),e.apply(this,arguments)}}var Oe,Te={};function Ae(e,t){var n={seen:[],stylize:ke};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),Pe(t)?n.showHidden=t:t&&function(e,t){if(!t||!De(t))return e;for(var n=Object.keys(t),r=n.length;r--;)e[n[r]]=t[n[r]]}(n,t),Le(n.showHidden)&&(n.showHidden=!1),Le(n.depth)&&(n.depth=2),Le(n.colors)&&(n.colors=!1),Le(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=Ne),_e(n,e,n.depth)}function Ne(e,t){var n=Ae.styles[t];return n?"["+Ae.colors[n][0]+"m"+e+"["+Ae.colors[n][1]+"m":e}function ke(e,t){return e}function _e(e,t,n){if(e.customInspect&&t&&$e(t.inspect)&&t.inspect!==Ae&&(!t.constructor||t.constructor.prototype!==t)){var r=t.inspect(n,e);return Re(r)||(r=_e(e,r,n)),r}var o=function(e,t){if(Le(t))return e.stylize("undefined","undefined");if(Re(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string")}return r=t,"number"==typeof r?e.stylize(""+t,"number"):Pe(t)?e.stylize(""+t,"boolean"):Me(t)?e.stylize("null","null"):void 0;var r}(e,t);if(o)return o;var i=Object.keys(t),a=function(e){var t={};return e.forEach((function(e,n){t[e]=!0})),t}(i);if(e.showHidden&&(i=Object.getOwnPropertyNames(t)),ze(t)&&(i.indexOf("message")>=0||i.indexOf("description")>=0))return je(t);if(0===i.length){if($e(t)){var s=t.name?": "+t.name:"";return e.stylize("[Function"+s+"]","special")}if(Ge(t))return e.stylize(RegExp.prototype.toString.call(t),"regexp");if(Be(t))return e.stylize(Date.prototype.toString.call(t),"date");if(ze(t))return je(t)}var l,c,u="",d=!1,p=["{","}"];return c=t,Array.isArray(c)&&(d=!0,p=["[","]"]),$e(t)&&(u=" [Function"+(t.name?": "+t.name:"")+"]"),Ge(t)&&(u=" "+RegExp.prototype.toString.call(t)),Be(t)&&(u=" "+Date.prototype.toUTCString.call(t)),ze(t)&&(u=" "+je(t)),0!==i.length||d&&0!=t.length?n<0?Ge(t)?e.stylize(RegExp.prototype.toString.call(t),"regexp"):e.stylize("[Object]","special"):(e.seen.push(t),l=d?function(e,t,n,r,o){for(var i=[],a=0,s=t.length;a<s;++a)Ue(t,String(a))?i.push(Fe(e,t,n,r,String(a),!0)):i.push("");return o.forEach((function(o){o.match(/^\d+$/)||i.push(Fe(e,t,n,r,o,!0))})),i}(e,t,n,a,i):i.map((function(r){return Fe(e,t,n,a,r,d)})),e.seen.pop(),function(e,t,n){return e.reduce((function(e,t){return t.indexOf("\n"),e+t.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60?n[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1]:n[0]+t+" "+e.join(", ")+" "+n[1]}(l,u,p)):p[0]+u+p[1]}function je(e){return"["+Error.prototype.toString.call(e)+"]"}function Fe(e,t,n,r,o,i){var a,s,l;if((l=Object.getOwnPropertyDescriptor(t,o)||{value:t[o]}).get?s=l.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):l.set&&(s=e.stylize("[Setter]","special")),Ue(r,o)||(a="["+o+"]"),s||(e.seen.indexOf(l.value)<0?(s=Me(n)?_e(e,l.value,null):_e(e,l.value,n-1)).indexOf("\n")>-1&&(s=i?s.split("\n").map((function(e){return"  "+e})).join("\n").substr(2):"\n"+s.split("\n").map((function(e){return"   "+e})).join("\n")):s=e.stylize("[Circular]","special")),Le(a)){if(i&&o.match(/^\d+$/))return s;(a=JSON.stringify(""+o)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=e.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=e.stylize(a,"string"))}return a+": "+s}function Pe(e){return"boolean"==typeof e}function Me(e){return null===e}function Re(e){return"string"==typeof e}function Le(e){return void 0===e}function Ge(e){return De(e)&&"[object RegExp]"===qe(e)}function De(e){return"object"==typeof e&&null!==e}function Be(e){return De(e)&&"[object Date]"===qe(e)}function ze(e){return De(e)&&("[object Error]"===qe(e)||e instanceof Error)}function $e(e){return"function"==typeof e}function qe(e){return Object.prototype.toString.call(e)}function Ue(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function Ve(){this.head=null,this.tail=null,this.length=0}Ae.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},Ae.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},Ve.prototype.push=function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length},Ve.prototype.unshift=function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length},Ve.prototype.shift=function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}},Ve.prototype.clear=function(){this.head=this.tail=null,this.length=0},Ve.prototype.join=function(e){if(0===this.length)return"";for(var t=this.head,n=""+t.data;t=t.next;)n+=e+t.data;return n},Ve.prototype.concat=function(e){if(0===this.length)return C.alloc(0);if(1===this.length)return this.head.data;for(var t=C.allocUnsafe(e>>>0),n=this.head,r=0;n;)n.data.copy(t,r),r+=n.data.length,n=n.next;return t};var He=C.isEncoding||function(e){switch(e&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function We(e){switch(this.encoding=(e||"utf8").toLowerCase().replace(/[-_]/,""),function(e){if(e&&!He(e))throw new Error("Unknown encoding: "+e)}(e),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=Ye;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=Xe;break;default:return void(this.write=Ke)}this.charBuffer=new C(6),this.charReceived=0,this.charLength=0}function Ke(e){return e.toString(this.encoding)}function Ye(e){this.charReceived=e.length%2,this.charLength=this.charReceived?2:0}function Xe(e){this.charReceived=e.length%3,this.charLength=this.charReceived?3:0}We.prototype.write=function(e){for(var t="";this.charLength;){var n=e.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:e.length;if(e.copy(this.charBuffer,this.charReceived,0,n),this.charReceived+=n,this.charReceived<this.charLength)return"";if(e=e.slice(n,e.length),!((r=(t=this.charBuffer.slice(0,this.charLength).toString(this.encoding)).charCodeAt(t.length-1))>=55296&&r<=56319)){if(this.charReceived=this.charLength=0,0===e.length)return t;break}this.charLength+=this.surrogateSize,t=""}this.detectIncompleteChar(e);var r,o=e.length;if(this.charLength&&(e.copy(this.charBuffer,0,e.length-this.charReceived,o),o-=this.charReceived),o=(t+=e.toString(this.encoding,0,o)).length-1,(r=t.charCodeAt(o))>=55296&&r<=56319){var i=this.surrogateSize;return this.charLength+=i,this.charReceived+=i,this.charBuffer.copy(this.charBuffer,i,0,i),e.copy(this.charBuffer,0,0,i),t.substring(0,o)}return t},We.prototype.detectIncompleteChar=function(e){for(var t=e.length>=3?3:e.length;t>0;t--){var n=e[e.length-t];if(1==t&&n>>5==6){this.charLength=2;break}if(t<=2&&n>>4==14){this.charLength=3;break}if(t<=3&&n>>3==30){this.charLength=4;break}}this.charReceived=t},We.prototype.end=function(e){var t="";if(e&&e.length&&(t=this.write(e)),this.charReceived){var n=this.charReceived,r=this.charBuffer,o=this.encoding;t+=r.slice(0,n).toString(o)}return t},Ze.ReadableState=Je;var Qe=function(e){if(Le(Oe)&&(Oe=""),e=e.toUpperCase(),!Te[e])if(new RegExp("\\b"+e+"\\b","i").test(Oe)){Te[e]=function(){var t=Ce.apply(null,arguments);console.error("%s %d: %s",e,0,t)}}else Te[e]=function(){};return Te[e]}("stream");function Je(e,t){e=e||{},this.objectMode=!!e.objectMode,t instanceof At&&(this.objectMode=this.objectMode||!!e.readableObjectMode);var n=e.highWaterMark,r=this.objectMode?16:16384;this.highWaterMark=n||0===n?n:r,this.highWaterMark=~~this.highWaterMark,this.buffer=new Ve,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(this.decoder=new We(e.encoding),this.encoding=e.encoding)}function Ze(e){if(!(this instanceof Ze))return new Ze(e);this._readableState=new Je(e,this),this.readable=!0,e&&"function"==typeof e.read&&(this._read=e.read),o.call(this)}function et(e,t,n,r,o){var i=function(e,t){var n=null;return ae(t)||"string"==typeof t||null==t||e.objectMode||(n=new TypeError("Invalid non-string/buffer chunk")),n}(t,n);if(i)e.emit("error",i);else if(null===n)t.reading=!1,function(e,t){if(!t.ended){if(t.decoder){var n=t.decoder.end();n&&n.length&&(t.buffer.push(n),t.length+=t.objectMode?1:n.length)}t.ended=!0,rt(e)}}(e,t);else if(t.objectMode||n&&n.length>0)if(t.ended&&!o){var a=new Error("stream.push() after EOF");e.emit("error",a)}else if(t.endEmitted&&o){var s=new Error("stream.unshift() after end event");e.emit("error",s)}else{var l;!t.decoder||o||r||(n=t.decoder.write(n),l=!t.objectMode&&0===n.length),o||(t.reading=!1),l||(t.flowing&&0===t.length&&!t.sync?(e.emit("data",n),e.read(0)):(t.length+=t.objectMode?1:n.length,o?t.buffer.unshift(n):t.buffer.push(n),t.needReadable&&rt(e))),function(e,t){t.readingMore||(t.readingMore=!0,be(it,e,t))}(e,t)}else o||(t.reading=!1);return function(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}(t)}Ie(Ze,o),Ze.prototype.push=function(e,t){var n=this._readableState;return n.objectMode||"string"!=typeof e||(t=t||n.defaultEncoding)!==n.encoding&&(e=C.from(e,t),t=""),et(this,n,e,t,!1)},Ze.prototype.unshift=function(e){return et(this,this._readableState,e,"",!0)},Ze.prototype.isPaused=function(){return!1===this._readableState.flowing},Ze.prototype.setEncoding=function(e){return this._readableState.decoder=new We(e),this._readableState.encoding=e,this};var tt=8388608;function nt(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=tt?e=tt:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function rt(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(Qe("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?be(ot,e):ot(e))}function ot(e){Qe("emit readable"),e.emit("readable"),lt(e)}function it(e,t){for(var n=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(Qe("maybeReadMore read 0"),e.read(0),n!==t.length);)n=t.length;t.readingMore=!1}function at(e){Qe("readable nexttick read 0"),e.read(0)}function st(e,t){t.reading||(Qe("resume read 0"),e.read(0)),t.resumeScheduled=!1,t.awaitDrain=0,e.emit("resume"),lt(e),t.flowing&&!t.reading&&e.read(0)}function lt(e){var t=e._readableState;for(Qe("flow",t.flowing);t.flowing&&null!==e.read(););}function ct(e,t){return 0===t.length?null:(t.objectMode?n=t.buffer.shift():!e||e>=t.length?(n=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.head.data:t.buffer.concat(t.length),t.buffer.clear()):n=function(e,t,n){var r;return e<t.head.data.length?(r=t.head.data.slice(0,e),t.head.data=t.head.data.slice(e)):r=e===t.head.data.length?t.shift():n?function(e,t){var n=t.head,r=1,o=n.data;for(e-=o.length;n=n.next;){var i=n.data,a=e>i.length?i.length:e;if(a===i.length?o+=i:o+=i.slice(0,e),0==(e-=a)){a===i.length?(++r,n.next?t.head=n.next:t.head=t.tail=null):(t.head=n,n.data=i.slice(a));break}++r}return t.length-=r,o}(e,t):function(e,t){var n=C.allocUnsafe(e),r=t.head,o=1;for(r.data.copy(n),e-=r.data.length;r=r.next;){var i=r.data,a=e>i.length?i.length:e;if(i.copy(n,n.length-e,0,a),0==(e-=a)){a===i.length?(++o,r.next?t.head=r.next:t.head=t.tail=null):(t.head=r,r.data=i.slice(a));break}++o}return t.length-=o,n}(e,t),r}(e,t.buffer,t.decoder),n);var n}function ut(e){var t=e._readableState;if(t.length>0)throw new Error('"endReadable()" called on non-empty stream');t.endEmitted||(t.ended=!0,be(dt,t,e))}function dt(e,t){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function pt(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}function ft(){}function ht(e,t,n){this.chunk=e,this.encoding=t,this.callback=n,this.next=null}function mt(e,t){Object.defineProperty(this,"buffer",{get:Se((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.")}),e=e||{},this.objectMode=!!e.objectMode,t instanceof At&&(this.objectMode=this.objectMode||!!e.writableObjectMode);var n=e.highWaterMark,r=this.objectMode?16:16384;this.highWaterMark=n||0===n?n:r,this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var o=!1===e.decodeStrings;this.decodeStrings=!o,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var n=e._writableState,r=n.sync,o=n.writecb;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(n),t)!function(e,t,n,r,o){--t.pendingcb,n?be(o,r):o(r),e._writableState.errorEmitted=!0,e.emit("error",r)}(e,n,r,t,o);else{var i=Et(n);i||n.corked||n.bufferProcessing||!n.bufferedRequest||xt(e,n),r?be(bt,e,n,i,o):bt(e,n,i,o)}}(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new Ct(this)}function gt(e){if(!(this instanceof gt||this instanceof At))return new gt(e);this._writableState=new mt(e,this),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev)),o.call(this)}function yt(e,t,n,r,o){n=function(e,t,n){return e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=C.from(t,n)),t}(t,n,r),C.isBuffer(n)&&(r="buffer");var i=t.objectMode?1:n.length;t.length+=i;var a=t.length<t.highWaterMark;if(a||(t.needDrain=!0),t.writing||t.corked){var s=t.lastBufferedRequest;t.lastBufferedRequest=new ht(n,r,o),s?s.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else vt(e,t,!1,i,n,r,o);return a}function vt(e,t,n,r,o,i,a){t.writelen=r,t.writecb=a,t.writing=!0,t.sync=!0,n?e._writev(o,t.onwrite):e._write(o,i,t.onwrite),t.sync=!1}function bt(e,t,n,r){n||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,r(),wt(e,t)}function xt(e,t){t.bufferProcessing=!0;var n=t.bufferedRequest;if(e._writev&&n&&n.next){var r=t.bufferedRequestCount,o=new Array(r),i=t.corkedRequestsFree;i.entry=n;for(var a=0;n;)o[a]=n,n=n.next,a+=1;vt(e,t,!0,t.length,o,"",i.finish),t.pendingcb++,t.lastBufferedRequest=null,i.next?(t.corkedRequestsFree=i.next,i.next=null):t.corkedRequestsFree=new Ct(t)}else{for(;n;){var s=n.chunk,l=n.encoding,c=n.callback;if(vt(e,t,!1,t.objectMode?1:s.length,s,l,c),n=n.next,t.writing)break}null===n&&(t.lastBufferedRequest=null)}t.bufferedRequestCount=0,t.bufferedRequest=n,t.bufferProcessing=!1}function Et(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function It(e,t){t.prefinished||(t.prefinished=!0,e.emit("prefinish"))}function wt(e,t){var n=Et(t);return n&&(0===t.pendingcb?(It(e,t),t.finished=!0,e.emit("finish")):It(e,t)),n}function Ct(e){var t=this;this.next=null,this.entry=null,this.finish=function(n){var r=t.entry;for(t.entry=null;r;){var o=r.callback;e.pendingcb--,o(n),r=r.next}e.corkedRequestsFree?e.corkedRequestsFree.next=t:e.corkedRequestsFree=t}}Ze.prototype.read=function(e){Qe("read",e),e=parseInt(e,10);var t=this._readableState,n=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return Qe("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?ut(this):rt(this),null;if(0===(e=nt(e,t))&&t.ended)return 0===t.length&&ut(this),null;var r,o=t.needReadable;return Qe("need readable",o),(0===t.length||t.length-e<t.highWaterMark)&&Qe("length less than watermark",o=!0),t.ended||t.reading?Qe("reading or ended",o=!1):o&&(Qe("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=nt(n,t))),null===(r=e>0?ct(e,t):null)?(t.needReadable=!0,e=0):t.length-=e,0===t.length&&(t.ended||(t.needReadable=!0),n!==e&&t.ended&&ut(this)),null!==r&&this.emit("data",r),r},Ze.prototype._read=function(e){this.emit("error",new Error("not implemented"))},Ze.prototype.pipe=function(e,t){var n=this,r=this._readableState;switch(r.pipesCount){case 0:r.pipes=e;break;case 1:r.pipes=[r.pipes,e];break;default:r.pipes.push(e)}r.pipesCount+=1,Qe("pipe count=%d opts=%j",r.pipesCount,t);var o=t&&!1===t.end?c:a;function i(e){Qe("onunpipe"),e===n&&c()}function a(){Qe("onend"),e.end()}r.endEmitted?be(o):n.once("end",o),e.on("unpipe",i);var s=function(e){return function(){var t=e._readableState;Qe("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&e.listeners("data").length&&(t.flowing=!0,lt(e))}}(n);e.on("drain",s);var l=!1;function c(){Qe("cleanup"),e.removeListener("close",f),e.removeListener("finish",h),e.removeListener("drain",s),e.removeListener("error",p),e.removeListener("unpipe",i),n.removeListener("end",a),n.removeListener("end",c),n.removeListener("data",d),l=!0,!r.awaitDrain||e._writableState&&!e._writableState.needDrain||s()}var u=!1;function d(t){Qe("ondata"),u=!1,!1!==e.write(t)||u||((1===r.pipesCount&&r.pipes===e||r.pipesCount>1&&-1!==pt(r.pipes,e))&&!l&&(Qe("false write response, pause",n._readableState.awaitDrain),n._readableState.awaitDrain++,u=!0),n.pause())}function p(t){Qe("onerror",t),m(),e.removeListener("error",p),0===function(e,t){return e.listeners(t).length}(e,"error")&&e.emit("error",t)}function f(){e.removeListener("finish",h),m()}function h(){Qe("onfinish"),e.removeListener("close",f),m()}function m(){Qe("unpipe"),n.unpipe(e)}return n.on("data",d),function(e,t,n){if("function"==typeof e.prependListener)return e.prependListener(t,n);e._events&&e._events[t]?Array.isArray(e._events[t])?e._events[t].unshift(n):e._events[t]=[n,e._events[t]]:e.on(t,n)}(e,"error",p),e.once("close",f),e.once("finish",h),e.emit("pipe",n),r.flowing||(Qe("pipe resume"),n.resume()),e},Ze.prototype.unpipe=function(e){var t=this._readableState;if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this)),this;if(!e){var n=t.pipes,r=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var o=0;o<r;o++)n[o].emit("unpipe",this);return this}var i=pt(t.pipes,e);return-1===i||(t.pipes.splice(i,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this)),this},Ze.prototype.on=function(e,t){var n=o.prototype.on.call(this,e,t);if("data"===e)!1!==this._readableState.flowing&&this.resume();else if("readable"===e){var r=this._readableState;r.endEmitted||r.readableListening||(r.readableListening=r.needReadable=!0,r.emittedReadable=!1,r.reading?r.length&&rt(this):be(at,this))}return n},Ze.prototype.addListener=Ze.prototype.on,Ze.prototype.resume=function(){var e=this._readableState;return e.flowing||(Qe("resume"),e.flowing=!0,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,be(st,e,t))}(this,e)),this},Ze.prototype.pause=function(){return Qe("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(Qe("pause"),this._readableState.flowing=!1,this.emit("pause")),this},Ze.prototype.wrap=function(e){var t=this._readableState,n=!1,r=this;for(var o in e.on("end",(function(){if(Qe("wrapped end"),t.decoder&&!t.ended){var e=t.decoder.end();e&&e.length&&r.push(e)}r.push(null)})),e.on("data",(function(o){Qe("wrapped data"),t.decoder&&(o=t.decoder.write(o)),t.objectMode&&null==o||(t.objectMode||o&&o.length)&&(r.push(o)||(n=!0,e.pause()))})),e)void 0===this[o]&&"function"==typeof e[o]&&(this[o]=function(t){return function(){return e[t].apply(e,arguments)}}(o));return function(e,t){for(var n=0,r=e.length;n<r;n++)t(e[n],n)}(["error","close","destroy","pause","resume"],(function(t){e.on(t,r.emit.bind(r,t))})),r._read=function(t){Qe("wrapped _read",t),n&&(n=!1,e.resume())},r},Ze._fromList=ct,gt.WritableState=mt,Ie(gt,o),mt.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},gt.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},gt.prototype.write=function(e,t,n){var r=this._writableState,o=!1;return"function"==typeof t&&(n=t,t=null),C.isBuffer(e)?t="buffer":t||(t=r.defaultEncoding),"function"!=typeof n&&(n=ft),r.ended?function(e,t){var n=new Error("write after end");e.emit("error",n),be(t,n)}(this,n):function(e,t,n,r){var o=!0,i=!1;return null===n?i=new TypeError("May not write null values to stream"):C.isBuffer(n)||"string"==typeof n||void 0===n||t.objectMode||(i=new TypeError("Invalid non-string/buffer chunk")),i&&(e.emit("error",i),be(r,i),o=!1),o}(this,r,e,n)&&(r.pendingcb++,o=yt(this,r,e,t,n)),o},gt.prototype.cork=function(){this._writableState.corked++},gt.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.bufferedRequest||xt(this,e))},gt.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this},gt.prototype._write=function(e,t,n){n(new Error("not implemented"))},gt.prototype._writev=null,gt.prototype.end=function(e,t,n){var r=this._writableState;"function"==typeof e?(n=e,e=null,t=null):"function"==typeof t&&(n=t,t=null),null!=e&&this.write(e,t),r.corked&&(r.corked=1,this.uncork()),r.ending||r.finished||function(e,t,n){t.ending=!0,wt(e,t),n&&(t.finished?be(n):e.once("finish",n)),t.ended=!0,e.writable=!1}(this,r,n)},Ie(At,Ze);for(var St=Object.keys(gt.prototype),Ot=0;Ot<St.length;Ot++){var Tt=St[Ot];At.prototype[Tt]||(At.prototype[Tt]=gt.prototype[Tt])}function At(e){if(!(this instanceof At))return new At(e);Ze.call(this,e),gt.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",Nt)}function Nt(){this.allowHalfOpen||this._writableState.ended||be(kt,this)}function kt(e){e.end()}function _t(e){this.afterTransform=function(t,n){return function(e,t,n){var r=e._transformState;r.transforming=!1;var o=r.writecb;if(!o)return e.emit("error",new Error("no writecb in Transform class"));r.writechunk=null,r.writecb=null,null!=n&&e.push(n),o(t);var i=e._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&e._read(i.highWaterMark)}(e,t,n)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null,this.writeencoding=null}function jt(e){if(!(this instanceof jt))return new jt(e);At.call(this,e),this._transformState=new _t(this);var t=this;this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.once("prefinish",(function(){"function"==typeof this._flush?this._flush((function(e){Ft(t,e)})):Ft(t)}))}function Ft(e,t){if(t)return e.emit("error",t);var n=e._writableState,r=e._transformState;if(n.length)throw new Error("Calling transform done when ws.length != 0");if(r.transforming)throw new Error("Calling transform done when still transforming");return e.push(null)}function Pt(e){if(!(this instanceof Pt))return new Pt(e);jt.call(this,e)}function Mt(){o.call(this)}function Rt(e){return Rt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Rt(e)}function Lt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Gt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Dt(e,t,n){return t&&Gt(e.prototype,t),n&&Gt(e,n),e}function Bt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function zt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Bt(e,t,n[t])}))}return e}function $t(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ut(e,t)}function qt(e){return qt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},qt(e)}function Ut(e,t){return Ut=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Ut(e,t)}function Vt(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ht(e){return function(e){if(Array.isArray(e))return e}(e)||Kt(e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Wt(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||Kt(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Kt(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}Ie(jt,At),jt.prototype.push=function(e,t){return this._transformState.needTransform=!1,At.prototype.push.call(this,e,t)},jt.prototype._transform=function(e,t,n){throw new Error("Not implemented")},jt.prototype._write=function(e,t,n){var r=this._transformState;if(r.writecb=n,r.writechunk=e,r.writeencoding=t,!r.transforming){var o=this._readableState;(r.needTransform||o.needReadable||o.length<o.highWaterMark)&&this._read(o.highWaterMark)}},jt.prototype._read=function(e){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0},Ie(Pt,jt),Pt.prototype._transform=function(e,t,n){n(null,e)},Ie(Mt,o),Mt.Readable=Ze,Mt.Writable=gt,Mt.Duplex=At,Mt.Transform=jt,Mt.PassThrough=Pt,Mt.Stream=Mt,Mt.prototype.pipe=function(e,t){var n=this;function r(t){e.writable&&!1===e.write(t)&&n.pause&&n.pause()}function i(){n.readable&&n.resume&&n.resume()}n.on("data",r),e.on("drain",i),e._isStdio||t&&!1===t.end||(n.on("end",s),n.on("close",l));var a=!1;function s(){a||(a=!0,e.end())}function l(){a||(a=!0,"function"==typeof e.destroy&&e.destroy())}function c(e){if(u(),0===o.listenerCount(this,"error"))throw e}function u(){n.removeListener("data",r),e.removeListener("drain",i),n.removeListener("end",s),n.removeListener("close",l),n.removeListener("error",c),e.removeListener("error",c),n.removeListener("end",u),n.removeListener("close",u),e.removeListener("close",u)}return n.on("error",c),e.on("error",c),n.on("end",u),n.on("close",u),e.on("close",u),e.emit("pipe",n),e};var Yt="\n",Xt="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==n.g?n.g:"undefined"!=typeof self?self:{},Qt="__lodash_hash_undefined__",Jt=1/0,Zt="[object Function]",en="[object GeneratorFunction]",tn="[object Symbol]",nn=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,rn=/^\w*$/,on=/^\./,an=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,sn=/\\(\\)?/g,ln=/^\[object .+?Constructor\]$/,cn="object"==typeof Xt&&Xt&&Xt.Object===Object&&Xt,un="object"==typeof self&&self&&self.Object===Object&&self,dn=cn||un||Function("return this")();var pn,fn=Array.prototype,hn=Function.prototype,mn=Object.prototype,gn=dn["__core-js_shared__"],yn=(pn=/[^.]+$/.exec(gn&&gn.keys&&gn.keys.IE_PROTO||""))?"Symbol(src)_1."+pn:"",vn=hn.toString,bn=mn.hasOwnProperty,xn=mn.toString,En=RegExp("^"+vn.call(bn).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),In=dn.Symbol,wn=fn.splice,Cn=Mn(dn,"Map"),Sn=Mn(Object,"create"),On=In?In.prototype:void 0,Tn=On?On.toString:void 0;function An(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Nn(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function kn(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function _n(e,t){for(var n=e.length;n--;)if((r=e[n][0])===(o=t)||r!=r&&o!=o)return n;var r,o;return-1}function jn(e,t){for(var n=0,r=(t=function(e,t){if(Dn(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!zn(e))||rn.test(e)||!nn.test(e)||null!=t&&e in Object(t)}(t,e)?[t]:(o=t,Dn(o)?o:Rn(o))).length;null!=e&&n<r;)e=e[Ln(t[n++])];var o;return n&&n==r?e:void 0}function Fn(e){return!(!Bn(e)||(t=e,yn&&yn in t))&&(function(e){var t=Bn(e)?xn.call(e):"";return t==Zt||t==en}(e)||function(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}(e)?En:ln).test(function(e){if(null!=e){try{return vn.call(e)}catch(e){}try{return e+""}catch(e){}}return""}(e));var t}function Pn(e,t){var n=e.__data__;return function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}(t)?n["string"==typeof t?"string":"hash"]:n.map}function Mn(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return Fn(n)?n:void 0}An.prototype.clear=function(){this.__data__=Sn?Sn(null):{}},An.prototype.delete=function(e){return this.has(e)&&delete this.__data__[e]},An.prototype.get=function(e){var t=this.__data__;if(Sn){var n=t[e];return n===Qt?void 0:n}return bn.call(t,e)?t[e]:void 0},An.prototype.has=function(e){var t=this.__data__;return Sn?void 0!==t[e]:bn.call(t,e)},An.prototype.set=function(e,t){return this.__data__[e]=Sn&&void 0===t?Qt:t,this},Nn.prototype.clear=function(){this.__data__=[]},Nn.prototype.delete=function(e){var t=this.__data__,n=_n(t,e);return!(n<0||(n==t.length-1?t.pop():wn.call(t,n,1),0))},Nn.prototype.get=function(e){var t=this.__data__,n=_n(t,e);return n<0?void 0:t[n][1]},Nn.prototype.has=function(e){return _n(this.__data__,e)>-1},Nn.prototype.set=function(e,t){var n=this.__data__,r=_n(n,e);return r<0?n.push([e,t]):n[r][1]=t,this},kn.prototype.clear=function(){this.__data__={hash:new An,map:new(Cn||Nn),string:new An}},kn.prototype.delete=function(e){return Pn(this,e).delete(e)},kn.prototype.get=function(e){return Pn(this,e).get(e)},kn.prototype.has=function(e){return Pn(this,e).has(e)},kn.prototype.set=function(e,t){return Pn(this,e).set(e,t),this};var Rn=Gn((function(e){var t;e=null==(t=e)?"":function(e){if("string"==typeof e)return e;if(zn(e))return Tn?Tn.call(e):"";var t=e+"";return"0"==t&&1/e==-Jt?"-0":t}(t);var n=[];return on.test(e)&&n.push(""),e.replace(an,(function(e,t,r,o){n.push(r?o.replace(sn,"$1"):t||e)})),n}));function Ln(e){if("string"==typeof e||zn(e))return e;var t=e+"";return"0"==t&&1/e==-Jt?"-0":t}function Gn(e,t){if("function"!=typeof e||t&&"function"!=typeof t)throw new TypeError("Expected a function");var n=function(){var r=arguments,o=t?t.apply(this,r):r[0],i=n.cache;if(i.has(o))return i.get(o);var a=e.apply(this,r);return n.cache=i.set(o,a),a};return n.cache=new(Gn.Cache||kn),n}Gn.Cache=kn;var Dn=Array.isArray;function Bn(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function zn(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&xn.call(e)==tn}var $n=function(e,t,n){var r=null==e?void 0:jn(e,t);return void 0===r?n:r};var qn=function e(t,n,r){var o=Array.isArray(n)?n:n.split("."),i=Ht(o),a=i[0],s=i.slice(1);return zt({},t,Bt({},a,o.length>1?e(t[a]||{},s,r):r))},Un=function e(t,n){var r=Array.isArray(n)?n:n.split("."),o=Ht(r),i=o[0],a=o.slice(1);return"object"!==Rt(t[i])?t:1===r.length?Object.keys(t).filter((function(e){return e!==i})).reduce((function(e,n){return Object.assign(e,Bt({},n,t[n]))}),{}):Object.keys(t).reduce((function(n,r){return zt({},n,Bt({},r,r!==i?t[r]:e(t[i],a)))}),{})},Vn=function(e,t){var n=!0;return e.reduce((function(e,r){return null==r&&(r=""),n?(n=!1,"".concat(r)):"".concat(e).concat(t).concat(r)}),"")},Hn=function(e,t){try{return e.push.apply(e,Wt(t)),e}catch(n){return e.concat(t)}},Wn=function(e,t,n){return void 0===e[t]?n:e[t]},Kn=Vn,Yn=Hn,Xn=function(){function e(t){Lt(this,e),this.opts=this.preprocessOpts(t)}return Dt(e,[{key:"preprocessOpts",value:function(e){var t=Object.assign({},e);return t.transforms=Array.isArray(t.transforms)?t.transforms:t.transforms?[t.transforms]:[],t.delimiter=t.delimiter||",",t.eol=t.eol||Yt,t.quote="string"==typeof t.quote?t.quote:'"',t.escapedQuote="string"==typeof t.escapedQuote?t.escapedQuote:"".concat(t.quote).concat(t.quote),t.header=!1!==t.header,t.includeEmptyRows=t.includeEmptyRows||!1,t.withBOM=t.withBOM||!1,t}},{key:"preprocessFieldsInfo",value:function(e){var t=this;return e.map((function(e){if("string"==typeof e)return{label:e,value:e.includes(".")||e.includes("[")?function(n){return $n(n,e,t.opts.defaultValue)}:function(n){return Wn(n,e,t.opts.defaultValue)}};if("object"===Rt(e)){var n="default"in e?e.default:t.opts.defaultValue;if("string"==typeof e.value)return{label:e.label||e.value,value:e.value.includes(".")||e.value.includes("[")?function(t){return $n(t,e.value,n)}:function(t){return Wn(t,e.value,n)}};if("function"==typeof e.value){var r=e.label||e.value.name||"",o={label:r,default:n};return{label:r,value:function(t){var r=e.value(t,o);return null==r?n:r}}}}throw new Error("Invalid field info option. "+JSON.stringify(e))}))}},{key:"getHeader",value:function(){var e=this;return Kn(this.opts.fields.map((function(t){return e.processValue(t.label)})),this.opts.delimiter)}},{key:"preprocessRow",value:function(e){return this.opts.transforms.reduce((function(e,t){return e.map((function(e){return t(e)})).reduce(Yn,[])}),[e])}},{key:"processRow",value:function(e){var t=this;if(e){var n=this.opts.fields.map((function(n){return t.processCell(e,n)}));if(this.opts.includeEmptyRows||!n.every((function(e){return void 0===e})))return Kn(n,this.opts.delimiter)}}},{key:"processCell",value:function(e,t){return this.processValue(t.value(e))}},{key:"processValue",value:function(e){if(null!=e){var t=Rt(e);if("boolean"!==t&&"number"!==t&&"string"!==t){if(void 0===(e=JSON.stringify(e)))return;'"'===e[0]&&(e=e.replace(/^"(.+)"$/,"$1"))}return"string"==typeof e&&(this.opts.excelStrings?(e.includes(this.opts.quote)&&(e=e.replace(new RegExp(this.opts.quote,"g"),"".concat(this.opts.escapedQuote).concat(this.opts.escapedQuote))),e='"=""'.concat(e,'"""')):(e.includes(this.opts.quote)&&(e=e.replace(new RegExp(this.opts.quote,"g"),this.opts.escapedQuote)),e="".concat(this.opts.quote).concat(e).concat(this.opts.quote))),e}}}]),e}(),Qn=Vn,Jn=Hn,Zn=function(e){function t(e){var n;return Lt(this,t),(n=Vt(this,qt(t).call(this,e))).opts.fields&&(n.opts.fields=n.preprocessFieldsInfo(n.opts.fields)),n}return $t(t,e),Dt(t,[{key:"parse",value:function(e){var t=this.preprocessData(e);this.opts.fields||(this.opts.fields=t.reduce((function(e,t){return Object.keys(t).forEach((function(t){e.includes(t)||e.push(t)})),e}),[]),this.opts.fields=this.preprocessFieldsInfo(this.opts.fields));var n=this.opts.header?this.getHeader():"",r=this.processData(t);return(this.opts.withBOM?"\ufeff":"")+n+(n&&r?this.opts.eol:"")+r}},{key:"preprocessData",value:function(e){var t=this,n=Array.isArray(e)?e:[e];if(!this.opts.fields&&(0===n.length||"object"!==Rt(n[0])))throw new Error('Data should not be empty or the "fields" option should be included');return 0===this.opts.transforms.length?n:n.map((function(e){return t.preprocessRow(e)})).reduce(Jn,[])}},{key:"processData",value:function(e){var t=this;return Qn(e.map((function(e){return t.processRow(e)})).filter((function(e){return e})),this.opts.eol)}}]),t}(Xn),er={},tr=er.LEFT_BRACE=1,nr=er.RIGHT_BRACE=2,rr=er.LEFT_BRACKET=3,or=er.RIGHT_BRACKET=4,ir=er.COLON=5,ar=er.COMMA=6,sr=er.TRUE=7,lr=er.FALSE=8,cr=er.NULL=9,ur=er.STRING=10,dr=er.NUMBER=11,pr=er.START=17,fr=er.STOP=18,hr=er.TRUE1=33,mr=er.TRUE2=34,gr=er.TRUE3=35,yr=er.FALSE1=49,vr=er.FALSE2=50,br=er.FALSE3=51,xr=er.FALSE4=52,Er=er.NULL1=65,Ir=er.NULL2=66,wr=er.NULL3=67,Cr=er.NUMBER1=81,Sr=er.NUMBER3=83,Or=er.STRING1=97,Tr=er.STRING2=98,Ar=er.STRING3=99,Nr=er.STRING4=100,kr=er.STRING5=101,_r=er.STRING6=102,jr=er.VALUE=113,Fr=er.KEY=114,Pr=er.OBJECT=129,Mr=er.ARRAY=130,Rr="\\".charCodeAt(0),Lr="/".charCodeAt(0),Gr="\b".charCodeAt(0),Dr="\f".charCodeAt(0),Br="\n".charCodeAt(0),zr="\r".charCodeAt(0),$r="\t".charCodeAt(0),qr=65536;function Ur(){this.tState=pr,this.value=void 0,this.string=void 0,this.stringBuffer=C.alloc?C.alloc(qr):new C(qr),this.stringBufferOffset=0,this.unicode=void 0,this.highSurrogate=void 0,this.key=void 0,this.mode=void 0,this.stack=[],this.state=jr,this.bytes_remaining=0,this.bytes_in_sequence=0,this.temp_buffs={2:new C(2),3:new C(3),4:new C(4)},this.offset=-1}Ur.toknam=function(e){for(var t=Object.keys(er),n=0,r=t.length;n<r;n++){var o=t[n];if(er[o]===e)return o}return e&&"0x"+e.toString(16)};var Vr=Ur.prototype;Vr.onError=function(e){throw e},Vr.charError=function(e,t){this.tState=fr,this.onError(new Error("Unexpected "+JSON.stringify(String.fromCharCode(e[t]))+" at position "+t+" in state "+Ur.toknam(this.tState)))},Vr.appendStringChar=function(e){this.stringBufferOffset>=qr&&(this.string+=this.stringBuffer.toString("utf8"),this.stringBufferOffset=0),this.stringBuffer[this.stringBufferOffset++]=e},Vr.appendStringBuf=function(e,t,n){var r=e.length;"number"==typeof t&&(r="number"==typeof n?n<0?e.length-t+n:n-t:e.length-t),r<0&&(r=0),this.stringBufferOffset+r>qr&&(this.string+=this.stringBuffer.toString("utf8",0,this.stringBufferOffset),this.stringBufferOffset=0),e.copy(this.stringBuffer,this.stringBufferOffset,t,n),this.stringBufferOffset+=r},Vr.write=function(e){var t;"string"==typeof e&&(e=new C(e));for(var n=0,r=e.length;n<r;n++)if(this.tState===pr){if(t=e[n],this.offset++,123===t)this.onToken(tr,"{");else if(125===t)this.onToken(nr,"}");else if(91===t)this.onToken(rr,"[");else if(93===t)this.onToken(or,"]");else if(58===t)this.onToken(ir,":");else if(44===t)this.onToken(ar,",");else if(116===t)this.tState=hr;else if(102===t)this.tState=yr;else if(110===t)this.tState=Er;else if(34===t)this.string="",this.stringBufferOffset=0,this.tState=Or;else if(45===t)this.string="-",this.tState=Cr;else if(t>=48&&t<64)this.string=String.fromCharCode(t),this.tState=Sr;else if(32!==t&&9!==t&&10!==t&&13!==t)return this.charError(e,n)}else if(this.tState===Or)if(t=e[n],this.bytes_remaining>0){for(var o=0;o<this.bytes_remaining;o++)this.temp_buffs[this.bytes_in_sequence][this.bytes_in_sequence-this.bytes_remaining+o]=e[o];this.appendStringBuf(this.temp_buffs[this.bytes_in_sequence]),this.bytes_in_sequence=this.bytes_remaining=0,n=n+o-1}else if(0===this.bytes_remaining&&t>=128){if(t<=193||t>244)return this.onError(new Error("Invalid UTF-8 character at position "+n+" in state "+Ur.toknam(this.tState)));if(t>=194&&t<=223&&(this.bytes_in_sequence=2),t>=224&&t<=239&&(this.bytes_in_sequence=3),t>=240&&t<=244&&(this.bytes_in_sequence=4),this.bytes_in_sequence+n>e.length){for(var i=0;i<=e.length-1-n;i++)this.temp_buffs[this.bytes_in_sequence][i]=e[n+i];this.bytes_remaining=n+this.bytes_in_sequence-e.length,n=e.length-1}else this.appendStringBuf(e,n,n+this.bytes_in_sequence),n=n+this.bytes_in_sequence-1}else if(34===t)this.tState=pr,this.string+=this.stringBuffer.toString("utf8",0,this.stringBufferOffset),this.stringBufferOffset=0,this.onToken(ur,this.string),this.offset+=C.byteLength(this.string,"utf8")+1,this.string=void 0;else if(92===t)this.tState=Tr;else{if(!(t>=32))return this.charError(e,n);this.appendStringChar(t)}else if(this.tState===Tr)if(34===(t=e[n]))this.appendStringChar(t),this.tState=Or;else if(92===t)this.appendStringChar(Rr),this.tState=Or;else if(47===t)this.appendStringChar(Lr),this.tState=Or;else if(98===t)this.appendStringChar(Gr),this.tState=Or;else if(102===t)this.appendStringChar(Dr),this.tState=Or;else if(110===t)this.appendStringChar(Br),this.tState=Or;else if(114===t)this.appendStringChar(zr),this.tState=Or;else if(116===t)this.appendStringChar($r),this.tState=Or;else{if(117!==t)return this.charError(e,n);this.unicode="",this.tState=Ar}else if(this.tState===Ar||this.tState===Nr||this.tState===kr||this.tState===_r){if(!((t=e[n])>=48&&t<64||t>64&&t<=70||t>96&&t<=102))return this.charError(e,n);if(this.unicode+=String.fromCharCode(t),this.tState++===_r){var a=parseInt(this.unicode,16);this.unicode=void 0,void 0!==this.highSurrogate&&a>=56320&&a<57344?(this.appendStringBuf(new C(String.fromCharCode(this.highSurrogate,a))),this.highSurrogate=void 0):void 0===this.highSurrogate&&a>=55296&&a<56320?this.highSurrogate=a:(void 0!==this.highSurrogate&&(this.appendStringBuf(new C(String.fromCharCode(this.highSurrogate))),this.highSurrogate=void 0),this.appendStringBuf(new C(String.fromCharCode(a)))),this.tState=Or}}else if(this.tState===Cr||this.tState===Sr)switch(t=e[n]){case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:case 46:case 101:case 69:case 43:case 45:this.string+=String.fromCharCode(t),this.tState=Sr;break;default:this.tState=pr;var s=Number(this.string);if(isNaN(s))return this.charError(e,n);this.string.match(/[0-9]+/)==this.string&&s.toString()!=this.string?this.onToken(ur,this.string):this.onToken(dr,s),this.offset+=this.string.length-1,this.string=void 0,n--}else if(this.tState===hr){if(114!==e[n])return this.charError(e,n);this.tState=mr}else if(this.tState===mr){if(117!==e[n])return this.charError(e,n);this.tState=gr}else if(this.tState===gr){if(101!==e[n])return this.charError(e,n);this.tState=pr,this.onToken(sr,!0),this.offset+=3}else if(this.tState===yr){if(97!==e[n])return this.charError(e,n);this.tState=vr}else if(this.tState===vr){if(108!==e[n])return this.charError(e,n);this.tState=br}else if(this.tState===br){if(115!==e[n])return this.charError(e,n);this.tState=xr}else if(this.tState===xr){if(101!==e[n])return this.charError(e,n);this.tState=pr,this.onToken(lr,!1),this.offset+=4}else if(this.tState===Er){if(117!==e[n])return this.charError(e,n);this.tState=Ir}else if(this.tState===Ir){if(108!==e[n])return this.charError(e,n);this.tState=wr}else if(this.tState===wr){if(108!==e[n])return this.charError(e,n);this.tState=pr,this.onToken(cr,null),this.offset+=3}},Vr.onToken=function(e,t){},Vr.parseError=function(e,t){this.tState=fr,this.onError(new Error("Unexpected "+Ur.toknam(e)+(t?"("+JSON.stringify(t)+")":"")+" in state "+Ur.toknam(this.state)))},Vr.push=function(){this.stack.push({value:this.value,key:this.key,mode:this.mode})},Vr.pop=function(){var e=this.value,t=this.stack.pop();this.value=t.value,this.key=t.key,this.mode=t.mode,this.emit(e),this.mode||(this.state=jr)},Vr.emit=function(e){this.mode&&(this.state=ar),this.onValue(e)},Vr.onValue=function(e){},Vr.onToken=function(e,t){if(this.state===jr)if(e===ur||e===dr||e===sr||e===lr||e===cr)this.value&&(this.value[this.key]=t),this.emit(t);else if(e===tr)this.push(),this.value?this.value=this.value[this.key]={}:this.value={},this.key=void 0,this.state=Fr,this.mode=Pr;else if(e===rr)this.push(),this.value?this.value=this.value[this.key]=[]:this.value=[],this.key=0,this.mode=Mr,this.state=jr;else if(e===nr){if(this.mode!==Pr)return this.parseError(e,t);this.pop()}else{if(e!==or)return this.parseError(e,t);if(this.mode!==Mr)return this.parseError(e,t);this.pop()}else if(this.state===Fr)if(e===ur)this.key=t,this.state=ir;else{if(e!==nr)return this.parseError(e,t);this.pop()}else if(this.state===ir){if(e!==ir)return this.parseError(e,t);this.state=jr}else{if(this.state!==ar)return this.parseError(e,t);if(e===ar)this.mode===Mr?(this.key++,this.state=jr):this.mode===Pr&&(this.state=Fr);else{if(!(e===or&&this.mode===Mr||e===nr&&this.mode===Pr))return this.parseError(e,t);this.pop()}}},Ur.C=er;var Hr=Ur,Wr=function(e){function t(e,n){var r;return Lt(this,t),r=Vt(this,qt(t).call(this,n)),Object.getOwnPropertyNames(Xn.prototype).forEach((function(e){return r[e]=Xn.prototype[e]})),r.opts=r.preprocessOpts(e),r._data="",r._hasWritten=!1,r._readableState.objectMode?r.initObjectModeParse():r.opts.ndjson?r.initNDJSONParse():r.initJSONParser(),r.opts.withBOM&&r.push("\ufeff"),r.opts.fields&&(r.opts.fields=r.preprocessFieldsInfo(r.opts.fields),r.pushHeader()),r}return $t(t,e),Dt(t,[{key:"initObjectModeParse",value:function(){var e=this;this.parser={write:function(t){e.pushLine(t)},getPendingData:function(){}}}},{key:"initNDJSONParse",value:function(){var e=this;this.parser={_data:"",write:function(t){this._data+=t.toString();var n=this._data.split("\n").map((function(e){return e.trim()})).filter((function(e){return""!==e})),r=!1;n.forEach((function(t,o){try{e.pushLine(JSON.parse(t))}catch(i){o===n.length-1?r=!0:(i.message="Invalid JSON (".concat(t,")"),e.emit("error",i))}})),this._data=r?this._data.slice(this._data.lastIndexOf("\n")):""},getPendingData:function(){return this._data}}}},{key:"initJSONParser",value:function(){var e=this;this.parser=new Hr,this.parser.onValue=function(t){this.stack.length===this.depthToEmit&&e.pushLine(t)},this.parser._onToken=this.parser.onToken,this.parser.onToken=function(t,n){e.parser._onToken(t,n),0!==this.stack.length||e.opts.fields||this.mode===Hr.C.ARRAY||this.mode===Hr.C.OBJECT||this.onError(new Error('Data should not be empty or the "fields" option should be included')),1===this.stack.length&&(void 0===this.depthToEmit&&(this.depthToEmit=this.mode===Hr.C.ARRAY?1:0),0!==this.depthToEmit&&1===this.stack.length&&(this.value=void 0))},this.parser.getPendingData=function(){return this.value},this.parser.onError=function(t){t.message.includes("Unexpected")&&(t.message="Invalid JSON (".concat(t.message,")")),e.emit("error",t)}}},{key:"_transform",value:function(e,t,n){this.parser.write(e),n()}},{key:"_flush",value:function(e){this.parser.getPendingData()&&e(new Error("Invalid data received from stdin",this.parser.getPendingData())),e()}},{key:"pushHeader",value:function(){if(this.opts.header){var e=this.getHeader();this.emit("header",e),this.push(e),this._hasWritten=!0}}},{key:"pushLine",value:function(e){var t=this,n=this.preprocessRow(e);this._hasWritten||(this.opts.fields=this.opts.fields||this.preprocessFieldsInfo(Object.keys(n[0])),this.pushHeader()),n.forEach((function(e){var n=t.processRow(e,t.opts);void 0!==n&&(t.emit("line",n),t.push(t._hasWritten?t.opts.eol+n:n),t._hasWritten=!0)}))}}]),t}(Mt.Transform),Kr=Mt.Transform,Yr=Vn,Xr=function(){function e(t,n){Lt(this,e),this.input=new Kr(n),this.input._read=function(){},this.transform=new Wr(t,n),this.processor=this.input.pipe(this.transform)}return Dt(e,[{key:"fromInput",value:function(e){if(this._input)throw new Error("Async parser already has an input.");return this._input=e,this.input=this._input.pipe(this.processor),this}},{key:"throughTransform",value:function(e){if(this._output)throw new Error("Can't add transforms once an output has been added.");return this.processor=this.processor.pipe(e),this}},{key:"toOutput",value:function(e){if(this._output)throw new Error("Async parser already has an output.");return this._output=e,this.processor=this.processor.pipe(e),this}},{key:"promise",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return new Promise((function(n,r){if(t){var o=[];e.processor.on("data",(function(e){return o.push(e.toString())})).on("finish",(function(){return n(Yr(o,""))})).on("error",(function(e){return r(e)}))}else e.processor.on("finish",(function(){return n()})).on("error",(function(e){return r(e)}))}))}}]),e}(),Qr=Xr;var Jr=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.objects,n=void 0===t||t,r=e.arrays,o=void 0!==r&&r,i=e.separator,a=void 0===i?".":i;function s(e,t,r){return Object.keys(e).forEach((function(i){var l=r?"".concat(r).concat(a).concat(i):i,c=e[i];n&&"object"===Rt(c)&&null!==c&&!Array.isArray(c)&&"[object Function]"!==Object.prototype.toString.call(c.toJSON)&&Object.keys(c).length||o&&Array.isArray(c)?s(c,t,l):t[l]=c})),t}return function(e){return s(e,{})}},Zr=qn,eo=Un,to=Hn;function no(e,t){return Object.keys(e).reduce((function(n,r){var o=t?"".concat(t,".").concat(r):r,i=e[r];return"object"===Rt(i)&&null!==i&&!Array.isArray(i)&&"[object Function]"!==Object.prototype.toString.call(i.toJSON)&&Object.keys(i).length?n=n.concat(no(i,o)):Array.isArray(i)&&(n.push(o),n=n.concat(i.map((function(e){return no(e,o)})).reduce(to,[]).filter((function(e,t,n){return n.indexOf(e)!==t})))),n}),[])}var ro=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.paths,n=void 0===t?void 0:t,r=e.blankOut,o=void 0!==r&&r;function i(e,t){return e.map((function(e){var n=$n(e,t);return Array.isArray(n)?n.length?n.map((function(n,r){return Zr(o&&r>0?{}:e,t,n)})):eo(e,t):e})).reduce(to,[])}return n=Array.isArray(n)?n:n?[n]:void 0,function(e){return(n||no(e)).reduce(i,[e])}},oo=Mt.Readable,io=Zn,ao=Qr,so=Wr,lo=function(e,t){return new Zn(t).parse(e)},co=function(e,t,n){try{e instanceof oo||(n=Object.assign({},n,{objectMode:!0}));var r=new Qr(t,n),o=r.promise();return Array.isArray(e)?(e.forEach((function(e){return r.input.push(e)})),r.input.push(null)):e instanceof oo?r.fromInput(e):(r.input.push(e),r.input.push(null)),o}catch(e){return Promise.reject(e)}},uo={flatten:Jr,unwind:ro},po={Parser:io,AsyncParser:ao,Transform:so,parse:lo,parseAsync:co,transforms:uo};e.AsyncParser=ao,e.Parser=io,e.Transform=so,e.default=po,e.parse=lo,e.parseAsync=co,e.transforms=uo,Object.defineProperty(e,"__esModule",{value:!0})}(t)},770:t=>{"use strict";t.exports=e},835:e=>{"use strict";e.exports=t},618:e=>{"use strict";e.exports=n},725:e=>{"use strict";e.exports=r},24:e=>{"use strict";e.exports=o},314:e=>{"use strict";e.exports=i},479:e=>{"use strict";e.exports=a},721:e=>{"use strict";e.exports=s}},c={};function u(e){var t=c[e];if(void 0!==t)return t.exports;var n=c[e]={id:e,loaded:!1,exports:{}};return l[e].call(n.exports,n,n.exports,u),n.loaded=!0,n.exports}u.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return u.d(t,{a:t}),t},u.d=(e,t)=>{for(var n in t)u.o(t,n)&&!u.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},u.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),u.hmd=e=>((e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e),u.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),u.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var d={};return(()=>{"use strict";u.r(d),u.d(d,{components:()=>e,elements:()=>t,layouts:()=>n,services:()=>sc,templates:()=>l});var e={};u.r(e),u.d(e,{ActivateRelations:()=>I,CanvasSetting:()=>k,ChartAnalysis:()=>ga,ClearCanvas:()=>R,CommonNeighbor:()=>va,ContextMenu:()=>$,Copyright:()=>H,DownLoad:()=>J,Export:()=>oe,FilterPanel:()=>gn,FitCenter:()=>In,FitCenterView:()=>An,FitView:()=>Pn,ForceSimulation:()=>Oa,GrailLayout:()=>Br,GroupBar:()=>Ga,Initializer:()=>$a,LassoSelect:()=>Xr,LayoutSwitch:()=>no,Loading:()=>ro,MiniMap:()=>io,NeighborsQuery:()=>uo,NodeLegend:()=>ho,OperatorBar:()=>Xa,Overview:()=>cs,PathAnalysis:()=>oi,PinNodeWithMenu:()=>us,Placeholder:()=>ii,PropertiesPanel:()=>Si,PropertyGraphInitializer:()=>ds,RemoveNodeWithMenu:()=>ps,SankeyAnalysis:()=>ys,Save:()=>ki,SegmentedLayout:()=>xs,SelectExchangeMenuItem:()=>Es,SideLayout:()=>Is,SideSelectTabs:()=>$s,SideTabs:()=>Hi,ToggleClusterWithMenu:()=>Qi,Toolbar:()=>ta,Tooltip:()=>ra,UadLayout:()=>Us,Watermark:()=>Ys,ZoomIn:()=>tl,ZoomOut:()=>sl,ZoomStatus:()=>ll});var t={};u.r(t),u.d(t,{DonutNode:()=>ul,SimpleEdge:()=>Sl,SimpleNode:()=>Dl});var n={};u.r(n),u.d(n,{Circular:()=>Bl,ClusteringDagre:()=>Hl,Concentric:()=>zl,Dagre:()=>Wl,Force2:()=>Kl,FundForce:()=>Yl,GraphinForce:()=>Xl,Grid:()=>Ql,Radial:()=>Jl});var r={};u.r(r),u.d(r,{GI_SERVICE_INTIAL_GRAPH:()=>tc,GI_SERVICE_SCHEMA:()=>nc});var o={};u.r(o),u.d(o,{NeighborsQuery:()=>rc});var i={};u.r(i),u.d(i,{PropertiesPanel:()=>oc});var a={};u.r(a),u.d(a,{Save:()=>ic});var s={};u.r(s),u.d(s,{WatermarkService:()=>ac});var l={};u.r(l),u.d(l,{Query:()=>hc,Simple:()=>bc});var c=u(618),p=u(725),f=u.n(p),h=u(24),m=u.n(h);const g=e=>{const{graph:t}=(0,c.useContext)();return h.useEffect((()=>{const e=e=>{const{item:n}=e;t.getNodes().forEach((e=>{t.clearItemStates(e)})),t.getEdges().forEach((e=>{t.clearItemStates(e);const r=e.get("sourceNode"),o=e.get("targetNode");e.getID()===n.getID()&&(t.setItemState(e,"selected",!0),t.setItemState(r,"active",!0),t.setItemState(o,"active",!0))}))};return t.on("edge:click",e),()=>{t.off("edge:click",e)}}),[t]),null},y=function(e,t,n){var r,o,i,a,s=0;n||(n={});var l=function(){s=!1===n.leading?0:Date.now(),r=null,a=e.apply(o,i),r||(o=i=null)},c=function(){var c=Date.now();s||!1!==n.leading||(s=c);var u=t-(c-s);return o=this,i=arguments,u<=0||u>t?(r&&(clearTimeout(r),r=null),s=c,a=e.apply(o,i),r||(o=i=null)):r||!1===n.trailing||(r=setTimeout(l,u)),a};return c.cancel=function(){clearTimeout(r),s=0,r=o=i=null},c},v={getDefaultCfg:()=>({trigger:"mouseenter",activeState:"active",inactiveState:"inactive",resetSelected:!1,multiSelectEnabled:!0,modifierKey:"alt",upstreamDegree:1,downstreamDegree:1,shouldUpdate:()=>!0}),getEvents(){return"mouseenter"===this.get("trigger")?{"node:mouseenter":"setAllItemStates","combo:mouseenter":"setAllItemStates","node:mouseleave":"clearActiveState","combo:mouseleave":"clearActiveState","canvas:click":"clearActiveState",keyup:"onKeyUp",keydown:"onKeyDown"}:{"node:click":"setAllItemStates","combo:click":"setAllItemStates","canvas:click":"clearActiveState","node:touchstart":"setOnTouchStart","combo:touchstart":"setOnTouchStart","canvas:touchstart":"clearOnTouchStart",keyup:"onKeyUp",keydown:"onKeyDown"}},setOnTouchStart(e){try{const t=e.originalEvent.touches,n=t[0],r=t[1];if(n&&r)return;e.preventDefault()}catch(e){console.warn("Touch original event not exist!")}this.setAllItemStates(e)},clearOnTouchStart(e){try{const t=e.originalEvent.touches,n=t[0],r=t[1];if(n&&r)return;e.preventDefault()}catch(e){console.warn("Touch original event not exist!")}this.clearActiveState(e)},setAllItemStates(e){clearTimeout(this.timer),this.throttleSetAllItemStates(e,this)},clearActiveState(e){this.multiSelectEnabled&&this.isModifierKeydown||(this.timer=setTimeout((()=>{this.throttleClearActiveState(e,this)}),50))},throttleSetAllItemStates:y(((e,t)=>{const n=e.item,r=t.graph;if(!r||r.destroyed)return;if(t.item=n,!t.shouldUpdate(e.item,{event:e,action:"activate"},t))return;const o=t.activeState,i=t.inactiveState,a=r.getNodes(),s=r.getCombos(),l=r.getEdges(),c=r.get("vedges"),u=a.length,d=s.length,p=l.length,f=c.length,h=t.inactiveItems||{},m=t.activeItems||{},g=t.upstreamDegree||1,y=t.downstreamDegree||1;if(!t.multiSelectEnabled||!t.isModifierKeydown){for(let e=0;e<u;e++){const n=a[e],s=n.getID(),l=n.hasState("selected");t.resetSelected&&l&&r.setItemState(n,"selected",!1),m[s]&&(r.setItemState(n,o,!1),delete m[s]),i&&!h[s]&&(r.setItemState(n,i,!0),h[s]=n)}for(let e=0;e<d;e++){const n=s[e],a=n.getID(),l=n.hasState("selected");t.resetSelected&&l&&r.setItemState(n,"selected",!1),m[a]&&(r.setItemState(n,o,!1),delete m[a]),i&&!h[a]&&(r.setItemState(n,i,!0),h[a]=n)}for(let e=0;e<p;e++){const t=l[e],n=t.getID();m[n]&&(r.setItemState(t,o,!1),delete m[n]),i&&!h[n]&&(r.setItemState(t,i,!0),h[n]=t)}for(let e=0;e<f;e++){const t=c[e],n=t.getID();m[n]&&(r.setItemState(t,o,!1),delete m[n]),i&&!h[n]&&(r.setItemState(t,i,!0),h[n]=t)}}let v;!function(e){e.IN="in",e.OUT="out"}(v||(v={}));const b=[{item:n,direction:v.IN,degree:0},{item:n,direction:v.OUT,degree:0}];for(;b.length>0;){let{item:e,direction:t,degree:n}=b.shift();e&&!e.destroyed&&(i&&h[e.getID()]&&(r.setItemState(e,i,!1),delete h[e.getID()]),m[e.getID()]||(r.setItemState(e,o,!0),m[e.getID()]=e),t===v.IN&&n<g||t===v.OUT&&n<y)&&((t===v.IN?e.getInEdges():e.getOutEdges()).forEach((e=>{const t=e.getID();h[t]&&(r.setItemState(e,i,!1),delete h[t]),m[t]||(r.setItemState(e,o,!0),m[t]=e),e.toFront()})),e.getNeighbors(t===v.IN?"source":"target").forEach((e=>{b.push({item:e,direction:t,degree:n+1})})))}t.activeItems=m,t.inactiveItems=h,r.emit("afteractivaterelations",{item:e.item,action:"activate"})}),50,{trailing:!0,leading:!0}),throttleClearActiveState:y(((e,t)=>{const n=t.get("graph");if(!n||n.destroyed)return;if(!t.shouldUpdate(e.item,{event:e,action:"deactivate"},t))return;const r=t.activeState,o=t.inactiveState,i=t.activeItems||{},a=t.inactiveItems||{};Object.values(i).filter((e=>!e.destroyed)).forEach((e=>{n.clearItemStates(e,r)})),Object.values(a).filter((e=>!e.destroyed)).forEach((e=>{n.clearItemStates(e,o)})),t.activeItems={},t.inactiveItems={},n.emit("afteractivaterelations",{item:e.item||t.get("item"),action:"deactivate"})}),50,{trailing:!0,leading:!0}),onKeyDown(e){const t=this;if(!t.multiSelectEnabled)return;const n=e.key;n&&(n.toLowerCase()===t.modifierKey.toLowerCase()?t.isModifierKeydown=!0:t.isModifierKeydown=!1)},onKeyUp(){this.isModifierKeydown=!1}};const b={disabled:!1,trigger:"mouseenter",activeState:"active",inactiveState:"inactive",resetSelected:!1,upstreamDegree:1,downstreamDegree:1,modifierKey:"alt",multiSelectEnabled:!1};f().registerBehavior("activate-relations-v2",v);const x=e=>((e=>{const{type:t,defaultConfig:n,userProps:r,mode:o="default"}=e,{graph:i}=(0,c.useContext)(),{disabled:a}=r,s=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}(r,["disabled"]);h.useEffect((()=>{if(i.removeBehaviors(t,o),!a)return i.addBehaviors(Object.assign(Object.assign({type:t},n),s),o),()=>{i.destroyed||i.removeBehaviors(t,o)}}),[])})({type:"activate-relations-v2",userProps:e,defaultConfig:b}),null),{Hoverable:E}=p.Behaviors,I={info:{id:"ActivateRelations",name:"元素高亮",desc:"通过交互，激活相关联的节点与边",icon:"icon-canvas-setting",cover:"http://xxxx.jpg",category:"elements-interaction",type:"AUTO",docs:"https://www.yuque.com/antv/gi/rqq14h0071psf9ks"},component:e=>{const{enable:t,trigger:n,upstreamDegree:r,downstreamDegree:o,enableEdgeHover:i,enableNodeHover:a,multiSelectEnabled:s,modifierKey:l}=e,{persistentHighlight:u}=(0,c.useContext)();return m().createElement(m().Fragment,null,t&&!u&&m().createElement(x,{trigger:n,upstreamDegree:r,downstreamDegree:o,multiSelectEnabled:s,modifierKey:l}),a&&m().createElement(E,{bindType:"node"}),i&&m().createElement(E,{bindType:"edge"}),t&&!u&&m().createElement(g,null))},registerMeta:e=>({enableNodeHover:{title:"节点悬停","x-component":"Switch","x-decorator":"FormItem",type:"boolean",default:!0},enableEdgeHover:{title:"边悬停","x-component":"Switch","x-decorator":"FormItem",type:"boolean",default:!0},enable:{title:"启用关联","x-component":"Switch","x-decorator":"FormItem",type:"boolean",default:!0},trigger:{title:"触发方式",type:"string","x-component":"Select","x-decorator":"FormItem","x-component-props":{options:[{label:"鼠标点击",value:"click"},{label:"鼠标移入",value:"mouseenter"}]},default:"click"},upstreamDegree:{title:"上游度数",type:"number","x-component":"NumberPicker","x-decorator":"FormItem",default:1,"x-component-props":{disable:!0}},downstreamDegree:{title:"下游度数",type:"number","x-component":"NumberPicker","x-decorator":"FormItem",default:1,"x-component-props":{disable:!0}},multiSelectEnabled:{title:"允许多选",type:"string","x-component":"Switch","x-decorator":"FormItem",default:!1,"x-component-props":{disable:!0}},modifierKey:{title:"多选组合键, 按下键盘输入组合键，支持Alt, Control, Shift, Meta",type:"string","x-component":"ModifierPicker","x-decorator":"FormItem",default:"alt","x-component-props":{disable:!0}}})},w=()=>{const{graph:e}=(0,c.useContext)();return m().useEffect((()=>{const t=()=>{(e=>{e.setAutoPaint(!1),e.getNodes().forEach((function(t){e.clearItemStates(t)})),e.getEdges().forEach((function(t){e.clearItemStates(t)})),e.paint(),e.setAutoPaint(!0)})(e)};return e.on("canvas:click",t),()=>{e.off("canvas:click",t)}}),[e]),null},C=()=>{const{graph:e}=(0,c.useContext)();return m().useEffect((()=>{const t=()=>{e.fitCenter()};return e.on("canvas:dblclick",t),()=>{e.off("canvas:dblclick",t)}}),[e]),null},{DragCanvas:S,ZoomCanvas:O,BrushSelect:T,Hoverable:A,ActivateRelations:N}=p.Behaviors,k={info:{id:"CanvasSetting",name:"画布设置",desc:"设置画布的背景，缩放，移动等交互",icon:"icon-canvas-setting",cover:"http://xxxx.jpg",category:"canvas-interaction",type:"AUTO",docs:"https://www.yuque.com/antv/gi/aa34nmszaivikxi1"},component:e=>{const{styleCanvas:t,dragCanvas:n,zoomCanvas:r,clearStatus:o,doubleClick:i}=e,{backgroundColor:a,backgroundImage:s}=t,{GISDK_ID:l}=(0,c.useContext)();return m().useLayoutEffect((()=>{const e=document.getElementById(`${l}-graphin-container`),t=e.firstElementChild;e&&t&&(t.style.backgroundColor=a,t.style.backgroundImage=`url(${s})`)}),[a,s]),m().createElement(m().Fragment,null,m().createElement(S,{disabled:n.disabled,direction:n.direction,enableOptimize:n.enableOptimize}),m().createElement(O,{enableOptimize:r.enableOptimize,disabled:r.disabled}),m().createElement(T,null),!1!==o&&m().createElement(w,null),!1!==i&&m().createElement(C,null))},registerMeta:e=>{const{services:t}=e;return{styleCanvas:{title:"画布样式",type:"object",properties:{backgroundColor:{title:"背景颜色","x-component":"ColorInput","x-decorator":"FormItem",type:"string",default:"#fff"},backgroundImage:{title:"背景图片",type:"string","x-component":"Input","x-decorator":"FormItem",default:"https://gw.alipayobjects.com/mdn/rms_0d75e8/afts/img/A*k9t4QamMuQ4AAAAAAAAAAAAAARQnAQ"}}},dragCanvas:{title:"拖拽画布",type:"object",properties:{disabled:{title:"拖拽禁用","x-component":"Switch","x-decorator":"FormItem",type:"boolean",default:!1},direction:{title:"拖拽方向",type:"select","x-component":"Select","x-decorator":"FormItem","x-component-props":{options:[{label:"自由",value:"both"},{label:"X方向",value:"x"},{label:"Y方向",value:"y"}]},default:"both"},enableOptimize:{title:"拖拽优化","x-component":"Switch","x-decorator":"FormItem",type:"boolean",default:!1}}},zoomCanvas:{title:"缩放画布",type:"object",properties:{disabled:{title:"缩放禁用","x-component":"Switch","x-decorator":"FormItem",type:"boolean",default:!1},enableOptimize:{title:"缩放优化",type:"boolean","x-component":"Switch","x-decorator":"FormItem",default:!0}}},clearStatus:{title:"点击画布,清空状态","x-component":"Switch","x-decorator":"FormItem",type:"boolean",default:!0},doubleClick:{title:"双击画布,自适应","x-component":"Switch","x-decorator":"FormItem",type:"boolean",default:!0}}}},{GIAComponent:_}=c.extra,j={id:"ClearCanvas",name:"清空画布",desc:"清空画布上的所有内容",cover:"http://xxxx.jpg",category:"canvas-interaction",type:"GIAC",icon:"icon-clear",docs:"https://www.yuque.com/antv/gi/wvs38gn97xbcn0x0"},{deepClone:F,GIAC_METAS:P}=c.extra,M=F(P);M.GIAC.properties.GIAC.properties.title.default=j.name,M.GIAC.properties.GIAC.properties.icon.default=j.icon,M.GIAC.properties.GIAC.properties.tooltip.default=j.desc,M.GIAC.properties.GIAC.properties.isShowTitle.default=!1;const R={info:j,component:e=>{const{GIAC:t}=e,{graph:n,updateContext:r}=(0,c.useContext)(),o=h.useCallback((()=>{n.clear(),n.fitCenter(),r((e=>{e.source={nodes:[],edges:[]},e.data={nodes:[],edges:[]}}))}),[n,r]);return h.createElement(_,{GIAC:t,onClick:o})},registerMeta:()=>M};var L=u(721);const G={width:"120px",boxShadow:"0 4px 12px rgb(0 0 0 / 15%)"},D=m().createRef(),B=e=>{const{children:t,style:n,setItem:r}=e,o=(e=>{const{bindTypes:t=["node"],container:n}=e,{graph:r}=(0,c.useContext)(),[o,i]=m().useState({visible:!1,x:0,y:0,item:null,selectedItems:[]}),a=e=>{var t,o;e.preventDefault(),e.stopPropagation();const a=r.get("width"),s=r.get("height");if(!n.current)return;const l=n.current.getBoundingClientRect(),c=r.get("offsetX")||0,u=r.get("offsetY")||0,d=r.getContainer().offsetTop,p=r.getContainer().offsetLeft;let f=e.canvasX+p+c,h=e.canvasY+d+u;if(f+l.width>a&&(f=e.canvasX-l.width-c+p),h+l.height>s&&(h=e.canvasY-l.height-u+d),"node"===(null===(o=null===(t=e.item)||void 0===t?void 0:t.getType)||void 0===o?void 0:o.call(t))){const{x:t,y:n}=e.item&&e.item.getModel(),o=r.getCanvasByPoint(t,n),i=e.canvasX-o.x,a=e.canvasY-o.y;f-=i,h-=a}i((t=>Object.assign(Object.assign({},t),{visible:!0,x:f,y:h,item:e.item})))},s=()=>{i((e=>e.visible?Object.assign(Object.assign({},e),{visible:!1,x:0,y:0}):e))};(0,h.useEffect)((()=>{const e=e=>{i((t=>Object.assign(Object.assign({},t),{selectedItems:e.selectedItems})))};return t.forEach((e=>{r.on(`${e}:contextmenu`,a)})),r.on("canvas:click",s),r.on("canvas:drag",s),r.on("wheelzoom",s),t.includes("canvas")&&r.on("nodeselectchange",e),()=>{t.forEach((e=>{r.off(`${e}:contextmenu`,a)})),r.off("canvas:click",s),r.off("canvas:drag",s),r.off("wheelzoom",s),r.off("nodeselectchange",e)}}),[r,t]);const{x:l,y:u,visible:d,item:p,selectedItems:f}=o;return{oneShow:a,onClose:s,item:p,selectedItems:f,visible:d,x:l,y:u}})({container:D}),{visible:i,x:a,y:s,item:l}=o;(0,h.useEffect)((()=>r(l)),[l]);const u={position:"absolute",left:a,top:s};if("function"!=typeof t)return console.error("<ContextMenu /> children should be a function"),null;const d=l&&!l.destroyed&&l.getModel&&l.getModel().id||"";return m().createElement("div",{ref:D,className:"graphin-components-contextmenu",style:Object.assign(Object.assign(Object.assign(Object.assign({},G),n),u),{display:i?"block":"none"}),key:d},t(Object.assign(Object.assign({},o),{id:d})))},z={minWidth:"130px",boxShadow:"0 4px 12px rgb(0 0 0 / 15%)"},$={info:{id:"ContextMenu",name:"右键菜单",desc:"鼠标右键即可出现菜单容器",cover:"http://xxxx.jpg",category:"container-components",type:"GICC_MENU",icon:"icon-mouse",docs:"https://www.yuque.com/antv/gi/slg2190e5bf9m1af"},component:e=>{const{components:t=[],assets:n}=e,[r,o]=m().useState({item:void 0}),i=(0,h.useMemo)((()=>t.sort(((e,t)=>{var n,r;return(null===(n=e.props)||void 0===n?void 0:n.GI_CONTAINER_INDEX)-(null===(r=t.props)||void 0===r?void 0:r.GI_CONTAINER_INDEX)}))),[t,r.item]);return m().createElement(B,{style:z,setItem:e=>o({item:e})},(e=>m().createElement(L.Menu,{mode:"vertical"},i.map((t=>{if(!t)return null;const{props:r,id:o}=t,i=n[o];if(!i)return console.warn(`asset: ${o} not found`),null;const{component:a}=i;return m().createElement(a,Object.assign({},r,{contextmenu:e,key:o}))})))))},registerMeta:e=>{const{GIAC_MENU_ITEMS:t=[]}=e;return t.map((e=>e.value)),{GI_CONTAINER:{title:"可集成组件",type:"string",enum:t,"x-decorator":"FormItem","x-component":"Select","x-component-props":{mode:"multiple"},default:t.map((e=>e.value))}}}},{getPositionStyles:q}=c.utils,U=[{value:"LT",label:"左上"},{value:"RT",label:"右上"},{value:"LB",label:"左下"},{value:"RB",label:"右下"}],V=[{label:"水平展示",value:"horizontal"},{label:"纵向展示",value:"vertical"}],H={info:{id:"Copyright",name:"版权",desc:"在画布上显示应用版权信息",cover:"http://xxx.jpg",category:"system-interaction",icon:"icon-copyright",type:"AUTO",docs:"https://www.yuque.com/antv/gi/rs9d20mrqor8ultw"},component:e=>{const{imageUrl:t,width:n,height:r,placement:o,offset:i}=e,a=q(o,i);return m().createElement("div",{className:"gi-copyright",style:a},m().createElement("img",{src:`${t}`,alt:"版权图片",style:{width:`${n}px`,height:`${r}px`}}))},registerMeta:()=>({imageUrl:{title:"版权图片",type:"string","x-component":"Input","x-decorator":"FormItem",default:""},width:{title:"宽度",type:"number","x-decorator":"FormItem","x-component":"NumberPicker",default:100},height:{title:"高度",type:"number","x-decorator":"FormItem","x-component":"NumberPicker",default:100},placement:{title:"组件位置",type:"string","x-decorator":"FormItem","x-component":"Select",enum:U,default:"RB"},offset:{title:"偏移量",type:"string","x-decorator":"FormItem","x-component":"Offset","x-component-props":{min:0,max:400},default:[100,20]}})},{GIAComponent:W}=c.extra,K={id:"DownLoad",name:"下载",desc:"点击下载画布图片",icon:"icon-download",cover:"http://xxxx.jpg",category:"canvas-interaction",type:"GIAC",docs:"https://www.yuque.com/antv/gi/gvded87rggqt4m7f"},{deepClone:Y,GIAC_METAS:X}=c.extra,Q=Y(X);Q.GIAC.properties.GIAC.properties.title.default=K.name,Q.GIAC.properties.GIAC.properties.icon.default=K.icon,Q.GIAC.properties.GIAC.properties.tooltip.default=K.desc,Q.GIAC.properties.GIAC.properties.isShowTitle.default=!1;const J={info:K,component:e=>{const{GIAC:t}=e,{graph:n}=(0,c.useContext)();return h.createElement(W,{GIAC:t,onClick:()=>n.downloadImage()})},registerMeta:()=>Q},{GIAComponent:Z}=c.extra,ee={id:"Export",name:"导出",desc:"导出CSV,PNG,JSON数据",icon:"icon-export",cover:"http://xxxx.jpg",category:"workbook",type:"GIAC",docs:"https://www.yuque.com/antv/gi/vgsvy7op54os371m"},{deepClone:te,GIAC_METAS:ne}=c.extra,re=te(ne);re.GIAC.properties.GIAC.properties.title.default=ee.name,re.GIAC.properties.GIAC.properties.icon.default=ee.icon,re.GIAC.properties.GIAC.properties.tooltip.default=ee.desc;const oe={info:ee,component:e=>{const{GIAC:t}=e,{graph:n}=(0,c.useContext)();return h.createElement(Z,{GIAC:t,onClick:()=>{const{nodes:e,edges:t}=n.save(),r={nodes:e.map((e=>e.data)),edges:t.map((e=>e.data))},o=document.createElement("a"),i=new Blob([JSON.stringify(r)],{type:"text/json"});o.href=URL.createObjectURL(i),o.download="data.json",document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(o.href)}})},registerMeta:()=>re};function ie(e){return ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ie(e)}function ae(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==ie(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==ie(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===ie(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function se(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function le(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?se(Object(n),!0).forEach((function(t){ae(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):se(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const ce={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M482 152h60q8 0 8 8v704q0 8-8 8h-60q-8 0-8-8V160q0-8 8-8z"}},{tag:"path",attrs:{d:"M176 474h672q8 0 8 8v60q0 8-8 8H176q-8 0-8-8v-60q0-8 8-8z"}}]},name:"plus",theme:"outlined"};function ue(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function de(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,s=[],l=!0,c=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(s.push(r.value),s.length!==t);l=!0);}catch(e){c=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw o}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return ue(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ue(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function pe(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var fe=u(608),he=u.n(fe);const me=(0,h.createContext)({});function ge(e,t){(function(e){return"string"==typeof e&&-1!==e.indexOf(".")&&1===parseFloat(e)})(e)&&(e="100%");var n=function(e){return"string"==typeof e&&-1!==e.indexOf("%")}(e);return e=360===t?e:Math.min(t,Math.max(0,parseFloat(e))),n&&(e=parseInt(String(e*t),10)/100),Math.abs(e-t)<1e-6?1:e=360===t?(e<0?e%t+t:e%t)/parseFloat(String(t)):e%t/parseFloat(String(t))}function ye(e){return e<=1?"".concat(100*Number(e),"%"):e}function ve(e){return 1===e.length?"0"+e:String(e)}function be(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*n*(t-e):n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e}function xe(e){return Ee(e)/255}function Ee(e){return parseInt(e,16)}var Ie={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function we(e){var t={r:0,g:0,b:0},n=1,r=null,o=null,i=null,a=!1,s=!1;return"string"==typeof e&&(e=function(e){if(0===(e=e.trim().toLowerCase()).length)return!1;var t=!1;if(Ie[e])e=Ie[e],t=!0;else if("transparent"===e)return{r:0,g:0,b:0,a:0,format:"name"};var n=Te.rgb.exec(e);return n?{r:n[1],g:n[2],b:n[3]}:(n=Te.rgba.exec(e))?{r:n[1],g:n[2],b:n[3],a:n[4]}:(n=Te.hsl.exec(e))?{h:n[1],s:n[2],l:n[3]}:(n=Te.hsla.exec(e))?{h:n[1],s:n[2],l:n[3],a:n[4]}:(n=Te.hsv.exec(e))?{h:n[1],s:n[2],v:n[3]}:(n=Te.hsva.exec(e))?{h:n[1],s:n[2],v:n[3],a:n[4]}:(n=Te.hex8.exec(e))?{r:Ee(n[1]),g:Ee(n[2]),b:Ee(n[3]),a:xe(n[4]),format:t?"name":"hex8"}:(n=Te.hex6.exec(e))?{r:Ee(n[1]),g:Ee(n[2]),b:Ee(n[3]),format:t?"name":"hex"}:(n=Te.hex4.exec(e))?{r:Ee(n[1]+n[1]),g:Ee(n[2]+n[2]),b:Ee(n[3]+n[3]),a:xe(n[4]+n[4]),format:t?"name":"hex8"}:!!(n=Te.hex3.exec(e))&&{r:Ee(n[1]+n[1]),g:Ee(n[2]+n[2]),b:Ee(n[3]+n[3]),format:t?"name":"hex"}}(e)),"object"==typeof e&&(Ae(e.r)&&Ae(e.g)&&Ae(e.b)?(t=function(e,t,n){return{r:255*ge(e,255),g:255*ge(t,255),b:255*ge(n,255)}}(e.r,e.g,e.b),a=!0,s="%"===String(e.r).substr(-1)?"prgb":"rgb"):Ae(e.h)&&Ae(e.s)&&Ae(e.v)?(r=ye(e.s),o=ye(e.v),t=function(e,t,n){e=6*ge(e,360),t=ge(t,100),n=ge(n,100);var r=Math.floor(e),o=e-r,i=n*(1-t),a=n*(1-o*t),s=n*(1-(1-o)*t),l=r%6;return{r:255*[n,a,i,i,s,n][l],g:255*[s,n,n,a,i,i][l],b:255*[i,i,s,n,n,a][l]}}(e.h,r,o),a=!0,s="hsv"):Ae(e.h)&&Ae(e.s)&&Ae(e.l)&&(r=ye(e.s),i=ye(e.l),t=function(e,t,n){var r,o,i;if(e=ge(e,360),t=ge(t,100),n=ge(n,100),0===t)o=n,i=n,r=n;else{var a=n<.5?n*(1+t):n+t-n*t,s=2*n-a;r=be(s,a,e+1/3),o=be(s,a,e),i=be(s,a,e-1/3)}return{r:255*r,g:255*o,b:255*i}}(e.h,r,i),a=!0,s="hsl"),Object.prototype.hasOwnProperty.call(e,"a")&&(n=e.a)),n=function(e){return e=parseFloat(e),(isNaN(e)||e<0||e>1)&&(e=1),e}(n),{ok:a,format:e.format||s,r:Math.min(255,Math.max(t.r,0)),g:Math.min(255,Math.max(t.g,0)),b:Math.min(255,Math.max(t.b,0)),a:n}}var Ce="(?:".concat("[-\\+]?\\d*\\.\\d+%?",")|(?:").concat("[-\\+]?\\d+%?",")"),Se="[\\s|\\(]+(".concat(Ce,")[,|\\s]+(").concat(Ce,")[,|\\s]+(").concat(Ce,")\\s*\\)?"),Oe="[\\s|\\(]+(".concat(Ce,")[,|\\s]+(").concat(Ce,")[,|\\s]+(").concat(Ce,")[,|\\s]+(").concat(Ce,")\\s*\\)?"),Te={CSS_UNIT:new RegExp(Ce),rgb:new RegExp("rgb"+Se),rgba:new RegExp("rgba"+Oe),hsl:new RegExp("hsl"+Se),hsla:new RegExp("hsla"+Oe),hsv:new RegExp("hsv"+Se),hsva:new RegExp("hsva"+Oe),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};function Ae(e){return Boolean(Te.CSS_UNIT.exec(String(e)))}var Ne=2,ke=.16,_e=.05,je=.05,Fe=.15,Pe=5,Me=4,Re=[{index:7,opacity:.15},{index:6,opacity:.25},{index:5,opacity:.3},{index:5,opacity:.45},{index:5,opacity:.65},{index:5,opacity:.85},{index:4,opacity:.9},{index:3,opacity:.95},{index:2,opacity:.97},{index:1,opacity:.98}];function Le(e){var t=function(e,t,n){e=ge(e,255),t=ge(t,255),n=ge(n,255);var r=Math.max(e,t,n),o=Math.min(e,t,n),i=0,a=r,s=r-o,l=0===r?0:s/r;if(r===o)i=0;else{switch(r){case e:i=(t-n)/s+(t<n?6:0);break;case t:i=(n-e)/s+2;break;case n:i=(e-t)/s+4}i/=6}return{h:i,s:l,v:a}}(e.r,e.g,e.b);return{h:360*t.h,s:t.s,v:t.v}}function Ge(e){var t=e.r,n=e.g,r=e.b;return"#".concat(function(e,t,n,r){var o=[ve(Math.round(e).toString(16)),ve(Math.round(t).toString(16)),ve(Math.round(n).toString(16))];return o.join("")}(t,n,r))}function De(e,t,n){var r;return(r=Math.round(e.h)>=60&&Math.round(e.h)<=240?n?Math.round(e.h)-Ne*t:Math.round(e.h)+Ne*t:n?Math.round(e.h)+Ne*t:Math.round(e.h)-Ne*t)<0?r+=360:r>=360&&(r-=360),r}function Be(e,t,n){return 0===e.h&&0===e.s?e.s:((r=n?e.s-ke*t:t===Me?e.s+ke:e.s+_e*t)>1&&(r=1),n&&t===Pe&&r>.1&&(r=.1),r<.06&&(r=.06),Number(r.toFixed(2)));var r}function ze(e,t,n){var r;return(r=n?e.v+je*t:e.v-Fe*t)>1&&(r=1),Number(r.toFixed(2))}function $e(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=[],r=we(e),o=Pe;o>0;o-=1){var i=Le(r),a=Ge(we({h:De(i,o,!0),s:Be(i,o,!0),v:ze(i,o,!0)}));n.push(a)}n.push(Ge(r));for(var s=1;s<=Me;s+=1){var l=Le(r),c=Ge(we({h:De(l,s),s:Be(l,s),v:ze(l,s)}));n.push(c)}return"dark"===t.theme?Re.map((function(e){var r=e.index,o=e.opacity,i=Ge(function(e,t,n){var r=n/100;return{r:(t.r-e.r)*r+e.r,g:(t.g-e.g)*r+e.g,b:(t.b-e.b)*r+e.b}}(we(t.backgroundColor||"#141414"),we(n[r]),100*o));return i})):n}var qe={red:"#F5222D",volcano:"#FA541C",orange:"#FA8C16",gold:"#FAAD14",yellow:"#FADB14",lime:"#A0D911",green:"#52C41A",cyan:"#13C2C2",blue:"#1677FF",geekblue:"#2F54EB",purple:"#722ED1",magenta:"#EB2F96",grey:"#666666"},Ue={},Ve={};Object.keys(qe).forEach((function(e){Ue[e]=$e(qe[e]),Ue[e].primary=Ue[e][5],Ve[e]=$e(qe[e],{theme:"dark",backgroundColor:"#141414"}),Ve[e].primary=Ve[e][5]})),Ue.red,Ue.volcano,Ue.gold,Ue.orange,Ue.yellow,Ue.lime,Ue.green,Ue.cyan,Ue.blue,Ue.geekblue,Ue.purple,Ue.magenta,Ue.grey,Ue.grey;var He={},We=[];function Ke(e,t){}function Ye(e,t){}function Xe(e,t,n){t||He[n]||(e(!1,n),He[n]=!0)}function Qe(e,t){Xe(Ke,e,t)}Qe.preMessage=function(e){We.push(e)},Qe.resetWarned=function(){He={}},Qe.noteOnce=function(e,t){Xe(Ye,e,t)};const Je=Qe;var Ze="data-rc-order",et="rc-util-key",tt=new Map;function nt(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).mark;return e?e.startsWith("data-")?e:"data-".concat(e):et}function rt(e){return e.attachTo?e.attachTo:document.querySelector("head")||document.body}function ot(e){return Array.from((tt.get(e)||e).children).filter((function(e){return"STYLE"===e.tagName}))}function it(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("undefined"==typeof window||!window.document||!window.document.createElement)return null;var n=t.csp,r=t.prepend,o=document.createElement("style");o.setAttribute(Ze,function(e){return"queue"===e?"prependQueue":e?"prepend":"append"}(r)),null!=n&&n.nonce&&(o.nonce=null==n?void 0:n.nonce),o.innerHTML=e;var i=rt(t),a=i.firstChild;if(r){if("queue"===r){var s=ot(i).filter((function(e){return["prepend","prependQueue"].includes(e.getAttribute(Ze))}));if(s.length)return i.insertBefore(o,s[s.length-1].nextSibling),o}i.insertBefore(o,a)}else i.appendChild(o);return o}function at(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!function(e,t){var n=tt.get(e);if(!n||!function(e,t){if(!e)return!1;if(e.contains)return e.contains(t);for(var n=t;n;){if(n===e)return!0;n=n.parentNode}return!1}(document,n)){var r=it("",t),o=r.parentNode;tt.set(e,o),e.removeChild(r)}}(rt(n),n);var r,o,i,a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return ot(rt(t)).find((function(n){return n.getAttribute(nt(t))===e}))}(t,n);if(a)return null!==(r=n.csp)&&void 0!==r&&r.nonce&&a.nonce!==(null===(o=n.csp)||void 0===o?void 0:o.nonce)&&(a.nonce=null===(i=n.csp)||void 0===i?void 0:i.nonce),a.innerHTML!==e&&(a.innerHTML=e),a;var s=it(e,n);return s.setAttribute(nt(n),t),s}function st(e){return"object"===ie(e)&&"string"==typeof e.name&&"string"==typeof e.theme&&("object"===ie(e.icon)||"function"==typeof e.icon)}function lt(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.keys(e).reduce((function(t,n){var r=e[n];return"class"===n?(t.className=r,delete t.class):t[n]=r,t}),{})}function ct(e,t,n){return n?m().createElement(e.tag,le(le({key:t},lt(e.attrs)),n),(e.children||[]).map((function(n,r){return ct(n,"".concat(t,"-").concat(e.tag,"-").concat(r))}))):m().createElement(e.tag,le({key:t},lt(e.attrs)),(e.children||[]).map((function(n,r){return ct(n,"".concat(t,"-").concat(e.tag,"-").concat(r))})))}function ut(e){return $e(e)[0]}function dt(e){return e?Array.isArray(e)?e:[e]:[]}var pt=["icon","className","onClick","style","primaryColor","secondaryColor"],ft={primaryColor:"#333",secondaryColor:"#E6E6E6",calculated:!1},ht=function(e){var t,n,r=e.icon,o=e.className,i=e.onClick,a=e.style,s=e.primaryColor,l=e.secondaryColor,c=pe(e,pt),u=ft;if(s&&(u={primaryColor:s,secondaryColor:l||ut(s)}),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"\n.anticon {\n  display: inline-block;\n  color: inherit;\n  font-style: normal;\n  line-height: 0;\n  text-align: center;\n  text-transform: none;\n  vertical-align: -0.125em;\n  text-rendering: optimizeLegibility;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n.anticon > * {\n  line-height: 1;\n}\n\n.anticon svg {\n  display: inline-block;\n}\n\n.anticon::before {\n  display: none;\n}\n\n.anticon .anticon-icon {\n  display: block;\n}\n\n.anticon[tabindex] {\n  cursor: pointer;\n}\n\n.anticon-spin::before,\n.anticon-spin {\n  display: inline-block;\n  -webkit-animation: loadingCircle 1s infinite linear;\n  animation: loadingCircle 1s infinite linear;\n}\n\n@-webkit-keyframes loadingCircle {\n  100% {\n    -webkit-transform: rotate(360deg);\n    transform: rotate(360deg);\n  }\n}\n\n@keyframes loadingCircle {\n  100% {\n    -webkit-transform: rotate(360deg);\n    transform: rotate(360deg);\n  }\n}\n",t=(0,h.useContext)(me),n=t.csp,r=t.prefixCls,o=e;r&&(o=o.replace(/anticon/g,r)),(0,h.useEffect)((function(){at(o,"@ant-design-icons",{prepend:!0,csp:n})}),[])}(),t=st(r),n="icon should be icon definiton, but got ".concat(r),Je(t,"[@ant-design/icons] ".concat(n)),!st(r))return null;var d=r;return d&&"function"==typeof d.icon&&(d=le(le({},d),{},{icon:d.icon(u.primaryColor,u.secondaryColor)})),ct(d.icon,"svg-".concat(d.name),le({className:o,onClick:i,style:a,"data-icon":d.name,width:"1em",height:"1em",fill:"currentColor","aria-hidden":"true"},c))};ht.displayName="IconReact",ht.getTwoToneColors=function(){return le({},ft)},ht.setTwoToneColors=function(e){var t=e.primaryColor,n=e.secondaryColor;ft.primaryColor=t,ft.secondaryColor=n||ut(t),ft.calculated=!!n};const mt=ht;function gt(e){var t=de(dt(e),2),n=t[0],r=t[1];return mt.setTwoToneColors({primaryColor:n,secondaryColor:r})}var yt=["className","icon","spin","rotate","tabIndex","onClick","twoToneColor"];gt("#1890ff");var vt=h.forwardRef((function(e,t){var n,r=e.className,o=e.icon,i=e.spin,a=e.rotate,s=e.tabIndex,l=e.onClick,c=e.twoToneColor,u=pe(e,yt),d=h.useContext(me),p=d.prefixCls,f=void 0===p?"anticon":p,m=d.rootClassName,g=he()(m,f,(ae(n={},"".concat(f,"-").concat(o.name),!!o.name),ae(n,"".concat(f,"-spin"),!!i||"loading"===o.name),n),r),y=s;void 0===y&&l&&(y=-1);var v=a?{msTransform:"rotate(".concat(a,"deg)"),transform:"rotate(".concat(a,"deg)")}:void 0,b=de(dt(c),2),x=b[0],E=b[1];return h.createElement("span",le(le({role:"img","aria-label":o.name},u),{},{ref:t,tabIndex:y,onClick:l,className:g}),h.createElement(mt,{icon:o,primaryColor:x,secondaryColor:E,style:v}))}));vt.displayName="AntdIcon",vt.getTwoToneColor=function(){var e=mt.getTwoToneColors();return e.calculated?[e.primaryColor,e.secondaryColor]:e.primaryColor},vt.setTwoToneColor=gt;const bt=vt;var xt=function(e,t){return h.createElement(bt,le(le({},e),{},{ref:t,icon:ce}))};xt.displayName="PlusOutlined";const Et=h.forwardRef(xt),It={icon:function(e,t){return{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M737 438.6c-9.6 15.5-21.1 30.7-34.4 45.6a73.1 73.1 0 01-51 24.4 73.36 73.36 0 01-53.4-18.8 74.01 74.01 0 01-24.4-59.8c3-47.4-12.4-103.1-45.8-165.7-16.9-31.4-37.1-58.2-61.2-80.4a240 240 0 01-12.1 46.5 354.26 354.26 0 01-58.2 101 349.6 349.6 0 01-58.6 56.8c-34 26.1-62 60-80.8 97.9a275.96 275.96 0 00-29.1 124c0 74.9 29.5 145.3 83 198.4 53.7 53.2 125 82.4 201 82.4s147.3-29.2 201-82.4c53.5-53 83-123.5 83-198.4 0-39.2-8.1-77.3-24-113.1-9.3-21-21-40.5-35-58.4z",fill:t}},{tag:"path",attrs:{d:"M834.1 469.2A347.49 347.49 0 00751.2 354l-29.1-26.7a8.09 8.09 0 00-13 3.3l-13 37.3c-8.1 23.4-23 47.3-44.1 70.8-1.4 1.5-3 1.9-4.1 2-1.1.1-2.8-.1-4.3-1.5-1.4-1.2-2.1-3-2-4.8 3.7-60.2-14.3-128.1-53.7-202C555.3 171 510 123.1 453.4 89.7l-41.3-24.3c-5.4-3.2-12.3 1-12 7.3l2.2 48c1.5 32.8-2.3 61.8-11.3 85.9-11 29.5-26.8 56.9-47 81.5a295.64 295.64 0 01-47.5 46.1 352.6 352.6 0 00-100.3 121.5A347.75 347.75 0 00160 610c0 47.2 9.3 92.9 27.7 136a349.4 349.4 0 0075.5 110.9c32.4 32 70 57.2 111.9 74.7C418.5 949.8 464.5 959 512 959s93.5-9.2 136.9-27.3A348.6 348.6 0 00760.8 857c32.4-32 57.8-69.4 75.5-110.9a344.2 344.2 0 0027.7-136c0-48.8-10-96.2-29.9-140.9zM713 808.5c-53.7 53.2-125 82.4-201 82.4s-147.3-29.2-201-82.4c-53.5-53.1-83-123.5-83-198.4 0-43.5 9.8-85.2 29.1-124 18.8-37.9 46.8-71.8 80.8-97.9a349.6 349.6 0 0058.6-56.8c25-30.5 44.6-64.5 58.2-101a240 240 0 0012.1-46.5c24.1 22.2 44.3 49 61.2 80.4 33.4 62.6 48.8 118.3 45.8 165.7a74.01 74.01 0 0024.4 59.8 73.36 73.36 0 0053.4 18.8c19.7-1 37.8-9.7 51-24.4 13.3-14.9 24.8-30.1 34.4-45.6 14 17.9 25.7 37.4 35 58.4 15.9 35.8 24 73.9 24 113.1 0 74.9-29.5 145.4-83 198.4z",fill:e}}]}},name:"fire",theme:"twotone"};var wt=function(e,t){return h.createElement(bt,le(le({},e),{},{ref:t,icon:It}))};wt.displayName="FireTwoTone";const Ct=h.forwardRef(wt);let St=(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce(((e,t)=>e+((t&=63)<36?t.toString(36):t<62?(t-26).toString(36).toUpperCase():t>62?"-":"_")),"");const Ot={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M875.6 515.9c2.1.8 4.4-.3 5.2-2.4.2-.4.2-.9.2-1.4v-58.3c0-1.8-1.1-3.3-2.8-3.8-6-1.8-17.2-3-27.2-3-32.9 0-61.7 16.7-73.5 41.2v-28.6c0-4.4-3.6-8-8-8H717c-4.4 0-8 3.6-8 8V729c0 4.4 3.6 8 8 8h54.8c4.4 0 8-3.6 8-8V572.7c0-36.2 26.1-60.2 65.1-60.2 10.4.1 26.6 1.8 30.7 3.4zm-537-40.5l-54.7-12.6c-61.2-14.2-87.7-34.8-87.7-70.7 0-44.6 39.1-73.5 96.9-73.5 52.8 0 91.4 26.5 99.9 68.9h70C455.9 311.6 387.6 259 293.4 259c-103.3 0-171 55.5-171 139 0 68.6 38.6 109.5 122.2 128.5l61.6 14.3c63.6 14.9 91.6 37.1 91.6 75.1 0 44.1-43.5 75.2-102.5 75.2-60.6 0-104.5-27.2-112.8-70.5H111c7.2 79.9 75.6 130.4 179.1 130.4C402.3 751 471 695.2 471 605.3c0-70.2-38.6-108.5-132.4-129.9zM841 729a36 36 0 1072 0 36 36 0 10-72 0zM653 457.8h-51.4V396c0-4.4-3.6-8-8-8h-54.7c-4.4 0-8 3.6-8 8v61.8H495c-4.4 0-8 3.6-8 8v42.3c0 4.4 3.6 8 8 8h35.9v147.5c0 56.2 27.4 79.4 93.1 79.4 11.7 0 23.6-1.2 33.8-3.1 1.9-.3 3.2-2 3.2-3.9v-49.3c0-2.2-1.8-4-4-4h-.4c-4.9.5-6.2.6-8.3.8-4.1.3-7.8.5-12.6.5-24.1 0-34.1-10.3-34.1-35.6V516.1H653c4.4 0 8-3.6 8-8v-42.3c0-4.4-3.6-8-8-8z"}}]},name:"field-string",theme:"outlined"};var Tt=function(e,t){return h.createElement(bt,le(le({},e),{},{ref:t,icon:Ot}))};Tt.displayName="FieldStringOutlined";const At=h.forwardRef(Tt),Nt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M872 394c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8H708V152c0-4.4-3.6-8-8-8h-64c-4.4 0-8 3.6-8 8v166H400V152c0-4.4-3.6-8-8-8h-64c-4.4 0-8 3.6-8 8v166H152c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h168v236H152c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h168v166c0 4.4 3.6 8 8 8h64c4.4 0 8-3.6 8-8V706h228v166c0 4.4 3.6 8 8 8h64c4.4 0 8-3.6 8-8V706h164c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8H708V394h164zM628 630H400V394h228v236z"}}]},name:"number",theme:"outlined"};var kt=function(e,t){return h.createElement(bt,le(le({},e),{},{ref:t,icon:Nt}))};kt.displayName="NumberOutlined";const _t=h.forwardRef(kt),jt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M945 412H689c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h256c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8zM811 548H689c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h122c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8zM477.3 322.5H434c-6.2 0-11.2 5-11.2 11.2v248c0 3.6 1.7 6.9 4.6 9l148.9 108.6c5 3.6 12 2.6 15.6-2.4l25.7-35.1v-.1c3.6-5 2.5-12-2.5-15.6l-126.7-91.6V333.7c.1-6.2-5-11.2-11.1-11.2z"}},{tag:"path",attrs:{d:"M804.8 673.9H747c-5.6 0-10.9 2.9-13.9 7.7a321 321 0 01-44.5 55.7 317.17 317.17 0 01-101.3 68.3c-39.3 16.6-81 25-124 25-43.1 0-84.8-8.4-124-25-37.9-16-72-39-101.3-68.3s-52.3-63.4-68.3-101.3c-16.6-39.2-25-80.9-25-124 0-43.1 8.4-84.7 25-124 16-37.9 39-72 68.3-101.3 29.3-29.3 63.4-52.3 101.3-68.3 39.2-16.6 81-25 124-25 43.1 0 84.8 8.4 124 25 37.9 16 72 39 101.3 68.3a321 321 0 0144.5 55.7c3 4.8 8.3 7.7 13.9 7.7h57.8c6.9 0 11.3-7.2 8.2-13.3-65.2-129.7-197.4-214-345-215.7-216.1-2.7-395.6 174.2-396 390.1C71.6 727.5 246.9 903 463.2 903c149.5 0 283.9-84.6 349.8-215.8a9.18 9.18 0 00-8.2-13.3z"}}]},name:"field-time",theme:"outlined"};var Ft=function(e,t){return h.createElement(bt,le(le({},e),{},{ref:t,icon:jt}))};Ft.displayName="FieldTimeOutlined";const Pt=h.forwardRef(Ft),Mt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M888 792H200V168c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v688c0 4.4 3.6 8 8 8h752c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm-600-80h56c4.4 0 8-3.6 8-8V560c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v144c0 4.4 3.6 8 8 8zm152 0h56c4.4 0 8-3.6 8-8V384c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v320c0 4.4 3.6 8 8 8zm152 0h56c4.4 0 8-3.6 8-8V462c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v242c0 4.4 3.6 8 8 8zm152 0h56c4.4 0 8-3.6 8-8V304c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v400c0 4.4 3.6 8 8 8z"}}]},name:"bar-chart",theme:"outlined"};var Rt=function(e,t){return h.createElement(bt,le(le({},e),{},{ref:t,icon:Mt}))};Rt.displayName="BarChartOutlined";const Lt=h.forwardRef(Rt),Gt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M864 518H506V160c0-4.4-3.6-8-8-8h-26a398.46 398.46 0 00-282.8 117.1 398.19 398.19 0 00-85.7 127.1A397.61 397.61 0 0072 552a398.46 398.46 0 00117.1 282.8c36.7 36.7 79.5 65.6 127.1 85.7A397.61 397.61 0 00472 952a398.46 398.46 0 00282.8-117.1c36.7-36.7 65.6-79.5 85.7-127.1A397.61 397.61 0 00872 552v-26c0-4.4-3.6-8-8-8zM705.7 787.8A331.59 331.59 0 01470.4 884c-88.1-.4-170.9-34.9-233.2-97.2C174.5 724.1 140 640.7 140 552c0-88.7 34.5-172.1 97.2-234.8 54.6-54.6 124.9-87.9 200.8-95.5V586h364.3c-7.7 76.3-41.3 147-96.6 201.8zM952 462.4l-2.6-28.2c-8.5-92.1-49.4-179-115.2-244.6A399.4 399.4 0 00589 74.6L560.7 72c-4.7-.4-8.7 3.2-8.7 7.9V464c0 4.4 3.6 8 8 8l384-1c4.7 0 8.4-4 8-8.6zm-332.2-58.2V147.6a332.24 332.24 0 01166.4 89.8c45.7 45.6 77 103.6 90 166.1l-256.4.7z"}}]},name:"pie-chart",theme:"outlined"};var Dt=function(e,t){return h.createElement(bt,le(le({},e),{},{ref:t,icon:Gt}))};Dt.displayName="PieChartOutlined";const Bt=h.forwardRef(Dt),zt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h360c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H184V184h656v320c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V144c0-17.7-14.3-32-32-32zM653.3 599.4l52.2-52.2a8.01 8.01 0 00-4.7-13.6l-179.4-21c-5.1-.6-9.5 3.7-8.9 8.9l21 179.4c.8 6.6 8.9 9.4 13.6 4.7l52.4-52.4 256.2 256.2c3.1 3.1 8.2 3.1 11.3 0l42.4-42.4c3.1-3.1 3.1-8.2 0-11.3L653.3 599.4z"}}]},name:"select",theme:"outlined"};var $t=function(e,t){return h.createElement(bt,le(le({},e),{},{ref:t,icon:zt}))};$t.displayName="SelectOutlined";const qt=h.forwardRef($t),Ut={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M360 184h-8c4.4 0 8-3.6 8-8v8h304v-8c0 4.4 3.6 8 8 8h-8v72h72v-80c0-35.3-28.7-64-64-64H352c-35.3 0-64 28.7-64 64v80h72v-72zm504 72H160c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h60.4l24.7 523c1.6 34.1 29.8 61 63.9 61h454c34.2 0 62.3-26.8 63.9-61l24.7-523H888c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zM731.3 840H292.7l-24.2-512h487l-24.2 512z"}}]},name:"delete",theme:"outlined"};var Vt=function(e,t){return h.createElement(bt,le(le({},e),{},{ref:t,icon:Ut}))};Vt.displayName="DeleteOutlined";const Ht=h.forwardRef(Vt);var Wt=u(770);const Kt=e=>{const{filterCriteria:t,updateFilterCriteria:n}=e,{chartData:r=new Map}=t;return(0,h.useEffect)((()=>{const e=[...r.values()].reduce(((e,t)=>e+t),0),o=[...r.entries()].map((e=>{const[t,n]=e;return{x:t,value:n}})),i=new Wt.Pie(`${t.id}-chart-container`,{height:200,data:o,angleField:"value",colorField:"x",radius:.9,label:{type:"inner",offset:"-30%",content:({value:t})=>`${(t/e*100).toFixed(0)}%`,style:{fontSize:14,textAlign:"center"}},interactions:[{type:"element-selected"},{type:"element-active"}]});return i.render(),i.on("element:click",(({view:e})=>{const r=t.id,o=e.geometries[0].elements.filter((e=>-1!==e.states.indexOf("selected"))).map((e=>e.data.x)),i=0!==o.length;n(r,Object.assign(Object.assign({},t),{isFilterReady:i,selectValue:o}))})),i.setState("selected",(e=>!!t.selectValue&&-1!==t.selectValue.indexOf(e.x))),()=>{i.destroy()}}),[r]),m().createElement("div",{id:`${t.id}-chart-container`})},Yt=e=>{const{filterCriteria:t,updateFilterCriteria:n}=e,{chartData:r=new Map}=t;return(0,h.useEffect)((()=>{const e=[...r.entries()].map((e=>{const[t,n]=e;return{x:t,value:n,category:""}})),o=new Wt.WordCloud(`${t.id}-chart-container`,{data:e,height:200,wordField:"x",weightField:"value",color:"#122c6a",wordStyle:{fontFamily:"Verdana",fontSize:[10,16]},interactions:[{type:"element-active"},{type:"element-selected"}],state:{active:{style:{lineWidth:3}}}});return o.on("element:click",(({view:e})=>{const r=e.geometries[0].elements.filter((e=>-1!==e.states.indexOf("selected"))).map((e=>e.data.datum.x)),o=0!==r.length;n(t.id,Object.assign(Object.assign({},t),{isFilterReady:o,selectValue:r}))})),o.render(),()=>{o.destroy()}}),[r]),m().createElement("div",{id:`${t.id}-chart-container`})},Xt=e=>{const{filterCriteria:t,updateFilterCriteria:n,highlightRank:r}=e,{chartData:o=new Map,selectOptions:i=[]}=t;return(0,h.useEffect)((()=>{Wt.G2.registerInteraction("element-highlight",{start:[{trigger:"element:click",action:"element-highlight:toggle"}]})}),[]),(0,h.useEffect)((()=>{const e=o.size,a=r&&r>e?e-1:r,s=[...o.entries()].map(((e,t)=>{const[n,r]=e,{rank:o=1/0,isOutlier:s=!1}=i[t]||{};return{x:n,y:r,highlight:!!(a&&o<a),isOutlier:s}})),l=new Wt.Column(`${t.id}-chart-container`,{data:s,xField:"x",yField:"y",height:200,seriesField:"highlight",color:({highlight:e})=>e?"#eb2f96":"rgba(111, 147, 222, 1)",label:{content:({highlight:e,isOutlier:t,y:n})=>{if(e&&!t)return n},style:{fill:"#eb2f96",fontSize:10},offset:4,position:"top"},tooltip:{fields:["x","y"],formatter:e=>({name:e.x,value:e.y})},interactions:[{type:"element-highlight"}],state:{active:{style:{lineWidth:0}}},legend:!1});return l.on("element:click",(({view:e})=>{const r=t.id,o=e.geometries[0].elements.filter((e=>-1!==e.states.indexOf("active"))).map((e=>e.data.x)),i=0!==o.length;n(r,Object.assign(Object.assign({},t),{isFilterReady:i,selectValue:o}))})),l.render(),l.setState("active",(e=>!(!t.isFilterReady||!t.selectValue)&&t.selectValue.includes(e.x))),l.setState("inactive",(e=>!(!t.isFilterReady||!t.selectValue||t.selectValue.includes(e.x)))),()=>{l.destroy()}}),[o,i,r]),m().createElement("div",{id:`${t.id}-chart-container`})},Qt=e=>{const{filterCriteria:t,updateFilterCriteria:n}=e,{histogramData:r=[{}],histogramOptions:o}=t,{min:i,max:a,binWidth:s,isCustom:l}=o||{};return(0,h.useEffect)((()=>{Wt.G2.registerInteraction("element-highlight",{start:[{trigger:"element:click",action:"element-highlight:toggle"}]})}),[]),(0,h.useEffect)((()=>{const e=l?{binWidth:s,meta:{range:{min:i,max:a,nice:!0},count:{nice:!0}}}:{meta:{range:{nice:!0},count:{nice:!0}}},o=new Wt.Histogram(`${t.id}-chart-container`,Object.assign({data:r,height:200,binField:"value",color:"rgba(111, 147, 222, 1)",tooltip:{},interactions:[{type:"element-highlight"}],state:{active:{style:{fill:"rgba(56, 83, 215, 1)",lineWidth:0}}}},e));return o.on("element:click",(({view:e})=>{const r=e.geometries[0].elements.filter((e=>-1!==e.states.indexOf("active"))).map((e=>e.data.range)),o=0!==r.length;n(t.id,Object.assign(Object.assign({},t),{isFilterReady:o,range:r}))})),o.render(),o.setState("active",(e=>{if(!t.range||!t.isFilterReady)return!1;for(let n of t.range){const t=n[0],r=n[1];if(e.range[0]===t&&e.range[1]===r)return!0}return!1})),o.setState("inactive",(e=>{if(!t.range||!t.isFilterReady)return!1;for(let n of t.range){const t=n[0],r=n[1];if(e.range[0]===t&&e.range[1]===r)return!1}return!0})),()=>{o.destroy()}}),[r,i,a,s,l]),m().createElement("div",{id:`${t.id}-chart-container`})},Jt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M320 224h-66v-56c0-4.4-3.6-8-8-8h-52c-4.4 0-8 3.6-8 8v56h-66c-4.4 0-8 3.6-8 8v560c0 4.4 3.6 8 8 8h66v56c0 4.4 3.6 8 8 8h52c4.4 0 8-3.6 8-8v-56h66c4.4 0 8-3.6 8-8V232c0-4.4-3.6-8-8-8zm-60 508h-80V292h80v440zm644-436h-66v-96c0-4.4-3.6-8-8-8h-52c-4.4 0-8 3.6-8 8v96h-66c-4.4 0-8 3.6-8 8v416c0 4.4 3.6 8 8 8h66v96c0 4.4 3.6 8 8 8h52c4.4 0 8-3.6 8-8v-96h66c4.4 0 8-3.6 8-8V304c0-4.4-3.6-8-8-8zm-60 364h-80V364h80v296zM612 404h-66V232c0-4.4-3.6-8-8-8h-52c-4.4 0-8 3.6-8 8v172h-66c-4.4 0-8 3.6-8 8v200c0 4.4 3.6 8 8 8h66v172c0 4.4 3.6 8 8 8h52c4.4 0 8-3.6 8-8V620h66c4.4 0 8-3.6 8-8V412c0-4.4-3.6-8-8-8zm-60 145a3 3 0 01-3 3h-74a3 3 0 01-3-3v-74a3 3 0 013-3h74a3 3 0 013 3v74z"}}]},name:"sliders",theme:"outlined"};var Zt=function(e,t){return h.createElement(bt,le(le({},e),{},{ref:t,icon:Jt}))};Zt.displayName="SlidersOutlined";const en=h.forwardRef(Zt),tn=e=>{const{filterCriteria:t,updateFilterCriteria:n,onClose:r}=e,{binWidth:o,min:i,max:a}=t.histogramOptions||{};return h.createElement(L.Form,{name:"basic",labelCol:{span:10},wrapperCol:{span:14},initialValues:{binWidth:o,min:i,max:a},onFinish:e=>{n(t.id,Object.assign(Object.assign({},t),{histogramOptions:{isCustom:!0,binWidth:e.binWidth,min:e.min,max:e.max}})),r&&r()},autoComplete:"off",style:{width:"250px"}},h.createElement(L.Form.Item,{label:"范围最小值",name:"min"},h.createElement(L.InputNumber,{style:{width:"120px"}})),h.createElement(L.Form.Item,{label:"范围最大值",name:"max"},h.createElement(L.InputNumber,{style:{width:"120px"}})),h.createElement(L.Form.Item,{label:"分箱值",name:"binWidth"},h.createElement(L.InputNumber,{style:{width:"120px"}})),h.createElement(L.Form.Item,{wrapperCol:{span:24}},h.createElement(L.Button,{type:"primary",htmlType:"submit",style:{width:"100%"}},"保存分箱配置")))},nn=e=>{const{filterCriteria:t,updateFilterCriteria:n}=e,[r,o]=h.useState(!1);return"HISTOGRAM"===t.analyzerType?h.createElement(L.Popover,{open:r,onOpenChange:e=>{o(e)},placement:"topLeft",title:"设置分箱规则",content:h.createElement(tn,Object.assign({},e,{onClose:()=>{o(!1)}})),trigger:"click"},h.createElement(L.Button,{type:"text",style:{padding:"4px"}},h.createElement(en,null))):null},rn=e=>{const t=h.useRef(null),{source:n,filterCriteria:r,elementProps:o}=e,[i,a]=h.useState({yField:""}),{elementType:s}=r,{yField:l}=i;return h.useEffect((()=>{const e=n[`${s}s`].map((e=>e.data)).sort(((e,t)=>e[r.prop]<t[r.prop]?-1:1)),o=new Wt.Column(t.current,{data:e,padding:"auto",xField:r.prop,yField:l,slider:{}});return o.render(),()=>{o.destroy()}}),[l]),h.createElement("div",null,h.createElement(L.Select,{style:{width:"80%"},onChange:e=>{a((t=>Object.assign(Object.assign({},t),{yField:e})))},className:"gi-filter-panel-prop-select",placeholder:`选择${s}属性`},Object.entries(o).map((e=>{const[t,n]=e,r=sn[n];return h.createElement(L.Select.Option,{value:t},r,t)}))),h.createElement("div",{ref:t}))},on=(e,t,n)=>{const{analyzerType:r,isFilterReady:o,elementType:i,prop:a,selectValue:s,range:l}=t;if(!o||"NONE"===r)return e;const c={nodes:[],edges:[]};if("node"===i){const t=new Set;c.nodes=e.nodes.filter((e=>{if("SELECT"===r||"PIE"===r||"WORDCLOUD"===r||"COLUMN"===r)return!(!e.data||null==e.data[a]||-1===(null==s?void 0:s.indexOf(e.data[a])))||(t.add(e.id),!1);if("HISTOGRAM"===r){for(let t of l){const n=t[0],r=t[1];if(e.data&&e.data[a]&&n<=e.data[a]&&e.data[a]<=r)return!0}return t.add(e.id),!1}})),c.edges=e.edges.filter((e=>!t.has(e.source)&&!t.has(e.target)))}else if("edge"===i){const t=new Set;c.edges=e.edges.filter((e=>{if("SELECT"===r||"PIE"===r||"WORDCLOUD"===r||"COLUMN"===r)return!(!e.data||null==e.data[a]||-1===(null==s?void 0:s.indexOf(e.data[a]))||(t.add(e.source),t.add(e.target),0));if("HISTOGRAM"===r){for(let n of l){const r=n[0],o=n[1];if(e.data&&e.data[a]&&r<=e.data[a]&&e.data[a]<=o)return t.add(e.source),t.add(e.target),!0}return!1}})),c.nodes=n?e.nodes.filter((e=>t.has(e.id))):e.nodes}return c},an=(e,t,n)=>{const r="node"===n?e.nodes:e.edges,o=new Map;return null==r||r.forEach((e=>{e.data&&null!=e.data[t]&&o.set(e.data[t],o.has(e.data[t])?o.get(e.data[t])+1:1)})),o},sn={boolean:m().createElement(At,{style:{color:"rgb(39, 110, 241)",marginRight:"4px"}}),string:m().createElement(At,{style:{color:"rgb(39, 110, 241)",marginRight:"4px"}}),number:m().createElement(_t,{style:{color:"rgb(255, 192, 67)",marginRight:"4px"}}),date:m().createElement(Pt,{style:{color:"rgb(255, 192, 67)",marginRight:"4px"}})},ln={COLUMN:m().createElement(Lt,null),PIE:m().createElement(Bt,null),SELECT:m().createElement(qt,null)},cn=e=>{var t;const{propertyGraphData:n}=(0,c.useContext)(),{filterCriteria:r,nodeProperties:o,edgeProperties:i,updateFilterCriteria:a,removeFilterCriteria:s,source:l,enableInfoDetect:u,sorttedProperties:d={node:[],edge:[]}}=e,[p,f]=(0,h.useState)(!1),g=e=>{const t=r.id,s=e.slice(0,4),u=e.slice(5),d="node"===s?o:i;let p;if("number"===d[u])p="HISTOGRAM",a(t,Object.assign(Object.assign({},r),{id:t,analyzerType:p,isFilterReady:!1,elementType:s,prop:u})),f(!1);else if("boolean"===d[u])p="Column",a(t,Object.assign(Object.assign({},r),{id:t,isFilterReady:!1,elementType:s,prop:u,analyzerType:p})),f(!1);else if("string"===d[u]){const e=an(l,u,s);let o=[...e.keys()].map((e=>({value:e,label:e})));if(e.size<=5)p="PIE";else if(e.size<=10)p="COLUMN";else{p="SELECT";const e=c.utils.getPropertyValueRanks(n,s,u);o=o.map((t=>{const{value:n}=t,{rank:r,isOutlier:o}=e.find((e=>e.propertyValue===n))||{};return Object.assign(Object.assign({},t),{rank:r,isOutlier:o})}))}a(t,Object.assign(Object.assign({},r),{id:t,isFilterReady:!1,elementType:s,prop:u,analyzerType:p,selectOptions:o,chartData:e})),f(!0)}else"date"===d[u]?(p="DATE",a(t,Object.assign(Object.assign({},r),{id:t,isFilterReady:!1,elementType:s,prop:u,analyzerType:p})),f(!1)):(p="NONE",a(t,Object.assign(Object.assign({},r),{id:t,isFilterReady:!1,elementType:s,prop:u,analyzerType:p})),f(!1))},y="node"===r.elementType?o:i;(0,h.useEffect)((()=>{r.defaultKey&&g(r.defaultKey)}),[r.defaultKey]),(0,h.useEffect)((()=>{const{prop:e,elementType:t,analyzerType:n}=r;if(e&&t&&n&&-1!==["PIE","SELECT","WORDCLOUD"].indexOf(n)){const n=an(l,e,t);a(r.id,Object.assign(Object.assign({},r),{chartData:n}))}if(e&&t&&n&&-1!==["HISTOGRAM"].indexOf(n)){const n=((e,t,n)=>{const r=("node"===n?e.nodes:e.edges).filter((e=>e.data&&e.data[t]&&"number"==typeof e.data[t])).map((e=>({value:e.data[t]})));return r.sort(((e,t)=>e.value-t.value)),r})(l,e,t);a(r.id,Object.assign(Object.assign({},r),{histogramData:n}))}}),[l,r.prop,r.elementType,r.analyzerType]);const v=m().createElement(L.Menu,{onClick:({key:e})=>{a(r.id,Object.assign(Object.assign({},r),{analyzerType:e}))},items:[{key:"COLUMN",label:m().createElement(Lt,null)},{key:"PIE",label:m().createElement(Bt,null)},{key:"SELECT",label:m().createElement(qt,null)}]}),b=(e,t=3)=>{const n="node"===e?o:i;return Object.entries(n).map((n=>{const[r,o]=n,i=sn[o];let a=!1;if(u){const n=d[e].findIndex((e=>e.propertyName===r));n>-1&&n<t&&(a=!0)}return m().createElement(L.Select.Option,{value:`${e}-${r}`},a?m().createElement(L.Row,null,m().createElement(L.Col,{span:22},i,r),m().createElement(L.Col,{span:2},m().createElement(Ct,{twoToneColor:"#eb2f96"}))):m().createElement(m().Fragment,null,i,r))}))};return m().createElement("div",{key:r.id,id:`panel-${r.id}`,className:"gi-filter-panel-group"},m().createElement("div",{className:"gi-filter-panel-prop"},m().createElement(L.Select,{style:{width:"80%"},onChange:g,className:"gi-filter-panel-prop-select",placeholder:"选择元素属性",showSearch:!0,filterOption:(e,t)=>{var n;return null===(n=null==t?void 0:t.value)||void 0===n?void 0:n.toLowerCase().includes(e.toLowerCase())},value:r.elementType&&r.prop?`${r.elementType}-${r.prop}`:void 0},m().createElement(L.Select.OptGroup,{key:"node",label:"节点"},b("node")),m().createElement(L.Select.OptGroup,{key:"edge",label:"边"},b("edge"))),p&&m().createElement(L.Dropdown,{overlay:v},m().createElement(L.Button,{icon:ln[r.analyzerType],type:"text"})),m().createElement(nn,{filterCriteria:r,updateFilterCriteria:a}),m().createElement(L.Button,{onClick:()=>s(r.id),type:"text",style:{padding:"4px"}},m().createElement(Ht,{className:"gi-filter-panel-delete"}))),m().createElement("div",{className:"gi-filter-panel-value",id:`${r.id}-chart-container`},"SELECT"==r.analyzerType&&m().createElement(L.Select,{style:{width:"100%"},onChange:e=>{const t=r.id,n=0!==e.length;a(t,Object.assign(Object.assign({},r),{isFilterReady:n,selectValue:e}))},mode:"tags",placeholder:"选择筛选值",value:r.selectValue},null===(t=r.selectOptions)||void 0===t?void 0:t.map((e=>{const{rank:t,label:n,value:r}=e;return m().createElement(L.Select.Option,{value:r},void 0!==t&&t<3?m().createElement(L.Row,{style:{width:"100%"}},m().createElement(L.Col,{span:20},n),m().createElement(L.Col,{span:4},new Array(3-t).fill(m().createElement(Ct,{twoToneColor:"#eb2f96"})))):n)}))),"PIE"===r.analyzerType&&m().createElement(Kt,{filterCriteria:r,updateFilterCriteria:a}),"WORDCLOUD"===r.analyzerType&&m().createElement(Yt,{filterCriteria:r,updateFilterCriteria:a}),"COLUMN"===r.analyzerType&&m().createElement(Xt,{filterCriteria:r,updateFilterCriteria:a,highlightRank:5}),"HISTOGRAM"===r.analyzerType&&m().createElement(Qt,{filterCriteria:r,updateFilterCriteria:a}),"DATE"===r.analyzerType&&m().createElement(rn,{filterCriteria:r,source:l,elementProps:y,width:document.getElementsByClassName("gi-filter-panel-prop")[0].clientWidth}),"NONE"===r.analyzerType&&m().createElement("span",null,"请选择合法字段")))},un=e=>{const{filterCriteria:t,updateFilterCriteria:n,removeFilterCriteria:r}=e,{hasOutlier:o}=t;return m().createElement("div",{key:t.id,className:"gi-filter-panel-group"},m().createElement("div",{className:"gi-filter-panel-prop"},m().createElement("h3",null,m().createElement(Ct,{twoToneColor:"#eb2f96"}),m().createElement("span",{style:{marginLeft:"4px"}},"node"===t.elementType?"节点":"边","属性："),m().createElement("span",null,t.prop)),m().createElement(L.Button,{onClick:()=>r(t.id),type:"text",style:{padding:"4px"}},m().createElement(Ht,{className:"gi-filter-panel-delete"}))),m().createElement("div",{className:"gi-filter-panel-recommend-tip"},o?"该属性大多值具有相同的出现次数，但有些值有出现次数大于平均出现次数（红色），值得关注":"该属性的某些值出现概率极低（红色），很可能含有更大信息量，值得关注"),m().createElement("div",{className:"gi-filter-panel-value",id:`${t.id}-chart-container`},m().createElement(Xt,{filterCriteria:t,updateFilterCriteria:n,highlightRank:5})))},{isStyles:dn}=c.utils,pn={id:"FilterPanel",name:"筛选面板",desc:"通过属性筛选画布信息，可自定义",icon:"icon-filter",cover:"http://xxxx.jpg",category:"data-analysis",type:"GIAC_CONTENT",docs:"https://www.yuque.com/antv/gi/gyilm62o426etqpd"},{deepClone:fn,GIAC_CONTENT_METAS:hn}=c.extra,mn=fn(hn);mn.GIAC_CONTENT.properties.GIAC_CONTENT.properties.title.default=pn.name,mn.GIAC_CONTENT.properties.GIAC_CONTENT.properties.icon.default=pn.icon,mn.GIAC_CONTENT.properties.GIAC_CONTENT.properties.tooltip.default=pn.desc,mn.GIAC_CONTENT.properties.GIAC_CONTENT.properties.containerWidth.default="400px";const gn={info:pn,component:e=>{const{isFilterIsolatedNodes:t,highlightMode:n,filterLogic:r,filterKeys:o=[],histogramOptions:i,enableInfoDetect:a,controlledValues:s,onOpen:l}=e,[u,d]=(0,h.useState)({}),[p,f]=(0,h.useState)({node:[],edge:[]}),{source:g,updateContext:y,updateHistory:v,transform:b,schemaData:x,graph:E,propertyGraphData:I}=(0,c.useContext)();(0,h.useEffect)((()=>{a&&f({node:c.utils.getPropertyRanks(I,"node"),edge:c.utils.getPropertyRanks(I,"edge")})}),[I,a]);const w=(0,h.useMemo)((()=>x.nodes.reduce(((e,t)=>Object.assign(Object.assign({},e),t.properties)),{})),[x]),C=(0,h.useMemo)((()=>x.edges.reduce(((e,t)=>Object.assign(Object.assign({},e),t.properties)),{})),[x]),S=(e,t)=>{d((n=>{const r=Object.assign(Object.assign({},n),{[e]:t});return T(r),r}))},O=e=>{d((t=>{const n={};for(let r in t)r!==e&&(n[r]=t[r]);return T(n),n}))};(0,h.useEffect)((()=>{const e=o.map((e=>({id:St(),defaultKey:e,histogramOptions:i,isFilterReady:!1}))).reduce(((e,t)=>(e[t.id]=t,e)),{});d(e),o.length&&T(e)}),[o]),(0,h.useEffect)((()=>{(e=>{let o=g;if("and"===r?Object.values(e).map((e=>{o=on(o,e,t)})):(o={nodes:[],edges:[]},Object.values(e).map((e=>{const n=on(g,e,t);o.nodes=[...o.nodes,...n.nodes],o.edges=[...o.edges,...n.edges]})),o.nodes=c.utils.uniqueElementsBy(o.nodes,((e,t)=>e.id===t.id)),o.edges=c.utils.uniqueElementsBy(o.edges,((e,t)=>e.id===t.id))),n){const{isEmpty:e,isFull:t}=((e,t)=>{if(!e||e.destroyed)return{};const n=e.save(),r=t.nodes.map((e=>e.id)),o=[];t.edges.forEach((e=>{const{aggregate:t}=e;t?t.forEach((e=>{o.push(e.id)})):o.push(e.id)}));const i=n.nodes.length,a=o.length,s=t.nodes.length,l=t.edges.length,c=0===s&&0===l,u=s===i&&l===a;return c||u?(n.nodes.forEach((function(t){e.clearItemStates(t.id)})),n.edges.forEach((function(t){e.clearItemStates(t.id)})),{isEmpty:c,isFull:u}):(n.nodes.forEach((t=>{r.includes(t.id)?(e.setItemState(t.id,"disabled",!1),e.setItemState(t.id,"selected",!0)):(e.setItemState(t.id,"selected",!1),e.setItemState(t.id,"disabled",!0))})),n.edges.forEach((t=>{const{aggregate:n,id:r}=t;let i=!1;i=n?n.map((e=>e.id)).some((e=>o.includes(e))):o.includes(r),i?(e.setItemState(t.id,"disabled",!1),e.setItemState(t.id,"selected",!0)):(e.setItemState(t.id,"selected",!1),e.setItemState(t.id,"disabled",!0))})),{isEmpty:c,isFull:u})})(E,o);y((n=>{n.persistentHighlight=!e&&!t}))}else y((e=>{dn(g.nodes)?e.data=o:e.data=b(o),e.layoutCache=!0}))})(u)}),[u]);const T=(e,t=!0,n)=>{const r={};Object.keys(e).forEach((t=>{const{analyzerType:n,defaultKey:o,elementType:i,id:a,prop:s,selectOptions:l,histogramOptions:c}=e[t];r[t]={analyzerType:n,defaultKey:o,elementType:i,id:a,prop:s,selectOptions:l,histogramOptions:c}})),v({componentId:"FilterPanel",type:"analyse",subType:"筛选",statement:"筛选",success:t,errorMsg:n,params:{options:r}})};return(0,h.useEffect)((()=>{if(s){const{options:e}=s;null==l||l(),d(e)}}),[s]),m().createElement("div",{className:"gi-filter-panel"},m().createElement(L.Button,{type:"primary",style:{width:a?"calc(100% - 104px)":"100%",borderRadius:"4px"},onClick:()=>((e,t={})=>{const n=St(),r=Object.assign({id:n,defaultKey:e,histogramOptions:i,isFilterReady:!1},t);return d((e=>Object.assign(Object.assign({},e),{[n]:r}))),setTimeout((()=>{const e=document.getElementById(`panel-${r.id}`);e&&e.scrollIntoView({behavior:"smooth",block:"end"})}),100),r})(),icon:m().createElement(Et,null)},"增加筛选器"),a?m().createElement(L.Button,{style:{width:"100px",marginLeft:"4px"},onClick:()=>{const e={};["node","edge"].forEach((t=>{p[t].forEach(((n,r)=>{if(r>2)return;const{propertyName:o}=n,i=St(),a=an(g,o,t),s=c.utils.getPropertyValueRanks(I,t,o);let l=!1;const u=[...a.keys()].map((e=>{const{rank:t,isOutlier:n=!1}=s.find((t=>String(t.propertyValue)===String(e)))||{};return l=l||n,{value:e,label:e,rank:t,isOutlier:n}}));e[i]={id:i,isRecommend:!0,elementType:t,prop:o,analyzerType:"COLUMN",isFilterReady:!1,chartData:a,selectOptions:u,hasOutlier:l}}))})),d((t=>{const n=[],r=Object.assign({},t);return Object.values(r).forEach((e=>{e.isRecommend&&n.push(e.id)})),n.forEach((e=>{delete r[e]})),Object.assign(Object.assign({},r),e)})),setTimeout((()=>{const t=Object.keys(e)[0],n=document.getElementById(`panel-${t}`);n&&n.scrollIntoView({behavior:"smooth",block:"end"})}),100)}},m().createElement(Ct,{twoToneColor:"#eb2f96"}),"智能推荐"):"",m().createElement("div",{className:"gi-filter-panel-criteria-container"},Object.values(u).map((e=>{const{isRecommend:t}=e;return t?m().createElement(un,{filterCriteria:e,updateFilterCriteria:S,removeFilterCriteria:O}):m().createElement(cn,{source:g,filterCriteria:e,nodeProperties:w,edgeProperties:C,updateFilterCriteria:S,removeFilterCriteria:O,sorttedProperties:p,enableInfoDetect:a})}))))},registerMeta:({schemaData:e,hasPropertyGraph:t})=>{const n=e.nodes.reduce(((e,t)=>Object.assign(Object.assign({},e),t.properties)),{}),r=e.edges.reduce(((e,t)=>Object.assign(Object.assign({},e),t.properties)),{}),o=Object.entries(n).map((e=>{const[t,n]=e;return{label:`node-${t}`,value:`node-${t}`}})),i=Object.entries(r).map((e=>{const[t,n]=e;return{label:`edge-${t}`,value:`edge-${t}`}})),a=Object.assign({filterKeys:{title:"默认筛选字段",type:"string","x-decorator":"FormItem","x-component":"Select","x-component-props":{mode:"multiple"},enum:[...o,...i],default:[]},enableInfoDetect:t?{title:"智能推荐",type:"string","x-decorator":"FormItem","x-component":"Switch",default:!0}:void 0,isFilterIsolatedNodes:{title:"过滤孤立节点",type:"boolean","x-decorator":"FormItem","x-component":"Switch",default:!0},highlightMode:{title:"高亮模式",type:"boolean","x-decorator":"FormItem","x-component":"Switch",default:!0},filterLogic:{title:"筛选逻辑",type:"string","x-decorator":"FormItem","x-component":"Select",enum:[{value:"and",label:"and"},{value:"or",label:"or"}],default:"and"},histogramOptions:{type:"object","x-decorator":"FormItem","x-component":"FormCollapse.CollapsePanel","x-component-props":{header:"分箱设置"},properties:{isCustom:{title:"自定义分箱",type:"string","x-decorator":"FormItem","x-component":"Switch",default:!1,"x-reactions":[{target:"histogramOptions.min",fulfill:{state:{visible:"{{$self.value}}"}}},{target:"histogramOptions.max",fulfill:{state:{visible:"{{$self.value}}"}}},{target:"histogramOptions.binWidth",fulfill:{state:{visible:"{{$self.value}}"}}}]},min:{title:"区间最小值",type:"string","x-decorator":"FormItem","x-component":"NumberPicker",default:null},max:{title:"区间最大值",type:"string","x-decorator":"FormItem","x-component":"NumberPicker",default:null},binWidth:{title:"分箱值",type:"string","x-decorator":"FormItem","x-component":"NumberPicker",default:null}}}},mn);return t||delete a.enableInfoDetect,a}},{GIAComponent:yn}=c.extra,vn={id:"FitCenter",name:"视图居中",desc:"调整画布，使其居中对齐",icon:"icon-fit-center",cover:"http://xxxx.jpg",category:"canvas-interaction",type:"GIAC",docs:"https://www.yuque.com/antv/gi/soxlq9fw77k02a26"},{deepClone:bn,GIAC_METAS:xn}=c.extra,En=bn(xn);En.GIAC.properties.GIAC.properties.title.default=vn.name,En.GIAC.properties.GIAC.properties.icon.default=vn.icon,En.GIAC.properties.GIAC.properties.isShowTitle.default=!1,En.GIAC.properties.GIAC.properties.tooltipPlacement.default="right";const In={info:vn,component:e=>{const{GIAC:t}=e,{graph:n}=(0,c.useContext)();return h.createElement(yn,{GIAC:t,onClick:()=>{n.fitCenter(!0)}})},registerMeta:()=>En},{GIAComponent:wn}=c.extra,Cn={id:"FitCenterView",name:"自适应居中",desc:"调整画布，使其自适应居中展示",icon:"icon-fit-view",cover:"http://xxxx.jpg",category:"canvas-interaction",type:"GIAC",docs:"https://www.yuque.com/antv/gi/wc317ftgwwk3fwny"},{deepClone:Sn,GIAC_METAS:On}=c.extra,Tn=Sn(On);Tn.GIAC.properties.GIAC.properties.title.default=Cn.name,Tn.GIAC.properties.GIAC.properties.icon.default=Cn.icon,Tn.GIAC.properties.GIAC.properties.isShowTitle.default=!1,Tn.GIAC.properties.GIAC.properties.tooltipPlacement.default="right";const An={info:Cn,component:e=>{const{GIAC:t}=e,{graph:n}=(0,c.useContext)(),r=()=>{n.fitCenter(!0),n.fitView(20,{},!0,{easing:"easeCubic",duration:300})};return h.useEffect((()=>(n.on("canvas:dblclick",r),()=>{n.off("canvas:dblclick",r)})),[n]),h.createElement(wn,{GIAC:t,onClick:r})},registerMeta:()=>Tn},{GIAComponent:Nn}=c.extra,kn={id:"FitView",name:"自适应",desc:"调整画布，使其自适应 1:1 展示",icon:"icon-fit-view",cover:"http://xxxx.jpg",category:"canvas-interaction",type:"GIAC",docs:"https://www.yuque.com/antv/gi/wc317ftgwwk3fwny"},{deepClone:_n,GIAC_METAS:jn}=c.extra,Fn=_n(jn);Fn.GIAC.properties.GIAC.properties.title.default=kn.name,Fn.GIAC.properties.GIAC.properties.icon.default=kn.icon,Fn.GIAC.properties.GIAC.properties.isShowTitle.default=!1,Fn.GIAC.properties.GIAC.properties.tooltipPlacement.default="right";const Pn={info:kn,component:e=>{const{GIAC:t}=e,{graph:n}=(0,c.useContext)();return h.createElement(Nn,{GIAC:t,onClick:()=>{n.fitView(20,{},!0,{easing:"easeCubic",duration:200})}})},registerMeta:()=>Fn};function Mn(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw Error("[Immer] minified error nr: "+e+(n.length?" "+n.map((function(e){return"'"+e+"'"})).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function Rn(e){return!!e&&!!e[Er]}function Ln(e){var t;return!!e&&(function(e){if(!e||"object"!=typeof e)return!1;var t=Object.getPrototypeOf(e);if(null===t)return!0;var n=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return n===Object||"function"==typeof n&&Function.toString.call(n)===wr}(e)||Array.isArray(e)||!!e[xr]||!!(null===(t=e.constructor)||void 0===t?void 0:t[xr])||$n(e)||qn(e))}function Gn(e,t,n){void 0===n&&(n=!1),0===Dn(e)?(n?Object.keys:Cr)(e).forEach((function(r){n&&"symbol"==typeof r||t(r,e[r],e)})):e.forEach((function(n,r){return t(r,n,e)}))}function Dn(e){var t=e[Er];return t?t.i>3?t.i-4:t.i:Array.isArray(e)?1:$n(e)?2:qn(e)?3:0}function Bn(e,t){return 2===Dn(e)?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function zn(e,t,n){var r=Dn(e);2===r?e.set(t,n):3===r?e.add(n):e[t]=n}function $n(e){return gr&&e instanceof Map}function qn(e){return yr&&e instanceof Set}function Un(e){return e.o||e.t}function Vn(e){if(Array.isArray(e))return Array.prototype.slice.call(e);var t=Sr(e);delete t[Er];for(var n=Cr(t),r=0;r<n.length;r++){var o=n[r],i=t[o];!1===i.writable&&(i.writable=!0,i.configurable=!0),(i.get||i.set)&&(t[o]={configurable:!0,writable:!0,enumerable:i.enumerable,value:e[o]})}return Object.create(Object.getPrototypeOf(e),t)}function Hn(e,t){return void 0===t&&(t=!1),Kn(e)||Rn(e)||!Ln(e)||(Dn(e)>1&&(e.set=e.add=e.clear=e.delete=Wn),Object.freeze(e),t&&Gn(e,(function(e,t){return Hn(t,!0)}),!0)),e}function Wn(){Mn(2)}function Kn(e){return null==e||"object"!=typeof e||Object.isFrozen(e)}function Yn(e){var t=Or[e];return t||Mn(18,e),t}function Xn(){return hr}function Qn(e,t){t&&(Yn("Patches"),e.u=[],e.s=[],e.v=t)}function Jn(e){Zn(e),e.p.forEach(tr),e.p=null}function Zn(e){e===hr&&(hr=e.l)}function er(e){return hr={p:[],l:hr,h:e,m:!0,_:0}}function tr(e){var t=e[Er];0===t.i||1===t.i?t.j():t.g=!0}function nr(e,t){t._=t.p.length;var n=t.p[0],r=void 0!==e&&e!==n;return t.h.O||Yn("ES5").S(t,e,r),r?(n[Er].P&&(Jn(t),Mn(4)),Ln(e)&&(e=rr(t,e),t.l||ir(t,e)),t.u&&Yn("Patches").M(n[Er].t,e,t.u,t.s)):e=rr(t,n,[]),Jn(t),t.u&&t.v(t.u,t.s),e!==br?e:void 0}function rr(e,t,n){if(Kn(t))return t;var r=t[Er];if(!r)return Gn(t,(function(o,i){return or(e,r,t,o,i,n)}),!0),t;if(r.A!==e)return t;if(!r.P)return ir(e,r.t,!0),r.t;if(!r.I){r.I=!0,r.A._--;var o=4===r.i||5===r.i?r.o=Vn(r.k):r.o,i=o,a=!1;3===r.i&&(i=new Set(o),o.clear(),a=!0),Gn(i,(function(t,i){return or(e,r,o,t,i,n,a)})),ir(e,o,!1),n&&e.u&&Yn("Patches").N(r,n,e.u,e.s)}return r.o}function or(e,t,n,r,o,i,a){if(Rn(o)){var s=rr(e,o,i&&t&&3!==t.i&&!Bn(t.R,r)?i.concat(r):void 0);if(zn(n,r,s),!Rn(s))return;e.m=!1}else a&&n.add(o);if(Ln(o)&&!Kn(o)){if(!e.h.D&&e._<1)return;rr(e,o),t&&t.A.l||ir(e,o)}}function ir(e,t,n){void 0===n&&(n=!1),!e.l&&e.h.D&&e.m&&Hn(t,n)}function ar(e,t){var n=e[Er];return(n?Un(n):e)[t]}function sr(e,t){if(t in e)for(var n=Object.getPrototypeOf(e);n;){var r=Object.getOwnPropertyDescriptor(n,t);if(r)return r;n=Object.getPrototypeOf(n)}}function lr(e){e.P||(e.P=!0,e.l&&lr(e.l))}function cr(e){e.o||(e.o=Vn(e.t))}function ur(e,t,n){var r=$n(t)?Yn("MapSet").F(t,n):qn(t)?Yn("MapSet").T(t,n):e.O?function(e,t){var n=Array.isArray(e),r={i:n?1:0,A:t?t.A:Xn(),P:!1,I:!1,R:{},l:t,t:e,k:null,o:null,j:null,C:!1},o=r,i=Tr;n&&(o=[r],i=Ar);var a=Proxy.revocable(o,i),s=a.revoke,l=a.proxy;return r.k=l,r.j=s,l}(t,n):Yn("ES5").J(t,n);return(n?n.A:Xn()).p.push(r),r}function dr(e){return Rn(e)||Mn(22,e),function e(t){if(!Ln(t))return t;var n,r=t[Er],o=Dn(t);if(r){if(!r.P&&(r.i<4||!Yn("ES5").K(r)))return r.t;r.I=!0,n=pr(t,o),r.I=!1}else n=pr(t,o);return Gn(n,(function(t,o){r&&function(e,t){return 2===Dn(e)?e.get(t):e[t]}(r.t,t)===o||zn(n,t,e(o))})),3===o?new Set(n):n}(e)}function pr(e,t){switch(t){case 2:return new Map(e);case 3:return Array.from(e)}return Vn(e)}var fr,hr,mr="undefined"!=typeof Symbol&&"symbol"==typeof Symbol("x"),gr="undefined"!=typeof Map,yr="undefined"!=typeof Set,vr="undefined"!=typeof Proxy&&void 0!==Proxy.revocable&&"undefined"!=typeof Reflect,br=mr?Symbol.for("immer-nothing"):((fr={})["immer-nothing"]=!0,fr),xr=mr?Symbol.for("immer-draftable"):"__$immer_draftable",Er=mr?Symbol.for("immer-state"):"__$immer_state",Ir="undefined"!=typeof Symbol&&Symbol.iterator||"@@iterator",wr=""+Object.prototype.constructor,Cr="undefined"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:void 0!==Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames,Sr=Object.getOwnPropertyDescriptors||function(e){var t={};return Cr(e).forEach((function(n){t[n]=Object.getOwnPropertyDescriptor(e,n)})),t},Or={},Tr={get:function(e,t){if(t===Er)return e;var n=Un(e);if(!Bn(n,t))return function(e,t,n){var r,o=sr(t,n);return o?"value"in o?o.value:null===(r=o.get)||void 0===r?void 0:r.call(e.k):void 0}(e,n,t);var r=n[t];return e.I||!Ln(r)?r:r===ar(e.t,t)?(cr(e),e.o[t]=ur(e.A.h,r,e)):r},has:function(e,t){return t in Un(e)},ownKeys:function(e){return Reflect.ownKeys(Un(e))},set:function(e,t,n){var r=sr(Un(e),t);if(null==r?void 0:r.set)return r.set.call(e.k,n),!0;if(!e.P){var o=ar(Un(e),t),i=null==o?void 0:o[Er];if(i&&i.t===n)return e.o[t]=n,e.R[t]=!1,!0;if(function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}(n,o)&&(void 0!==n||Bn(e.t,t)))return!0;cr(e),lr(e)}return e.o[t]===n&&(void 0!==n||t in e.o)||Number.isNaN(n)&&Number.isNaN(e.o[t])||(e.o[t]=n,e.R[t]=!0),!0},deleteProperty:function(e,t){return void 0!==ar(e.t,t)||t in e.t?(e.R[t]=!1,cr(e),lr(e)):delete e.R[t],e.o&&delete e.o[t],!0},getOwnPropertyDescriptor:function(e,t){var n=Un(e),r=Reflect.getOwnPropertyDescriptor(n,t);return r?{writable:!0,configurable:1!==e.i||"length"!==t,enumerable:r.enumerable,value:n[t]}:r},defineProperty:function(){Mn(11)},getPrototypeOf:function(e){return Object.getPrototypeOf(e.t)},setPrototypeOf:function(){Mn(12)}},Ar={};Gn(Tr,(function(e,t){Ar[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}})),Ar.deleteProperty=function(e,t){return Ar.set.call(this,e,t,void 0)},Ar.set=function(e,t,n){return Tr.set.call(this,e[0],t,n,e[0])};var Nr=function(){function e(e){var t=this;this.O=vr,this.D=!0,this.produce=function(e,n,r){if("function"==typeof e&&"function"!=typeof n){var o=n;n=e;var i=t;return function(e){var t=this;void 0===e&&(e=o);for(var r=arguments.length,a=Array(r>1?r-1:0),s=1;s<r;s++)a[s-1]=arguments[s];return i.produce(e,(function(e){var r;return(r=n).call.apply(r,[t,e].concat(a))}))}}var a;if("function"!=typeof n&&Mn(6),void 0!==r&&"function"!=typeof r&&Mn(7),Ln(e)){var s=er(t),l=ur(t,e,void 0),c=!0;try{a=n(l),c=!1}finally{c?Jn(s):Zn(s)}return"undefined"!=typeof Promise&&a instanceof Promise?a.then((function(e){return Qn(s,r),nr(e,s)}),(function(e){throw Jn(s),e})):(Qn(s,r),nr(a,s))}if(!e||"object"!=typeof e){if(void 0===(a=n(e))&&(a=e),a===br&&(a=void 0),t.D&&Hn(a,!0),r){var u=[],d=[];Yn("Patches").M(e,a,u,d),r(u,d)}return a}Mn(21,e)},this.produceWithPatches=function(e,n){if("function"==typeof e)return function(n){for(var r=arguments.length,o=Array(r>1?r-1:0),i=1;i<r;i++)o[i-1]=arguments[i];return t.produceWithPatches(n,(function(t){return e.apply(void 0,[t].concat(o))}))};var r,o,i=t.produce(e,n,(function(e,t){r=e,o=t}));return"undefined"!=typeof Promise&&i instanceof Promise?i.then((function(e){return[e,r,o]})):[i,r,o]},"boolean"==typeof(null==e?void 0:e.useProxies)&&this.setUseProxies(e.useProxies),"boolean"==typeof(null==e?void 0:e.autoFreeze)&&this.setAutoFreeze(e.autoFreeze)}var t=e.prototype;return t.createDraft=function(e){Ln(e)||Mn(8),Rn(e)&&(e=dr(e));var t=er(this),n=ur(this,e,void 0);return n[Er].C=!0,Zn(t),n},t.finishDraft=function(e,t){var n=(e&&e[Er]).A;return Qn(n,t),nr(void 0,n)},t.setAutoFreeze=function(e){this.D=e},t.setUseProxies=function(e){e&&!vr&&Mn(20),this.O=e},t.applyPatches=function(e,t){var n;for(n=t.length-1;n>=0;n--){var r=t[n];if(0===r.path.length&&"replace"===r.op){e=r.value;break}}n>-1&&(t=t.slice(n+1));var o=Yn("Patches").$;return Rn(e)?o(e,t):this.produce(e,(function(e){return o(e,t)}))},e}(),kr=new Nr,_r=kr.produce;kr.produceWithPatches.bind(kr),kr.setAutoFreeze.bind(kr),kr.setUseProxies.bind(kr),kr.applyPatches.bind(kr),kr.createDraft.bind(kr),kr.finishDraft.bind(kr);const jr=_r;function Fr(e){var t=(0,h.useState)((function(){return Hn("function"==typeof e?e():e,!0)})),n=t[1];return[t[0],(0,h.useCallback)((function(e){n("function"==typeof e?jr(e):Hn(e))}),[])]}var Pr=u(448);const Mr=e=>{const{children:t,width:n,isDisplay:r,toggleVisible:o,visible:i}=e;return m().createElement("div",{style:{width:i?n:"0px",display:r?"flex":"none",padding:i?"10px":"0"},className:"gi-grail-layout gi-grail-layout-left"},m().createElement(Pr.Z,{type:"left",handleClick:o}),t)},Rr=e=>{const{children:t,height:n,isDisplay:r,left:o,right:i,visible:a,toggleVisible:s}=e;return m().createElement("div",{style:{height:a?n:"0",display:r?"flex":"none",left:o,right:i,padding:a?"10px":"0"},className:"gi-grail-layout gi-grail-layout-bottom"},m().createElement(Pr.Z,{type:"bottom",handleClick:s}),t)},Lr=e=>{const{children:t,width:n,isDisplay:r,toggleVisible:o,visible:i}=e;return m().createElement("div",{style:{width:i?n:"0px",display:r?"flex":"none",padding:i?"10px":"0"},className:"gi-grail-layout gi-grail-layout-right"},m().createElement(Pr.Z,{type:"right",handleClick:o}),t)},Gr=e=>{const{children:t,height:n,isDisplay:r,left:o,right:i,visible:a,toggleVisible:s}=e;return m().createElement("div",{style:{height:a?n:"0",display:r?"flex":"none",left:o,right:i,padding:a?"10px":"0"},className:"gi-grail-layout gi-grail-layout-top"},t)},Dr=(e,t,n,r)=>m().useMemo((()=>{const o=[];(e||[]).forEach((e=>{"string"==typeof e?o.push(e):o.push(e.value)}));const i=o.map((e=>null==t?void 0:t[e])).filter((e=>e&&e.props&&e.props.GIAC_CONTENT)).sort(((e,t)=>e.props.GI_CONTAINER_INDEX-t.props.GI_CONTAINER_INDEX));if((!i||0===i.length)&&r)return m().createElement(L.Empty,{style:{position:"absolute",top:"50%",transform:"translate(-50%, -50%)",left:"50%"},description:"当前容器中没用原子组件，请在左侧配置面板中添加"});const a=null==i?void 0:i.map(((e,t)=>{if(!e)return console.warn(`config not found, index: ${t}`),null;const{props:r,id:o}=e,i=null==n?void 0:n[o];if(!i)return console.warn(`asset: ${o} not found`),null;const{component:a}=i,{icon:s}=e.props.GIAC_CONTENT||{};return m().createElement("div",{className:"gi-grail-layout-component-container"},m().createElement("header",null,m().createElement(c.Icon,{type:s,style:{color:"var(--primary-color)",fontSize:"20px",marginRight:"8px"}}),e.name),m().createElement("div",{className:"gi-grail-layout-component-body"},m().createElement(a,Object.assign({},r))))}));return a}),[e,t,n,r]),Br={info:{id:"GrailLayout",name:"圣杯布局",desc:"支持左、右、下三个方向资产布局",icon:"icon-layout",cover:"http://xxxx.jpg",category:"container-components",type:"GICC_LAYOUT",docs:"https://www.yuque.com/antv/gi/nn4q8z3wc8b844gm"},component:e=>{const{graph:t}=(0,c.useContext)(),{ComponentCfgMap:n,assets:r,GISDK_ID:o,containers:i=[],children:a}=e,{GI_CONTAINER:s,display:l,visible:u,width:d}=i.find((e=>"GI_CONTAINER_LEFT"===e.id))||{},{GI_CONTAINER:p,display:f,visible:h,width:g}=i.find((e=>"GI_CONTAINER_RIGHT"===e.id))||{},{GI_CONTAINER:y,display:v,visible:b,height:x}=i.find((e=>"GI_CONTAINER_BOTTOM"===e.id))||{},{GI_CONTAINER:E,display:I,visible:w,height:C}=i.find((e=>"GI_CONTAINER_TOP"===e.id))||{},[S,O]=Fr({leftVisible:u,rightVisible:h,bottomVisible:b,topVisible:w}),T=Dr(s,n,r,S.leftVisible),A=Dr(p,n,r,S.rightVisible),N=Dr(y,n,r,S.bottomVisible),k=Dr(E,n,r,S.topVisible);return document.getElementById(`${o}-container`),m().useEffect((()=>{const e=document.getElementById(`${o}-graphin-container`),n=S.leftVisible&&l?d:"0px",r=S.rightVisible&&f?g:"0px",i=S.bottomVisible&&v?x:"0px";e&&(e.style.position="absolute",e.style.left=n,e.style.right=r,e.style.width=`calc(100% - ${n} - ${r})`,e.style.height=`calc(100% - ${i})`);const a=document.getElementById(`${o}-container`);if(a){const e=a.clientWidth,o=a.clientHeight;try{const a=e-(Number(n.split("px")[0])+Number(r.split("px")[0])),s=o-Number(i.split("px")[0]),l=t.get("canvas");l&&(l.changeSize(a,s),t.autoPaint(),t.fitView())}catch(e){}}}),[l,S.leftVisible,d,f,S.rightVisible,g,v,S.bottomVisible,x]),m().useEffect((()=>()=>{const e=document.getElementById(`${o}-graphin-container`);if(e){e.style.position="relative",e.style.left="0",e.style.right="0",e.style.width="100%",e.style.height="100%";const n=e.clientWidth,r=e.clientHeight,o=t.get("canvas");o&&(o.changeSize(n,r),t.autoPaint())}}),[]),m().createElement("div",{style:{width:"100%",height:"100%",display:"flex"}},a,m().createElement(Mr,{width:d,isDisplay:l,toggleVisible:()=>{O((e=>{e.leftVisible=!e.leftVisible}))},visible:S.leftVisible},T),m().createElement(Rr,{height:x,isDisplay:v,left:S.leftVisible&&l?d:"0px",right:S.rightVisible&&f?g:"0px",toggleVisible:()=>{O((e=>{e.bottomVisible=!e.bottomVisible}))},visible:S.bottomVisible},N),m().createElement(Lr,{width:g,isDisplay:f,visible:S.rightVisible,toggleVisible:()=>{O((e=>{e.rightVisible=!e.rightVisible}))}},A),m().createElement(Gr,{height:C,isDisplay:I,left:S.leftVisible&&l?d:"0px",right:S.rightVisible&&f?g:"0px",toggleVisible:()=>{O((e=>{e.topVisible=!e.topVisible}))},visible:S.topVisible},k))},registerMeta:e=>{const{GIAC_CONTENT_ITEMS:t=[]}=e;return{containers:[{id:"GI_CONTAINER_LEFT",name:"左侧容器",GI_CONTAINER:{title:"集成组件",type:"string","x-decorator":"FormItem","x-component":"Select","x-component-props":{mode:"multiple"},enum:t,default:[]},visible:{title:"默认展开左侧容器",type:"boolean","x-decorator":"FormItem","x-component":"Switch",default:!0},width:{title:"左侧宽度",type:"string","x-decorator":"FormItem","x-component":"Input","x-component-props":{},default:"400px"}},{id:"GI_CONTAINER_RIGHT",name:"右侧容器",GI_CONTAINER:{title:"集成组件",type:"string","x-decorator":"FormItem","x-component":"Select","x-component-props":{mode:"multiple"},enum:t,default:[]},visible:{title:"默认展开右侧容器",type:"boolean","x-decorator":"FormItem","x-component":"Switch",default:!0},width:{title:"右侧宽度",type:"string","x-decorator":"FormItem","x-component":"Input","x-component-props":{},default:"400px"}},{id:"GI_CONTAINER_BOTTOM",name:"底部容器",GI_CONTAINER:{title:"集成组件",type:"string","x-decorator":"FormItem","x-component":"Select","x-component-props":{mode:"multiple"},enum:t,default:[]},visible:{title:"默认展开底部容器",type:"boolean","x-decorator":"FormItem","x-component":"Switch",default:!0},height:{title:"底部高度",type:"string","x-decorator":"FormItem","x-component":"Input","x-component-props":{},default:"400px"}},{id:"GI_CONTAINER_TOP",name:"顶部容器",GI_CONTAINER:{title:"集成组件",type:"string","x-decorator":"FormItem","x-component":"Select","x-component-props":{mode:"multiple"},enum:t,default:[]},visible:{title:"默认展开顶部容器",type:"boolean","x-decorator":"FormItem","x-component":"Switch",default:!1},height:{title:"顶部高度",type:"string","x-decorator":"FormItem","x-component":"Input","x-component-props":{},default:"200px"}}]}}};var zr=u(314),$r=u.n(zr);const{GIAComponent:qr}=c.extra,{BrushSelect:Ur,DragCanvas:Vr}=p.Behaviors,Hr={id:"LassoSelect",name:"自由圈选",desc:"可通过拉索工具，自由圈选画布元素",icon:"icon-lasso",cover:"http://xxxx.jpg",category:"canvas-interaction",type:"GIAC",docs:"https://www.yuque.com/antv/gi/uhzkzcuqcgzm7c56"},{deepClone:Wr,GIAC_METAS:Kr}=c.extra,Yr=Wr(Kr);Yr.GIAC.properties.GIAC.properties.title.default=Hr.name,Yr.GIAC.properties.GIAC.properties.icon.default=Hr.icon,Yr.GIAC.properties.GIAC.properties.tooltip.default="按住Shift，点击画布即可自由圈选",Yr.GIAC.properties.GIAC.properties.isShowTitle.default=!1;const Xr={info:Hr,component:e=>{const{GIAC:t}=e,[n,r]=m().useState(!1),[o,i]=(0,h.useState)([]),[a,s]=(0,h.useState)([]),{graph:l,GISDK_ID:u}=(0,c.useContext)(),d=(e,t)=>{i([...o,...e]),s([...a,...t]),o.forEach((e=>{l.setItemState(e,"selected",!0)})),a.forEach((e=>{l.setItemState(e,"selected",!0)}))},f=()=>{s([]),i([])},g=e=>{const{state:t,item:n,enabled:r}=e;if("selected"===t){const e=null==n?void 0:n.getType();"node"===e?i(r?[...l.findAllByState("node","selected"),n]:l.findAllByState("node","selected").filter((e=>e.getID()!==(null==n?void 0:n.getID())))):"edge"===e&&s(r?[...l.findAllByState("edge","selected"),n]:l.findAllByState("edge","selected").filter((e=>e.getID()!==(null==n?void 0:n.getID()))))}},y=e=>{const{states:t,item:n}=e;if("selected"===t){const e=null==n?void 0:n.getType();"node"===e?i(l.findAllByState("node","selected").filter((e=>e.getID()!==(null==n?void 0:n.getID())))):"edge"===e&&s(l.findAllByState("edge","selected").filter((e=>e.getID()!==(null==n?void 0:n.getID()))))}};return(0,h.useEffect)((()=>(l.on("afteritemstatechange",g),l.on("afteritemstatesclear",y),()=>{l.off("afteritemstatesclear",y),l.off("afteritemstatechange",g)})),[l]),m().createElement("div",null,m().createElement(qr,{onClick:()=>{r(!n),document.getElementsByClassName("graphin-core")[0].style.opacity=n?1:.8},GIAC:t}),$r().createPortal(m().createElement((e=>{const{isLasso:t}=e;return t?m().createElement(m().Fragment,null,m().createElement(p.Behaviors.LassoSelect,{onSelect:d,onDeselect:f}),m().createElement(Ur,{disabled:!0}),m().createElement(Vr,null)):m().createElement(m().Fragment,null,m().createElement(p.Behaviors.LassoSelect,{disabled:!0}),m().createElement(Ur,null),m().createElement(Vr,null))}),{isLasso:n}),document.getElementById(`${u}-graphin-container`)))},registerMeta:()=>Yr},{GIAComponent:Qr}=c.extra,Jr={id:"LayoutSwitch",name:"布局切换",desc:"一键切换布局",icon:"icon-layout",cover:"http://xxxx.jpg",category:"canvas-interaction",type:"GIAC",docs:"https://www.yuque.com/antv/gi/kehgv931z5v1fmg8"},{deepClone:Zr,GIAC_METAS:eo}=c.extra,to=Zr(eo);to.GIAC.properties.GIAC.properties.title.default=Jr.name,to.GIAC.properties.GIAC.properties.icon.default=Jr.icon,to.GIAC.properties.GIAC.properties.isShowTooltip.default=!1,to.GIAC.properties.GIAC.properties.tooltip.default="一键切换画布布局",to.GIAC.properties.GIAC.properties.isShowTitle.default=!1;const no={info:Jr,component:e=>{var t;const{GIAC:n,controlledValues:r}=e,{assets:o,config:i,data:a,schemaData:s,updateContext:l,updateHistory:u}=(0,c.useContext)(),{layouts:d={}}=o,p=e=>{f(e,!0,""),l((t=>{t.layout=e.props,t.config.layout=e,t.layoutCache=!1}))},f=(e,t,n)=>{const{props:r}=e;u({componentId:"LayoutSwitch",type:"configure",subType:"布局切换",statement:`布局 ${r.type}`,success:t,errorMsg:n,params:r})};(0,h.useEffect)((()=>{if(r){const{type:e}=r;p({id:e,props:r})}}),[r]);const g=(0,h.useMemo)((()=>m().createElement(L.Space,{direction:"vertical"},Object.keys(d).map((e=>{const t=d[e],{registerMeta:n=(()=>({})),info:r={}}=t,o=c.utils.getKeysByData(a,"node"),{id:i,name:l,options:u={},icon:f=""}=r,h=n({data:a,keys:o,schemaData:s}),g=c.utils.getDefaultValues({type:"object",properties:h}),y={id:i,props:Object.assign(Object.assign({},u),g)};return m().createElement(L.Radio,{value:i,onClick:()=>p(y)},m().createElement(c.Icon,{type:f}),l)})))),[d]),y=m().createElement(L.Card,{title:"布局方案",size:"small"},m().createElement(L.Radio.Group,{value:null===(t=i.layout)||void 0===t?void 0:t.id},g));return m().createElement(L.Popover,{content:y,placement:"right"},m().createElement(Qr,{GIAC:n}))},registerMeta:()=>to},ro={info:{id:"Loading",name:"加载动画",desc:"异步加载数据时，可展示加载动画",icon:"icon-loading",cover:"http://xxxx.jpg",category:"system-interaction",type:"AUTO",docs:"https://www.yuque.com/antv/gi/mq7gppdbc79p1p3g"},component:e=>{const t=(0,c.useContext)(),{isLoading:n}=t;return n?h.createElement("div",{className:"gi-loading"},h.createElement(L.Spin,null)):null},registerMeta:()=>({})},{MiniMap:oo}=p.Components,io={info:{id:"MiniMap",name:"小地图",desc:"启用后，可在小地图上展示信息",icon:"icon-minimap",cover:"http://xxxx.jpg",category:"system-interaction",type:"AUTO",docs:"https://www.yuque.com/antv/gi/wzzgehef2k3nfm9c"},component:oo,registerMeta:()=>({})};var ao=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{l(r.next(e))}catch(e){i(e)}}function s(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))};const{SubMenu:so}=L.Menu,lo="NeighborsQuery",co={id:lo,category:"data-query",type:"GIAC_MENU",name:"邻居查询",desc:"集成在右键菜单中，可查询邻居节点",icon:"icon-kinship",cover:"http://xxxx.jpg",services:[lo],docs:"https://www.yuque.com/antv/gi/oqw3qkdworuvhp22"},uo={info:co,component:e=>{var t;const{contextmenu:n,serviceId:r,degree:o,isFocus:i,limit:a,controlledValues:s}=e,l=(0,h.useRef)({expandIds:[],expandStartId:""}),{data:u,updateContext:d,updateHistory:p,transform:f,graph:g,config:y,services:v}=(0,c.useContext)(),b=c.utils.getService(v,r),{item:x}=n;if(!b||(null==x?void 0:x.destroyed)||"node"!==(null===(t=null==x?void 0:x.getType)||void 0===t?void 0:t.call(x)))return null;const E=e=>ao(void 0,void 0,void 0,(function*(){const t=g.findAllByState("node","selected"),r=new Map;t.forEach((e=>{const t=e.getModel();r.set(t.id,t)}));const{key:o}=e,i=o.replace("expand-",""),a=n.item.getModel();g.setItemState(a.id,"selected",!0),r.set(a.id,a);const s=[...r.keys()],l=[...r.values()],c=a.id;d((e=>{e.isLoading=!0})),n.onClose(),yield I(s,c,i,l)})),I=(e,t,n,r=void 0)=>ao(void 0,void 0,void 0,(function*(){var o;let i=r;const s={startIds:e,expandStartId:t,sep:n};r||(i=e.map((e=>{var t;return null===(t=g.findById(e))||void 0===t?void 0:t.getModel()})).filter(Boolean),(null==i?void 0:i.length)||w(s,!1,"当前画布中未找到指定的扩散起始节点"));try{const r=yield b({ids:e,nodes:i,sep:n,limit:a}),p=c.utils.handleExpand(u,r),h=(null===(o=r.nodes)||void 0===o?void 0:o.map((e=>e.id)))||[];l.current.expandIds=h,l.current.expandStartId=t,d((e=>{const t=f(p);if(e.data=t,e.source=t,e.isLoading=!1,"preset"===e.layout.type){const{props:t}=e.config.layout||{props:{type:"graphin-force"}};e.layout=t}})),w(s)}catch(e){w(s,!1,String(e))}})),w=(e,t=!0,n)=>{p({componentId:"NeighborsQuery",type:"analyse",subType:"邻居查询",statement:`查询 ${e.startIds.join(", ")} 的邻居`,success:t,errorMsg:n,params:e})};(0,h.useEffect)((()=>{if(s){const{startIds:e,expandStartId:t,sep:n}=s;I(e,t,n)}}),[s]),(0,h.useEffect)((()=>{const e=()=>{const{expandIds:e,expandStartId:t}=l.current;if(0===e.length)return;e.forEach((e=>{const t=g.findById(e);t&&!t.destroyed&&g.setItemState(e,"query_normal",!0)}));const n=g.findById(t);n&&!n.destroyed&&(g.setItemState(t,"query_start",!0),i&&g.focusItem(t))};return g.on("graphin:datachange",e),()=>{g.off("graphin:datachange",e)}}),[i]);const C=["一","二","三"],S=Array.from({length:Number(o)}).map(((e,t)=>{const n=C[t]+"度扩展",r=t+1;return m().createElement(L.Menu.Item,{key:`expand-${r}`,eventKey:`expand-${r}`,onClick:E},n)}));return m().createElement(so,{key:"expand",eventKey:"expand",title:"扩展查询"},S)},registerMeta:e=>{const{services:t,engineId:n}=e,{options:r,defaultValue:o}=c.utils.getServiceOptionsByEngineId(t,co.services[0],n);return{serviceId:{title:"数据服务",type:"string","x-decorator":"FormItem","x-component":"Select",default:o,"x-component-props":{options:r}},degree:{title:"可查询度数",type:"string","x-decorator":"FormItem","x-component":"Select","x-component-props":{options:[{value:1,label:"一度查询"},{value:2,label:"二度查询"},{value:3,label:"三度查询"}]},default:3},isFocus:{title:"是否聚焦到扩散点",type:"string","x-decorator":"FormItem","x-component":"Switch",default:!0},limit:{title:"限制数量",type:"number","x-decorator":"FormItem","x-component":"NumberPicker",default:100}}}},{getPositionStyles:po}=c.utils,{Legend:fo}=p.Components,ho={info:{id:"NodeLegend",name:"节点图例",desc:"启用后可展示节点的图例信息",icon:"icon-legend",cover:"http://xxxx.jpg",category:"data-analysis",type:"AUTO",docs:"https://www.yuque.com/antv/gi/acvogadnu8fzinkv"},component:e=>{const{sortKey:t,placement:n,offset:r}=e,o=po(n,r);return m().createElement("div",null,m().createElement(fo,{bindType:"node",sortKey:`data.${t}`,style:o},(e=>m().createElement(fo.Node,Object.assign({},e)))))},registerMeta:e=>{var t;const{data:n,schemaData:r}=e;let o=["id"];try{o=Object.keys((null===(t=n.nodes[0])||void 0===t?void 0:t.data)||{})}catch(e){console.warn(e)}const i=o.map((e=>({value:e,label:e})));return{sortKey:{title:"映射字段",type:"string","x-decorator":"FormItem","x-component":"Select",default:"type",enum:i},textColor:{title:"字体颜色",type:"string","x-decorator":"FormItem","x-component":"ColorInput",default:"#ddd"},placement:{title:"组件位置",type:"string","x-decorator":"FormItem","x-component":"Select",enum:U,default:"LB"},offset:{title:"偏移量",type:"string","x-decorator":"FormItem","x-component":"Offset","x-component-props":{min:0,max:400},default:[100,20]}}}},mo={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M904 512h-56c-4.4 0-8 3.6-8 8v320H184V184h320c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V520c0-4.4-3.6-8-8-8z"}},{tag:"path",attrs:{d:"M355.9 534.9L354 653.8c-.1 8.9 7.1 16.2 16 16.2h.4l118-2.9c2-.1 4-.9 5.4-2.3l415.9-415c3.1-3.1 3.1-8.2 0-11.3L785.4 114.3c-1.6-1.6-3.6-2.3-5.7-2.3s-4.1.8-5.7 2.3l-415.8 415a8.3 8.3 0 00-2.3 5.6zm63.5 23.6L779.7 199l45.2 45.1-360.5 359.7-45.7 1.1.7-46.4z"}}]},name:"form",theme:"outlined"};var go=function(e,t){return h.createElement(bt,le(le({},e),{},{ref:t,icon:mo}))};go.displayName="FormOutlined";const yo=h.forwardRef(go),vo={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M715.8 493.5L335 165.1c-14.2-12.2-35-1.2-35 18.5v656.8c0 19.7 20.8 30.7 35 18.5l380.8-328.4c10.9-9.4 10.9-27.6 0-37z"}}]},name:"caret-right",theme:"outlined"};var bo=function(e,t){return h.createElement(bt,le(le({},e),{},{ref:t,icon:vo}))};bo.displayName="CaretRightOutlined";const xo=h.forwardRef(bo),Eo={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880.1 154H143.9c-24.5 0-39.8 26.7-27.5 48L349 597.4V838c0 17.7 14.2 32 31.8 32h262.4c17.6 0 31.8-14.3 31.8-32V597.4L907.7 202c12.2-21.3-3.1-48-27.6-48zM603.4 798H420.6V642h182.9v156zm9.6-236.6l-9.5 16.6h-183l-9.5-16.6L212.7 226h598.6L613 561.4z"}}]},name:"filter",theme:"outlined"};var Io=function(e,t){return h.createElement(bt,le(le({},e),{},{ref:t,icon:Eo}))};Io.displayName="FilterOutlined";const wo=h.forwardRef(Io),Co=[{value:"All-Path",label:"所有路径"},{value:"Shortest-Path",label:"加权最短路径"},{value:"Edge-Type-Filter",label:"边类型过滤"}],So=e=>{const{state:t,updateState:n}=e,{filterRule:r}=t,{data:o}=(0,c.useContext)(),{generatorSchemaByGraphData:i}=c.utils,a=(0,h.useMemo)((()=>i(o)),[o]),s=(0,h.useMemo)((()=>{const e=a.edges.reduce(((e,t)=>Object.assign(Object.assign({},e),t.properties)),{});return Object.keys(e).filter((t=>"number"===e[t]))}),[a]),l=(0,h.useMemo)((()=>a.edges.map((e=>({value:e.edgeType,label:e.edgeType})))),[a]);return m().createElement("div",{className:"gi-filter-rule-container"},m().createElement(L.Form.Item,{label:"过滤规则"},m().createElement(L.Select,{value:r.type,options:Co,style:{width:"100%"},onChange:e=>{n((t=>{t.filterRule.type=e}))}})),"Shortest-Path"===r.type&&m().createElement(L.Form.Item,{label:"权重属性"},m().createElement(L.Select,{value:r.weightPropertyName,allowClear:!0,onChange:e=>{n((t=>{t.filterRule.weightPropertyName=e}))}},s.map((e=>m().createElement(L.Select.Option,{value:e},e))))),"Edge-Type-Filter"===r.type&&m().createElement(L.Form.Item,{label:"边类型"},m().createElement(L.Select,{value:r.edgeType,onChange:e=>{n((t=>{t.filterRule.edgeType=e}))}},l.map((e=>m().createElement(L.Select.Option,{value:e.value},e.label))))))},Oo=e=>{const{children:t,state:n,updateState:r}=e;return m().createElement(L.Popover,{trigger:"click",title:"过滤规则",placement:"right",content:m().createElement(So,{state:n,updateState:r})},m().createElement(L.Button,{type:"primary",icon:m().createElement(wo,null)}))},To=e=>{const{pathId:t,onSwitchChange:n,highlightPath:r}=e,o=r.has(t);return m().createElement("div",{onClick:e=>{e.stopPropagation()}},m().createElement(L.Switch,{checked:o,onChange:e=>n(t)}))};var Ao=function(e,t){return e===t},No=function(){function e(e,t){void 0===t&&(t=null),this.value=e,this.next=t}return e.prototype.toString=function(e){return e?e(this.value):"".concat(this.value)},e}(),ko=function(){function e(e){void 0===e&&(e=Ao),this.head=null,this.tail=null,this.compare=e}return e.prototype.prepend=function(e){var t=new No(e,this.head);return this.head=t,this.tail||(this.tail=t),this},e.prototype.append=function(e){var t=new No(e);return this.head?(this.tail.next=t,this.tail=t,this):(this.head=t,this.tail=t,this)},e.prototype.delete=function(e){if(!this.head)return null;for(var t=null;this.head&&this.compare(this.head.value,e);)t=this.head,this.head=this.head.next;var n=this.head;if(null!==n)for(;n.next;)this.compare(n.next.value,e)?(t=n.next,n.next=n.next.next):n=n.next;return this.compare(this.tail.value,e)&&(this.tail=n),t},e.prototype.find=function(e){var t=e.value,n=void 0===t?void 0:t,r=e.callback,o=void 0===r?void 0:r;if(!this.head)return null;for(var i=this.head;i;){if(o&&o(i.value))return i;if(void 0!==n&&this.compare(i.value,n))return i;i=i.next}return null},e.prototype.deleteTail=function(){var e=this.tail;if(this.head===this.tail)return this.head=null,this.tail=null,e;for(var t=this.head;t.next;)t.next.next?t=t.next:t.next=null;return this.tail=t,e},e.prototype.deleteHead=function(){if(!this.head)return null;var e=this.head;return this.head.next?this.head=this.head.next:(this.head=null,this.tail=null),e},e.prototype.fromArray=function(e){var t=this;return e.forEach((function(e){return t.append(e)})),this},e.prototype.toArray=function(){for(var e=[],t=this.head;t;)e.push(t),t=t.next;return e},e.prototype.reverse=function(){for(var e=this.head,t=null,n=null;e;)n=e.next,e.next=t,t=e,e=n;this.tail=this.head,this.head=t},e.prototype.toString=function(e){return void 0===e&&(e=void 0),this.toArray().map((function(t){return t.toString(e)})).toString()},e}();const _o=ko;!function(){function e(){this.linkedList=new _o}e.prototype.isEmpty=function(){return!this.linkedList.head},e.prototype.peek=function(){return this.linkedList.head?this.linkedList.head.value:null},e.prototype.enqueue=function(e){this.linkedList.append(e)},e.prototype.dequeue=function(){var e=this.linkedList.deleteHead();return e?e.value:null},e.prototype.toString=function(e){return this.linkedList.toString(e)}}();function jo(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))}Object.create,Object.create;var Fo={}.toString;const Po=function(e,t){return Fo.call(e)==="[object "+t+"]"},Mo=function(e){return Po(e,"Function")},Ro=function(e){return Array.isArray?Array.isArray(e):Po(e,"Array")};Object.keys;var Lo=Array.prototype;Lo.splice,Lo.indexOf,Array.prototype.splice;Object.prototype.hasOwnProperty;Number.isInteger&&Number.isInteger,Math.PI,parseInt,Math.PI;const Go=Object.values?function(e){return Object.values(e)}:function(e){var t=[];return function(e,t){var n,r;if(e)if(Ro(e))for(var o=0,i=e.length;o<i&&!1!==t(e[o],o);o++);else if(r=typeof(n=e),null!==n&&"object"===r||"function"===r)for(var a in e)if(e.hasOwnProperty(a)&&!1===t(e[a],a))break}(e,(function(n,r){Mo(e)&&"prototype"===r||t.push(n)})),t};Object.prototype;var Do=function(e){if("object"!=typeof e||null===e)return e;var t;if(Ro(e)){t=[];for(var n=0,r=e.length;n<r;n++)"object"==typeof e[n]&&null!=e[n]?t[n]=Do(e[n]):t[n]=e[n]}else for(var o in t={},e)"object"==typeof e[o]&&null!=e[o]?t[o]=Do(e[o]):t[o]=e[o];return t};const Bo=Do;var zo;Object.prototype.hasOwnProperty,Object.prototype.hasOwnProperty,function(e,t){if(!Mo(e))throw new TypeError("Expected a function");var n=function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];var i=t?t.apply(this,r):r[0],a=n.cache;if(a.has(i))return a.get(i);var s=e.apply(this,r);return a.set(i,s),s};n.cache=new Map}((function(e,t){void 0===t&&(t={});var n,r=t.fontSize,o=t.fontFamily,i=t.fontWeight,a=t.fontStyle,s=t.fontVariant;return zo||(zo=document.createElement("canvas").getContext("2d")),zo.font=[a,s,i,r+"px",o].join(" "),zo.measureText((n=e,Po(n,"String")?e:"")).width}),(function(e,t){return void 0===t&&(t={}),function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)r[o]=i[a];return r}([e],Go(t)).join("")})),function(){function e(){this.map={}}e.prototype.has=function(e){return void 0!==this.map[e]},e.prototype.get=function(e,t){var n=this.map[e];return void 0===n?t:n},e.prototype.set=function(e,t){this.map[e]=t},e.prototype.clear=function(){this.map={}},e.prototype.delete=function(e){delete this.map[e]},e.prototype.size=function(){return Object.keys(this.map).length}}();function $o(e,t,n,r){if(e===t.node)return[t];if(r[t.node])return r[t.node];for(var o=[],i=0,a=n[t.node];i<a.length;i++){var s=a[i],l=$o(e,s,n,r);if(!l)return;for(var c=0,u=l;c<u.length;c++){var d=u[c];if(Ro(d)){var p=jo([],d,!0).splice(0,d.length-1);o.push(jo(jo([],p,!0),[s,{node:t.node}],!1))}else o.push([d,{node:t.node}])}}return r[t.node]=o,r[t.node]}var qo,Uo=function(e,t,n,r,o){var i=function(e,t,n,r){var o=e.nodes,i=void 0===o?[]:o,a=e.edges,s=void 0===a?[]:a,l=[],c={},u={},d={};i.forEach((function(e,n){var r=e.id;l.push(r),u[r]=1/0,r===t&&(u[r]=0)}));for(var p=i.length,f=function(e){var t=function(e,t,n){for(var r,o=1/0,i=0;i<t.length;i++){var a=t[i].id;!n[a]&&e[a]<=o&&(o=e[a],r=t[i])}return r}(u,i,c),o=t.id;if(c[o]=!0,u[o]===1/0)return"continue";var a=[];a=n?function(e,t){return t.filter((function(t){return t.source===e}))}(o,s):function(e,t){return t.filter((function(t){return t.source===e||t.target===e}))}(o,s),a.forEach((function(e){var t=e.target,n=e.source,i=t===o?n:t,a=r&&e[r]?e[r]:1;u[i]>u[o]+a?(u[i]=u[o]+a,d[i]=[{node:o,edge:e.id}]):u[i]===u[o]+a&&d[i].push({node:o,edge:e.id})}))},h=0;h<p;h++)f();d[t]=[{node:t,edge:void 0}];var m={};for(var g in u)u[g]!==1/0&&$o(t,{node:g},d,m);var y={},v={};Object.keys(m).forEach((function(e){var t=m[e];y[e]=t.map((function(e){return e.map((function(e){return e.node}))})),v[e]=t.map((function(e){return e.map((function(e){return e.edge})).filter(Boolean)}))}));var b={},x={};for(var g in m)b[g]=y[g][0],x[g]=v[g][0];return{length:u,path:b,edgePath:x,allPath:y,allEdgePath:v}}(e,t,r,o),a=i.length,s=i.path,l=i.allPath,c=i.edgePath,u=i.allEdgePath;return{length:a[n],path:s[n],allPath:l[n],edgePath:c[n],allEdgePath:u[n]}};!function(){function e(e){this.arr=e}e.prototype.getArr=function(){return this.arr||[]},e.prototype.add=function(t){var n,r=t.arr;if(!(null===(n=this.arr)||void 0===n?void 0:n.length))return new e(r);if(!(null==r?void 0:r.length))return new e(this.arr);if(this.arr.length===r.length){var o=[];for(var i in this.arr)o[i]=this.arr[i]+r[i];return new e(o)}},e.prototype.subtract=function(t){var n,r=t.arr;if(!(null===(n=this.arr)||void 0===n?void 0:n.length))return new e(r);if(!(null==r?void 0:r.length))return new e(this.arr);if(this.arr.length===r.length){var o=[];for(var i in this.arr)o[i]=this.arr[i]-r[i];return new e(o)}},e.prototype.avg=function(t){var n=[];if(0!==t)for(var r in this.arr)n[r]=this.arr[r]/t;return new e(n)},e.prototype.negate=function(){var t=[];for(var n in this.arr)t[n]=-this.arr[n];return new e(t)},e.prototype.squareEuclideanDistance=function(e){var t,n=e.arr;if(!(null===(t=this.arr)||void 0===t?void 0:t.length)||!(null==n?void 0:n.length))return 0;if(this.arr.length===n.length){var r=0;for(var o in this.arr)r+=Math.pow(this.arr[o]-e.arr[o],2);return r}},e.prototype.euclideanDistance=function(e){var t,n=e.arr;if(!(null===(t=this.arr)||void 0===t?void 0:t.length)||!(null==n?void 0:n.length))return 0;if(this.arr.length===n.length){var r=0;for(var o in this.arr)r+=Math.pow(this.arr[o]-e.arr[o],2);return Math.sqrt(r)}console.error("The two vectors are unequal in length.")},e.prototype.normalize=function(){var t=[],n=Bo(this.arr);n.sort((function(e,t){return e-t}));var r=n[n.length-1],o=n[0];for(var i in this.arr)t[i]=(this.arr[i]-o)/(r-o);return new e(t)},e.prototype.norm2=function(){var e;if(!(null===(e=this.arr)||void 0===e?void 0:e.length))return 0;var t=0;for(var n in this.arr)t+=Math.pow(this.arr[n],2);return Math.sqrt(t)},e.prototype.dot=function(e){var t,n=e.arr;if(!(null===(t=this.arr)||void 0===t?void 0:t.length)||!(null==n?void 0:n.length))return 0;if(this.arr.length===n.length){var r=0;for(var o in this.arr)r+=this.arr[o]*e.arr[o];return r}console.error("The two vectors are unequal in length.")},e.prototype.equal=function(e){var t,n=e.arr;if((null===(t=this.arr)||void 0===t?void 0:t.length)!==(null==n?void 0:n.length))return!1;for(var r in this.arr)if(this.arr[r]!==n[r])return!1;return!0}}(),function(e){e.EuclideanDistance="euclideanDistance"}(qo||(qo={})),function(){function e(e){this.count=e.length,this.parent={};for(var t=0,n=e;t<n.length;t++){var r=n[t];this.parent[r]=r}}e.prototype.find=function(e){for(;this.parent[e]!==e;)e=this.parent[e];return e},e.prototype.union=function(e,t){var n=this.find(e),r=this.find(t);n!==r&&(n<r?(this.parent[t]!==t&&this.union(this.parent[t],e),this.parent[t]=this.parent[e]):(this.parent[e]!==e&&this.union(this.parent[e],t),this.parent[e]=this.parent[t]))},e.prototype.connected=function(e,t){return this.find(e)===this.find(t)}}();var Vo=function(e,t){return e-t};!function(){function e(e){void 0===e&&(e=Vo),this.compareFn=e,this.list=[]}e.prototype.getLeft=function(e){return 2*e+1},e.prototype.getRight=function(e){return 2*e+2},e.prototype.getParent=function(e){return 0===e?null:Math.floor((e-1)/2)},e.prototype.isEmpty=function(){return this.list.length<=0},e.prototype.top=function(){return this.isEmpty()?void 0:this.list[0]},e.prototype.delMin=function(){var e=this.top(),t=this.list.pop();return this.list.length>0&&(this.list[0]=t,this.moveDown(0)),e},e.prototype.insert=function(e){if(null!==e){this.list.push(e);var t=this.list.length-1;return this.moveUp(t),!0}return!1},e.prototype.moveUp=function(e){for(var t=this.getParent(e);e&&e>0&&this.compareFn(this.list[t],this.list[e])>0;){var n=this.list[t];this.list[t]=this.list[e],this.list[e]=n,e=t,t=this.getParent(e)}},e.prototype.moveDown=function(e){var t,n=e,r=this.getLeft(e),o=this.getRight(e),i=this.list.length;null!==r&&r<i&&this.compareFn(this.list[n],this.list[r])>0?n=r:null!==o&&o<i&&this.compareFn(this.list[n],this.list[o])>0&&(n=o),e!==n&&(t=[this.list[n],this.list[e]],this.list[e]=t[0],this.list[n]=t[1],this.moveDown(n))}}();var Ho="-1",Wo=function(e,t,n,r){void 0===e&&(e=-1),void 0===t&&(t=-1),void 0===n&&(n=-1),void 0===r&&(r="-1"),this.id=e,this.from=t,this.to=n,this.label=r},Ko=function(){function e(e,t){void 0===e&&(e=-1),void 0===t&&(t=Ho),this.id=e,this.label=t,this.edges=[],this.edgeMap={}}return e.prototype.addEdge=function(e){this.edges.push(e),this.edgeMap[e.id]=e},e}(),Yo=function(){function e(e,t,n){void 0===e&&(e=-1),void 0===t&&(t=!0),void 0===n&&(n=!1),this.id=e,this.edgeIdAutoIncrease=t,this.edges=[],this.nodes=[],this.nodeMap={},this.edgeMap={},this.nodeLabelMap={},this.edgeLabelMap={},this.counter=0,this.directed=n}return e.prototype.getNodeNum=function(){return this.nodes.length},e.prototype.addNode=function(e,t){if(!this.nodeMap[e]){var n=new Ko(e,t);this.nodes.push(n),this.nodeMap[e]=n,this.nodeLabelMap[t]||(this.nodeLabelMap[t]=[]),this.nodeLabelMap[t].push(e)}},e.prototype.addEdge=function(e,t,n,r){if((this.edgeIdAutoIncrease||void 0===e)&&(e=this.counter++),!(this.nodeMap[t]&&this.nodeMap[n]&&this.nodeMap[n].edgeMap[e])){var o=new Wo(e,t,n,r);if(this.edges.push(o),this.edgeMap[e]=o,this.nodeMap[t].addEdge(o),this.edgeLabelMap[r]||(this.edgeLabelMap[r]=[]),this.edgeLabelMap[r].push(o),!this.directed){var i=new Wo(e,n,t,r);this.nodeMap[n].addEdge(i),this.edgeLabelMap[r].push(i)}}},e}(),Xo=function(){function e(e,t,n,r,o){this.fromNode=e,this.toNode=t,this.nodeEdgeNodeLabel={nodeLabel1:n||Ho,edgeLabel:r||"-1",nodeLabel2:o||Ho}}return e.prototype.equalTo=function(e){return this.fromNode===e.formNode&&this.toNode===e.toNode&&this.nodeEdgeNodeLabel===e.nodeEdgeNodeLabel},e.prototype.notEqualTo=function(e){return!this.equalTo(e)},e}(),Qo=function(){function e(){this.rmpath=[],this.dfsEdgeList=[]}return e.prototype.equalTo=function(e){var t=this.dfsEdgeList.length;if(t!==e.length)return!1;for(var n=0;n<t;n++)if(this.dfsEdgeList[n]!==e[n])return!1;return!0},e.prototype.notEqualTo=function(e){return!this.equalTo(e)},e.prototype.pushBack=function(e,t,n,r,o){return this.dfsEdgeList.push(new Xo(e,t,n,r,o)),this.dfsEdgeList},e.prototype.toGraph=function(e,t){void 0===e&&(e=-1),void 0===t&&(t=!1);var n=new Yo(e,!0,t);return this.dfsEdgeList.forEach((function(e){var t=e.fromNode,r=e.toNode,o=e.nodeEdgeNodeLabel,i=o.nodeLabel1,a=o.edgeLabel,s=o.nodeLabel2;i!==Ho&&n.addNode(t,i),s!==Ho&&n.addNode(r,s),i!==Ho&&s!==i&&n.addEdge(void 0,t,r,a)})),n},e.prototype.buildRmpath=function(){this.rmpath=[];for(var e=void 0,t=this.dfsEdgeList.length-1;t>=0;t--){var n=this.dfsEdgeList[t],r=n.fromNode,o=n.toNode;r<o&&(void 0===e||o===e)&&(this.rmpath.push(t),e=r)}return this.rmpath},e.prototype.getNodeNum=function(){var e={};return this.dfsEdgeList.forEach((function(t){e[t.fromNode]||(e[t.fromNode]=!0),e[t.toNode]||(e[t.toNode]=!0)})),Object.keys(e).length},e}(),Jo=function(){function e(e){if(this.his={},this.nodesUsed={},this.edgesUsed={},this.edges=[],e){for(;e;){var t=e.edge;this.edges.push(t),this.nodesUsed[t.from]=1,this.nodesUsed[t.to]=1,this.edgesUsed[t.id]=1,e=e.preNode}this.edges=this.edges.reverse()}}return e.prototype.hasNode=function(e){return 1===this.nodesUsed[e.id]},e.prototype.hasEdge=function(e){return 1===this.edgesUsed[e.id]},e}();!function(){function e(e){var t=e.graphs,n=e.minSupport,r=void 0===n?2:n,o=e.minNodeNum,i=void 0===o?1:o,a=e.maxNodeNum,s=void 0===a?4:a,l=e.top,c=void 0===l?10:l,u=e.directed,d=void 0!==u&&u,p=e.verbose,f=void 0!==p&&p;this.graphs=t,this.dfsCode=new Qo,this.support=0,this.frequentSize1Subgraphs=[],this.frequentSubgraphs=[],this.minSupport=r,this.top=c,this.directed=d,this.counter=0,this.maxNodeNum=s,this.minNodeNum=i,this.verbose=f,this.maxNodeNum<this.minNodeNum&&(this.maxNodeNum=this.minNodeNum),this.reportDF=[]}e.prototype.findForwardRootEdges=function(e,t){var n=this,r=[],o=e.nodeMap;return t.edges.forEach((function(e){(n.directed||t.label<=o[e.to].label)&&r.push(e)})),r},e.prototype.findBackwardEdge=function(e,t,n,r){if(!this.directed&&t===n)return null;for(var o=e.nodeMap,i=o[n.to].edges,a=i.length,s=0;s<a;s++){var l=i[s];if(!r.hasEdge(l)&&l.to===t.from)if(this.directed){if(o[t.from].label<o[n.to].label||o[t.from].label===o[n.to].label&&t.label<=l.label)return l}else if(t.label<l.label||t.label===l.label&&o[t.to].label<=o[n.to].label)return l}return null},e.prototype.findForwardPureEdges=function(e,t,n,r){for(var o=[],i=t.to,a=e.nodeMap[i].edges,s=a.length,l=0;l<s;l++){var c=a[l],u=e.nodeMap[c.to];n<=u.label&&!r.hasNode(u)&&o.push(c)}return o},e.prototype.findForwardRmpathEdges=function(e,t,n,r){for(var o=[],i=e.nodeMap,a=i[t.to].label,s=i[t.from].edges,l=s.length,c=0;c<l;c++){var u=s[c],d=i[u.to].label;t.to===u.to||n>d||r.hasNode(i[u.to])||(t.label<u.label||t.label===u.label&&a<=d)&&o.push(u)}return o},e.prototype.getSupport=function(e){var t={};return e.forEach((function(e){t[e.graphId]||(t[e.graphId]=!0)})),Object.keys(t).length},e.prototype.findMinLabel=function(e){var t=void 0;return Object.keys(e).forEach((function(n){var r=e[n],o=r.nodeLabel1,i=r.edgeLabel,a=r.nodeLabel2;t?(o<t.nodeLabel1||o===t.nodeLabel1&&i<t.edgeLabel||o===t.nodeLabel1&&i===t.edgeLabel&&a<t.nodeLabel2)&&(t={nodeLabel1:o,edgeLabel:i,nodeLabel2:a}):t={nodeLabel1:o,edgeLabel:i,nodeLabel2:a}})),t},e.prototype.isMin=function(){var e=this,t=this.dfsCode;if(this.verbose&&console.log("isMin checking",t),1===t.dfsEdgeList.length)return!0;var n=this.directed,r=t.toGraph(-1,n),o=r.nodeMap,i=new Qo,a={};r.nodes.forEach((function(t){e.findForwardRootEdges(r,t).forEach((function(e){var n=o[e.to],i="".concat(t.label,"-").concat(e.label,"-").concat(n.label);a[i]||(a[i]={projected:[],nodeLabel1:t.label,edgeLabel:e.label,nodeLabel2:n.label});var s={graphId:r.id,edge:e,preNode:null};a[i].projected.push(s)}))}));var s=this.findMinLabel(a);if(s){i.dfsEdgeList.push(new Xo(0,1,s.nodeLabel1,s.edgeLabel,s.nodeLabel2));var l="".concat(s.nodeLabel1,"-").concat(s.edgeLabel,"-").concat(s.nodeLabel2);return function a(s){for(var l=i.buildRmpath(),c=i.dfsEdgeList[0].nodeEdgeNodeLabel.nodeLabel1,u=i.dfsEdgeList[l[0]].toNode,d={},p=!1,f=0,h=n?-1:0,m=function(t){if(p)return"break";s.forEach((function(n){var o=new Jo(n),a=e.findBackwardEdge(r,o.edges[l[t]],o.edges[l[0]],o);a&&(d[a.label]||(d[a.label]={projected:[],edgeLabel:a.label}),d[a.label].projected.push({graphId:r.id,edge:d,preNode:n}),f=i.dfsEdgeList[l[t]].fromNode,p=!0)}))},g=l.length-1;g>h&&"break"!==m(g);g--);if(p){var y=e.findMinLabel(d);i.dfsEdgeList.push(new Xo(u,f,Ho,y.edgeLabel,Ho));var v=i.dfsEdgeList.length-1;return e.dfsCode.dfsEdgeList[v]===i.dfsEdgeList[v]&&a(d[y.edgeLabel].projected)}var b={};p=!1;var x=0;s.forEach((function(t){var n=new Jo(t),i=e.findForwardPureEdges(r,n.edges[l[0]],c,n);i.length>0&&(p=!0,x=u,i.forEach((function(e){var n="".concat(e.label,"-").concat(o[e.to].label);b[n]||(b[n]={projected:[],edgeLabel:e.label,nodeLabel2:o[e.to].label}),b[n].projected.push({graphId:r.id,edge:e,preNode:t})})))}));var E=l.length,I=function(t){if(p)return"break";var n=l[t];s.forEach((function(t){var a=new Jo(t),s=e.findForwardRmpathEdges(r,a.edges[n],c,a);s.length>0&&(p=!0,x=i.dfsEdgeList[n].fromNode,s.forEach((function(e){var n="".concat(e.label,"-").concat(o[e.to].label);b[n]||(b[n]={projected:[],edgeLabel:e.label,nodeLabel2:o[e.to].label}),b[n].projected.push({graphId:r.id,edge:e,preNode:t})})))}))};for(g=0;g<E&&"break"!==I(g);g++);if(!p)return!0;var w=e.findMinLabel(b);i.dfsEdgeList.push(new Xo(x,u+1,Ho,w.edgeLabel,w.nodeLabel2));var C=i.dfsEdgeList.length-1;return t.dfsEdgeList[C]===i.dfsEdgeList[C]&&a(b["".concat(w.edgeLabel,"-").concat(w.nodeLabel2)].projected)}(a[l].projected)}},e.prototype.report=function(){if(!(this.dfsCode.getNodeNum()<this.minNodeNum)){this.counter++;var e=this.dfsCode.toGraph(this.counter,this.directed);this.frequentSubgraphs.push(Bo(e))}},e.prototype.subGraphMining=function(e){var t=this;if(!(this.getSupport(e)<this.minSupport)&&this.isMin()){this.report();var n=this.dfsCode.getNodeNum(),r=this.dfsCode.buildRmpath(),o=this.dfsCode.dfsEdgeList[r[0]].toNode,i=this.dfsCode.dfsEdgeList[0].nodeEdgeNodeLabel.nodeLabel1,a={},s={};e.forEach((function(e){for(var l=t.graphs[e.graphId],c=l.nodeMap,u=new Jo(e),d=r.length-1;d>=0;d--){var p=t.findBackwardEdge(l,u.edges[r[d]],u.edges[r[0]],u);if(p){var f="".concat(t.dfsCode.dfsEdgeList[r[d]].fromNode,"-").concat(p.label);s[f]||(s[f]={projected:[],toNodeId:t.dfsCode.dfsEdgeList[r[d]].fromNode,edgeLabel:p.label}),s[f].projected.push({graphId:e.graphId,edge:p,preNode:e})}}if(!(n>=t.maxNodeNum)){t.findForwardPureEdges(l,u.edges[r[0]],i,u).forEach((function(t){var n="".concat(o,"-").concat(t.label,"-").concat(c[t.to].label);a[n]||(a[n]={projected:[],fromNodeId:o,edgeLabel:t.label,nodeLabel2:c[t.to].label}),a[n].projected.push({graphId:e.graphId,edge:t,preNode:e})}));var h=function(n){t.findForwardRmpathEdges(l,u.edges[r[n]],i,u).forEach((function(o){var i="".concat(t.dfsCode.dfsEdgeList[r[n]].fromNode,"-").concat(o.label,"-").concat(c[o.to].label);a[i]||(a[i]={projected:[],fromNodeId:t.dfsCode.dfsEdgeList[r[n]].fromNode,edgeLabel:o.label,nodeLabel2:c[o.to].label}),a[i].projected.push({graphId:e.graphId,edge:o,preNode:e})}))};for(d=0;d<r.length;d++)h(d)}})),Object.keys(s).forEach((function(e){var n=s[e],r=n.toNodeId,i=n.edgeLabel;t.dfsCode.dfsEdgeList.push(new Xo(o,r,"-1",i,"-1")),t.subGraphMining(s[e].projected),t.dfsCode.dfsEdgeList.pop()})),Object.keys(a).forEach((function(e){var n=a[e],r=n.fromNodeId,i=n.edgeLabel,s=n.nodeLabel2;t.dfsCode.dfsEdgeList.push(new Xo(r,o+1,Ho,i,s)),t.subGraphMining(a[e].projected),t.dfsCode.dfsEdgeList.pop()}))}},e.prototype.generate1EdgeFrequentSubGraphs=function(){var e=this.graphs,t=this.directed,n=this.minSupport,r=this.frequentSize1Subgraphs,o={},i={},a={},s={};return Object.keys(e).forEach((function(n){var r=e[n],l=r.nodeMap;r.nodes.forEach((function(e,r){var c=e.label,u="".concat(n,"-").concat(c);if(!a[u]){var d=o[c]||0;d++,o[c]=d}a[u]={graphKey:n,label:c},e.edges.forEach((function(e){var r=c,o=l[e.to].label;if(!t&&r>o){var a=o;o=r,r=a}var u=e.label,d="".concat(n,"-").concat(r,"-").concat(u,"-").concat(o),p="".concat(r,"-").concat(u,"-").concat(o);if(!i[p]){var f=i[p]||0;f++,i[p]=f}s[d]={graphId:n,nodeLabel1:r,edgeLabel:u,nodeLabel2:o}}))}))})),Object.keys(o).forEach((function(e){if(!(o[e]<n)){var t={nodes:[],edges:[]};t.nodes.push({id:"0",label:e}),r.push(t)}})),r},e.prototype.run=function(){var e=this;if(this.frequentSize1Subgraphs=this.generate1EdgeFrequentSubGraphs(),!(this.maxNodeNum<2)){var t=this.graphs,n=(this.directed,{});Object.keys(t).forEach((function(r){var o=t[r],i=o.nodeMap;o.nodes.forEach((function(t){e.findForwardRootEdges(o,t).forEach((function(e){var o=i[e.to],a="".concat(t.label,"-").concat(e.label,"-").concat(o.label);n[a]||(n[a]={projected:[],nodeLabel1:t.label,edgeLabel:e.label,nodeLabel2:o.label});var s={graphId:r,edge:e,preNode:null};n[a].projected.push(s)}))}))})),Object.keys(n).forEach((function(t){var r=n[t],o=r.projected,i=r.nodeLabel1,a=r.edgeLabel,s=r.nodeLabel2;e.dfsCode.dfsEdgeList.push(new Xo(0,1,i,a,s)),e.subGraphMining(o),e.dfsCode.dfsEdgeList.pop()}))}}}(),function(){function e(e){void 0===e&&(e=10),this.linkedList=new _o,this.maxStep=e}Object.defineProperty(e.prototype,"length",{get:function(){return this.linkedList.toArray().length},enumerable:!1,configurable:!0}),e.prototype.isEmpty=function(){return!this.linkedList.head},e.prototype.isMaxStack=function(){return this.toArray().length>=this.maxStep},e.prototype.peek=function(){return this.isEmpty()?null:this.linkedList.head.value},e.prototype.push=function(e){this.linkedList.prepend(e),this.length>this.maxStep&&this.linkedList.deleteTail()},e.prototype.pop=function(){var e=this.linkedList.deleteHead();return e?e.value:null},e.prototype.toArray=function(){return this.linkedList.toArray().map((function(e){return e.value}))},e.prototype.clear=function(){for(;!this.isEmpty();)this.pop()}}();const{Panel:Zo}=L.Collapse;!function(){function e(e,t){function n(){this.constructor=e}o(e,t),e.prototype=(n.prototype=t.prototype,new n)}function t(e){e.o||(e.R=new Map,e.o=new Map(e.t))}function n(e){e.o||(e.o=new Set,e.t.forEach((function(t){if(Ln(t)){var n=ur(e.A.h,t,e);e.p.set(t,n),e.o.add(n)}else e.o.add(t)})))}function r(e){e.g&&Mn(3,JSON.stringify(Un(e)))}var o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},i=function(){function n(e,t){return this[Er]={i:2,l:t,A:t?t.A:Xn(),P:!1,I:!1,o:void 0,R:void 0,t:e,k:this,C:!1,g:!1},this}e(n,Map);var o=n.prototype;return Object.defineProperty(o,"size",{get:function(){return Un(this[Er]).size}}),o.has=function(e){return Un(this[Er]).has(e)},o.set=function(e,n){var o=this[Er];return r(o),Un(o).has(e)&&Un(o).get(e)===n||(t(o),lr(o),o.R.set(e,!0),o.o.set(e,n),o.R.set(e,!0)),this},o.delete=function(e){if(!this.has(e))return!1;var n=this[Er];return r(n),t(n),lr(n),n.t.has(e)?n.R.set(e,!1):n.R.delete(e),n.o.delete(e),!0},o.clear=function(){var e=this[Er];r(e),Un(e).size&&(t(e),lr(e),e.R=new Map,Gn(e.t,(function(t){e.R.set(t,!1)})),e.o.clear())},o.forEach=function(e,t){var n=this;Un(this[Er]).forEach((function(r,o){e.call(t,n.get(o),o,n)}))},o.get=function(e){var n=this[Er];r(n);var o=Un(n).get(e);if(n.I||!Ln(o))return o;if(o!==n.t.get(e))return o;var i=ur(n.A.h,o,n);return t(n),n.o.set(e,i),i},o.keys=function(){return Un(this[Er]).keys()},o.values=function(){var e,t=this,n=this.keys();return(e={})[Ir]=function(){return t.values()},e.next=function(){var e=n.next();return e.done?e:{done:!1,value:t.get(e.value)}},e},o.entries=function(){var e,t=this,n=this.keys();return(e={})[Ir]=function(){return t.entries()},e.next=function(){var e=n.next();if(e.done)return e;var r=t.get(e.value);return{done:!1,value:[e.value,r]}},e},o[Ir]=function(){return this.entries()},n}(),a=function(){function t(e,t){return this[Er]={i:3,l:t,A:t?t.A:Xn(),P:!1,I:!1,o:void 0,t:e,k:this,p:new Map,g:!1,C:!1},this}e(t,Set);var o=t.prototype;return Object.defineProperty(o,"size",{get:function(){return Un(this[Er]).size}}),o.has=function(e){var t=this[Er];return r(t),t.o?!!t.o.has(e)||!(!t.p.has(e)||!t.o.has(t.p.get(e))):t.t.has(e)},o.add=function(e){var t=this[Er];return r(t),this.has(e)||(n(t),lr(t),t.o.add(e)),this},o.delete=function(e){if(!this.has(e))return!1;var t=this[Er];return r(t),n(t),lr(t),t.o.delete(e)||!!t.p.has(e)&&t.o.delete(t.p.get(e))},o.clear=function(){var e=this[Er];r(e),Un(e).size&&(n(e),lr(e),e.o.clear())},o.values=function(){var e=this[Er];return r(e),n(e),e.o.values()},o.entries=function(){var e=this[Er];return r(e),n(e),e.o.entries()},o.keys=function(){return this.values()},o[Ir]=function(){return this.values()},o.forEach=function(e,t){for(var n=this.values(),r=n.next();!r.done;)e.call(t,r.value,r.value,this),r=n.next()},t}();!function(e,t){Or[e]||(Or[e]=t)}("MapSet",{F:function(e,t){return new i(e,t)},T:function(e,t){return new a(e,t)}})}();const ei={id:"PathAnalysis",name:"路径分析",desc:"选择起点和终点，即可分析路径",icon:"icon-path-analysis",cover:"http://xxxx.jpg",category:"data-analysis",type:"GIAC_CONTENT",docs:"https://www.yuque.com/antv/gi/memi2i8r5go0w9cp"},{deepClone:ti,GIAC_CONTENT_METAS:ni}=c.extra,ri=ti(ni);ri.GIAC_CONTENT.properties.GIAC_CONTENT.properties.title.default=ei.name,ri.GIAC_CONTENT.properties.GIAC_CONTENT.properties.icon.default=ei.icon,ri.GIAC_CONTENT.properties.GIAC_CONTENT.properties.containerWidth.default="400px";const oi={info:ei,component:e=>{const{pathNodeLabel:t,controlledValues:n,onOpen:r=(()=>{})}=e,{data:o,graph:i,sourceDataMap:a,updateHistory:s}=(0,c.useContext)(),[l,u]=Fr({allNodePath:[],allEdgePath:[],nodePath:[],edgePath:[],highlightPath:new Set,isAnalysis:!1,filterRule:{type:"All-Path"},selecting:""});let d=e=>{};const p=(0,h.useRef)({nodes:new Set,edges:new Set}),[f]=L.Form.useForm(),g=()=>{f.resetFields(),u((e=>{e.allNodePath=[],e.allEdgePath=[],e.nodePath=[],e.edgePath=[],e.highlightPath=new Set,e.isAnalysis=!1,e.filterRule={type:"All-Path"},e.selecting=""})),b()},y=()=>{f.validateFields().then((e=>{b();const{source:t,target:n,direction:r=!0}=e,i={componentId:"PathAnalysis",type:"analyse",subType:"路径",statement:`起点: ${t}, 终点: ${n}`,params:{source:t,target:n,direction:String(r)}};try{const{allPath:e,allEdgePath:a}=Uo(o,t,n,r);if(!(null==e?void 0:e.length)){let e="无符合条件的路径";return e=r?`${e}，可尝试将“是否有向”设置为“无向”，或改变起点与终点`:`${e}，可尝试改变起点与终点`,L.message.info(e),void s(Object.assign(Object.assign({},i),{success:!1,errorMsg:e}))}const l=new Set(e.map(((e,t)=>t)));u((t=>{t.allNodePath=e,t.allEdgePath=a,t.nodePath=e,t.edgePath=a,t.isAnalysis=!0,t.highlightPath=l,t.filterRule={type:"All-Path"},t.selecting=""})),s(Object.assign(Object.assign({},i),{success:!0}))}catch(e){s(Object.assign(Object.assign({},i),{success:!1,errorMsg:e}))}}))},v=e=>{u((t=>{t.highlightPath.has(e)?t.highlightPath.delete(e):t.highlightPath.add(e)}))},b=()=>{var e;[...null===(e=p.current)||void 0===e?void 0:e.nodes].forEach((e=>{i.findById(e)&&i.setItemState(e,"active",!1)})),[...p.current.edges].forEach((e=>{i.findById(e)&&(i.setItemState(e,"active",!1),i.updateItem(e,{style:{animate:{visible:!1,type:"circle-running",color:"rgba(236,65,198,1)",repeat:!0,duration:1e3}}}))}))},x=e=>{u((t=>{t.selecting=e})),i.off("node:click",d),d=t=>{u((e=>{e.selecting=""}));const{item:n}=t;n&&!n.destroyed&&f.setFieldsValue({[e]:n.getID()})},i.once("node:click",d)};return(0,h.useEffect)((()=>{for(let e=0;e<l.nodePath.length;e++){const t=l.nodePath[e],n=l.edgePath[e];l.highlightPath.has(e)||(t.forEach((e=>{var t;i.findById(e)&&i.setItemState(e,"active",!1),null===(t=p.current)||void 0===t||t.nodes.delete(e)})),n.forEach((e=>{var t;i.findById(e)&&i.setItemState(e,"active",!1),null===(t=p.current)||void 0===t||t.edges.delete(e)})))}for(let e=0;e<l.nodePath.length;e++){const t=l.nodePath[e],n=l.edgePath[e];l.highlightPath.has(e)&&(t.forEach((e=>{var t;i.findById(e)&&i.setItemState(e,"active",!0),null===(t=p.current)||void 0===t||t.nodes.add(e)})),n.forEach((e=>{var t;i.findById(e)&&(i.setItemState(e,"active",!0),i.updateItem(e,{style:{animate:{visible:!0,type:"circle-running",color:"rgba(236,65,198,1)",repeat:!0,duration:1e3}}})),null===(t=p.current)||void 0===t||t.edges.add(e)})))}}),[l.highlightPath]),(0,h.useEffect)((()=>{b(),p.current={nodes:new Set,edges:new Set};let e=[],t=[];if("Shortest-Path"===l.filterRule.type){const n={};let r=1/0;l.allEdgePath.forEach(((e,t)=>{const o=l.filterRule.weightPropertyName?((e,t,n)=>{let r=0;return e.forEach((e=>{const o=n.edges[e].data;r=r+o[t]?o[t]:0})),r})(e,l.filterRule.weightPropertyName,a):e.length;r=Math.min(r,o),n[t]=o})),e=l.allNodePath.filter(((e,t)=>n[t]===r)),t=l.allEdgePath.filter(((e,t)=>n[t]===r))}else if("Edge-Type-Filter"===l.filterRule.type&&l.filterRule.edgeType){const n=new Set;l.allEdgePath.forEach(((e,t)=>{e.every((e=>{const t=a.edges[e];return(null==t?void 0:t.edgeType)===l.filterRule.edgeType}))&&n.add(t)})),e=l.allNodePath.filter(((e,t)=>n.has(t))),t=l.allEdgePath.filter(((e,t)=>n.has(t)))}else e=l.allNodePath,t=l.allEdgePath;u((n=>{n.nodePath=e,n.edgePath=t,n.highlightPath=new Set(e.map(((e,t)=>t)))}))}),[l.allNodePath,l.allEdgePath,l.filterRule]),(0,h.useEffect)((()=>{g()}),[o]),(0,h.useEffect)((()=>{if(n){const{source:e,target:t,direction:o}=n;r(),f.setFieldsValue({source:e,target:t,direction:"false"!==o}),y()}}),[n]),m().createElement("div",{className:"gi-path-analysis"},m().createElement(L.Form,{form:f},m().createElement(L.Row,{justify:"space-between"},m().createElement(L.Col,{span:22},m().createElement(L.Form.Item,{label:"起始节点",name:"source",rules:[{required:!0,message:"请填写起点节点ID"}],tooltip:{open:"source"===l.selecting,title:"可点选画布节点，快速选择起始节点"}},m().createElement(L.Select,{showSearch:!0,optionFilterProp:"children",onChange:()=>{u((e=>{e.selecting=""}))},onFocus:()=>x("source")},o.nodes.map((e=>m().createElement(L.Select.Option,{key:e.id,value:e.id},e.id)))))),m().createElement(L.Col,{span:2,style:{lineHeight:"32px",textAlign:"right"}},m().createElement(yo,{style:{cursor:"pointer",color:"source"===l.selecting?"#1890ff":"rgba(0, 0, 0, 0.65)"},onClick:()=>x("source")}))),m().createElement(L.Row,{justify:"space-between"},m().createElement(L.Col,{span:22},m().createElement(L.Form.Item,{label:"目标节点",name:"target",rules:[{required:!0,message:"请填写终点节点ID"}],tooltip:{open:"target"===l.selecting,title:"可点选画布节点，快速选择目标节点"}},m().createElement(L.Select,{showSearch:!0,optionFilterProp:"children",onChange:()=>{u((e=>{e.selecting=""}))},onFocus:()=>x("target")},o.nodes.map((e=>m().createElement(L.Select.Option,{key:e.id,value:e.id},e.id)))))),m().createElement(L.Col,{span:2,style:{lineHeight:"32px",textAlign:"right"}},m().createElement(yo,{style:{cursor:"pointer",color:"target"===l.selecting?"#1890ff":"rgba(0, 0, 0, 0.65)"},onClick:()=>x("target")}))),m().createElement(L.Form.Item,{name:"direction",label:"是否有向"},m().createElement(L.Switch,{checkedChildren:"有向",unCheckedChildren:"无向",defaultChecked:!0})),m().createElement(L.Form.Item,null,m().createElement(L.Row,null,m().createElement(L.Col,{span:16},m().createElement(L.Button,{type:"primary",onClick:y,style:{width:"100%"}},"查询路径")),m().createElement(L.Col,{offset:"2",span:6,style:{textAlign:"right"}},m().createElement(L.Space,{size:"small"},l.isAnalysis&&l.allNodePath.length>0&&m().createElement(Oo,{state:l,updateState:u}),m().createElement(L.Button,{danger:!0,onClick:g,icon:m().createElement(Ht,null)})))))),m().createElement("div",{className:"gi-path-analysis-path-list-container"},l.nodePath.length>0&&m().createElement(L.Collapse,{defaultActiveKey:0,ghost:!0,className:"gi-collapse-container",expandIcon:({isActive:e})=>m().createElement(xo,{rotate:e?90:0})},l.nodePath.map(((e,n)=>m().createElement(Zo,{key:n,header:`路径${n+1}`,extra:m().createElement(To,{pathId:n,highlightPath:l.highlightPath,onSwitchChange:v})},m().createElement(L.Timeline,null,e.map((e=>{const n=a.nodes[e],r=(null==n?void 0:n.data)||{};return m().createElement(L.Timeline.Item,null,r[t]||e)}))))))),l.isAnalysis&&0===l.nodePath.length&&m().createElement(L.Empty,null)))},registerMeta:({schemaData:e})=>{const t=e.nodes.reduce(((e,t)=>Object.assign(Object.assign({},e),t.properties)),{}),n=Object.keys(t).filter((e=>"string"===t[e])).map((e=>({value:e,label:e})));return Object.assign({pathNodeLabel:{title:"标签映射",type:"string","x-decorator":"FormItem","x-component":"Select",enum:n,default:"id"}},ri)}},ii={info:{id:"Placeholder",name:"画布占位符",desc:"画布为空时出现的图片占位符",icon:"icon-placeholder",cover:"http://xxxx.jpg",category:"system-interaction",type:"AUTO",docs:"https://www.yuque.com/antv/gi/rcurl13mcgszu6g4"},component:e=>{const t=(0,c.useContext)(),{width:n=200,img:r="https://gw.alipayobjects.com/zos/bmw-prod/db278704-6158-432e-99d2-cc5db457585d.svg",text:o}=e,{data:i,largeGraphData:a,largeGraphLimit:s}=t;return i&&i.nodes&&0!==i.nodes.length?null:a?h.createElement("div",{className:"gi-placeholader",style:{width:`${n}px`}},r&&h.createElement("img",{src:r,width:n}),"当前载入图的节点规模已经超出「",s,"」限制，建议您在资产中心中加载「大图概览」资产，筛选子图数据 或 调整限制规模"):h.createElement("div",{className:"gi-placeholader",style:{width:`${n}px`}},r&&h.createElement("img",{src:r,width:n}),o)},registerMeta:()=>({img:{type:"string","x-component":"Input","x-decorator":"FormItem",title:"图片地址",default:"https://gw.alipayobjects.com/zos/bmw-prod/db278704-6158-432e-99d2-cc5db457585d.svg"},text:{type:"string",title:"文本","x-component":"Input","x-decorator":"FormItem",default:"开始你的图分析应用～"},width:{type:"number",title:"宽度","x-component":"NumberPicker","x-decorator":"FormItem",default:200}})},ai={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M563.8 512l262.5-312.9c4.4-5.2.7-13.1-6.1-13.1h-79.8c-4.7 0-9.2 2.1-12.3 5.7L511.6 449.8 295.1 191.7c-3-3.6-7.5-5.7-12.3-5.7H203c-6.8 0-10.5 7.9-6.1 13.1L459.4 512 196.9 824.9A7.95 7.95 0 00203 838h79.8c4.7 0 9.2-2.1 12.3-5.7l216.5-258.1 216.5 258.1c3 3.6 7.5 5.7 12.3 5.7h79.8c6.8 0 10.5-7.9 6.1-13.1L563.8 512z"}}]},name:"close",theme:"outlined"};var si=function(e,t){return h.createElement(bt,le(le({},e),{},{ref:t,icon:ai}))};si.displayName="CloseOutlined";const li=h.forwardRef(si),ci={LT:"top",LB:"left",RT:"right",RB:"bottom"},ui=e=>{const{containerWidth:t="600px",containerHeight:n="calc(100vh - 64px)",containerPlacement:r,children:o,visible:i,offset:a,onClose:s,title:l,animate:u}=e,d=c.utils.getPositionStyles(r,a);"RT"!==r&&"LB"!==r||(d.bottom="4px",d.top="4px",d.height="unset");const p=ci[r],f=u?i?`${p} open`:`${p} close`:"",m=u?{}:{display:i?"block":"none"};return h.createElement("div",{style:Object.assign(Object.assign({width:t,height:n,boxShadow:"6px 0 16px -8px rgb(0 0 0 / 8%), 9px 0 28px 0 rgb(0 0 0 / 5%), 12px 0 48px 16px rgb(0 0 0 / 3%)"},d),m),className:`gi-panel-div ${f}`},h.createElement("div",{className:"header"},h.createElement("div",{className:"title"}," ",l),h.createElement("div",{className:"close"},h.createElement(L.Button,{icon:h.createElement(li,null),type:"text",onClick:s}))),h.createElement("div",{className:"body"},o))},di=L.Input.Search,pi=e=>{const{data:t,propertyInfos:n=[]}=e,[r,o]=Fr({isSearch:!1,searchKey:""});let i=Object.keys(t).map((e=>{let r=t[e],o=!1;"object"==typeof r&&(r=JSON.stringify(r,null,2),o=!0),"string"!=typeof r&&(r=String(r));const{rank:i,isOutlier:a}=n.find((t=>t.propertyName===e))||{};return{key:e,value:r,isObject:o,rank:i,isOutlier:a}}));return r.isSearch&&(i=i.filter((e=>{const{key:t,value:n}=e;return t.includes(r.searchKey)||n.includes(r.searchKey)}))),m().createElement(m().Fragment,null,m().createElement(di,{placeholder:"Search in the properties",onSearch:e=>{const t=0!==e.length;o((n=>{n.isSearch=t,n.searchKey=e}))},style:{width:"100%"}}),m().createElement("ul",null,0===i.length&&m().createElement(L.Empty,{style:{marginTop:"50px"}}),i.map((e=>{const{key:t,value:n,isObject:r,rank:o,isOutlier:i}=e;let a=[],s="";if(void 0!==o||void 0!==i){let e=3-(o||0);s=`相对于属性 “${t}” 的其他值而言，当前属性值 “${n}” 出现概率${e>1?"极低":"较低"}，可能含有大信息量，值得关注`,i&&(e=4,s=`属性 “${t}” 的大部分属性值具有相同出现次数，而当前属性值 “${n}” 出现此处大于平均出现次数，值得关注`),a=new Array(e).fill(m().createElement(Ct,{twoToneColor:"#eb2f96"}))}return m().createElement("li",{key:t},m().createElement(L.Row,{className:"key"},m().createElement(L.Col,{span:20},t),m().createElement(L.Tooltip,{title:s,placement:"topLeft"},m().createElement(L.Col,{span:4},a))),m().createElement("div",{className:"value"},r?m().createElement("pre",null,n):n))}))))},fi={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M888 792H200V168c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v688c0 4.4 3.6 8 8 8h752c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM305.8 637.7c3.1 3.1 8.1 3.1 11.3 0l138.3-137.6L583 628.5c3.1 3.1 8.2 3.1 11.3 0l275.4-275.3c3.1-3.1 3.1-8.2 0-11.3l-39.6-39.6a8.03 8.03 0 00-11.3 0l-230 229.9L461.4 404a8.03 8.03 0 00-11.3 0L266.3 586.7a8.03 8.03 0 000 11.3l39.5 39.7z"}}]},name:"line-chart",theme:"outlined"};var hi=function(e,t){return h.createElement(bt,le(le({},e),{},{ref:t,icon:fi}))};hi.displayName="LineChartOutlined";const mi=h.forwardRef(hi),gi=e=>{const{data:t,xField:n,yField:r}=e,o=m().useMemo((()=>St()),[]);return(0,h.useEffect)((()=>{const e=new Wt.Column(`${o}-linechart-container`,{data:t,xField:n,yField:r,height:350});return e.render(),()=>{e.destroy()}}),[t,n,r]),m().createElement("div",{id:`${o}-linechart-container`})},yi=e=>{const{data:t,xField:n,yField:r}=e,o=m().useMemo((()=>St()),[]);return(0,h.useEffect)((()=>{const e=new Wt.Line(`${o}-linechart-container`,{data:t,xField:n,yField:r,height:350});return e.render(),()=>{e.destroy()}}),[t,n,r]),m().createElement("div",{id:`${o}-linechart-container`})},vi=[{value:"lineChart",label:m().createElement(mi,null)},{value:"columnChart",label:m().createElement(Lt,null)}],bi=e=>{const{statisticProp:t,data:n}=e,r=m().useMemo((()=>{if(!t)return[];const e=n[t][0];return"object"!=typeof e?[]:Object.keys(e)}),[t,n]),o=m().useMemo((()=>{if(!t)return[];const e=n[t][0];return"object"!=typeof e?[]:Object.keys(e)}),[t,n]),[i,a]=Fr({xField:r[0],yField:o[0],chartType:"lineChart"}),s=m().createElement(m().Fragment,null,m().createElement(L.Select,{placeholder:"X轴字段",onChange:e=>{a((t=>{t.xField=e}))},style:{width:"80px"},value:i.xField},r.map((e=>m().createElement(L.Select.Option,{value:e},e)))),m().createElement(L.Select,{placeholder:"Y轴字段",onChange:e=>{a((t=>{t.yField=e}))},style:{width:"80px",marginLeft:"10px"},value:i.yField},o.map((e=>m().createElement(L.Select.Option,{value:e},e)))),m().createElement(L.Select,{value:i.chartType,style:{marginLeft:"10px"},onChange:e=>{a((t=>{t.chartType=e}))}},vi.map((e=>m().createElement(L.Select.Option,{value:e.value},e.label)))));return m().createElement("div",null,m().createElement(L.Card,{title:t,extra:s,style:{marginBottom:"20px",boxShadow:"0 0 2px rgba(0, 0, 0, 0.1)"}},"lineChart"===i.chartType&&m().createElement(yi,{xField:i.xField,yField:i.yField,data:n[t]}),"columnChart"===i.chartType&&m().createElement(gi,{xField:i.xField,yField:i.yField,data:n[t]})))},xi=e=>{const{data:t}=e,[n,r]=Fr({statisticProp:void 0}),o=(0,h.useMemo)((()=>Object.keys(t).filter((e=>t[e]instanceof Array))),[t]);return m().createElement("div",{className:"gi-statistic-panel"},o.map((e=>m().createElement(bi,{statisticProp:e,data:t}))))},Ei=e=>{const{data:t,defaultiStatistic:n,propertyInfos:r}=e,[o,i]=Fr({isStatistic:n});return h.createElement("div",{className:"gi-properties-pannel"},h.createElement("header",{className:"gi-properties-pannel-header"},h.createElement("h3",null,t.id)),o.isStatistic?h.createElement(xi,{data:t}):h.createElement(pi,{data:t,propertyInfos:r}))};var Ii=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{l(r.next(e))}catch(e){i(e)}}function s(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))};const wi="PropertiesPanel",Ci={id:wi,name:"属性面板",desc:"点击节点或边，展示其详情信息",icon:"icon-reconciliation",category:"elements-interaction",cover:"http://xxxx.jpg",type:"AUTO",services:[wi],docs:"https://www.yuque.com/antv/gi/iv9m1b0zq76fa1sg"},Si={info:Ci,component:e=>{const{serviceId:t,hasService:n,placement:r,width:o,title:i,height:a,offset:s,defaultiStatistic:l,enableInfoDetect:u}=e,{graph:d,services:p,GISDK_ID:f,propertyGraphData:h,data:g}=(0,c.useContext)(),y=c.utils.getService(p,t);if(!y)return null;const[v,b]=m().useState({visible:!1,detail:null,isLoading:!1,propertyInfos:[]}),x=()=>{b((e=>e.visible?{visible:!1,isLoading:!1,detail:null,propertyInfos:[]}:e))};m().useLayoutEffect((()=>{const e=e=>Ii(void 0,void 0,void 0,(function*(){b((e=>Object.assign(Object.assign({},e),{visible:!0,isLoading:!0})));const t=e.item.getModel(),n=yield y(Object.assign(Object.assign({},t),{type:"node"}));let r=[];u&&(r=c.utils.getNodePropertyImportance(h,"node",n.id,3,!0)),b((e=>Object.assign(Object.assign({},e),{detail:n,propertyInfos:r,isLoading:!1})))})),t=e=>Ii(void 0,void 0,void 0,(function*(){b((e=>Object.assign(Object.assign({},e),{visible:!0,isLoading:!0})));const t=e.item.getModel(),n=yield y(Object.assign(Object.assign({},t),{type:"edge"}));let r=[];u&&(r=c.utils.getNodePropertyImportance(h,"edge",n.id,3,!0)),b((e=>Object.assign(Object.assign({},e),{detail:n,propertyInfos:r,isLoading:!1})))}));return d.on("node:click",e),d.on("edge:click",t),d.on("canvas:click",x),()=>{d.off("node:click",e),d.off("canvas:click",x),d.off("edge:click",t)}}),[d,b,y,h]);const{isLoading:E,detail:I,propertyInfos:w,visible:C}=v,S=!E&&I?m().createElement(Ei,{data:I,defaultiStatistic:l,propertyInfos:w}):m().createElement(L.Skeleton,{active:!0});return m().createElement(ui,{animate:!0,title:i,visible:C,containerPlacement:r,containerWidth:o,containerHeight:a,onClose:x,offset:s},S)},registerMeta:e=>{const{services:t,engineId:n,hasPropertyGraph:r}=e,{options:o,defaultValue:i}=c.utils.getServiceOptionsByEngineId(t,Ci.services[0],n),a={serviceId:{title:"数据服务",type:"string","x-decorator":"FormItem","x-component":"Select","x-component-props":{options:o},default:i},enableInfoDetect:r?{title:"属性推荐",type:"string","x-decorator":"FormItem","x-component":"Switch",default:!0}:void 0,defaultiStatistic:{title:"默认展示统计信息",type:"string","x-decorator":"FormItem","x-component":"Switch",default:!1},title:{title:"标题",type:"string","x-decorator":"FormItem","x-component":"Input",default:"属性面板"},placement:{title:"展示方位",type:"string","x-decorator":"FormItem","x-component":"Select","x-component-props":{options:[{label:"左部",value:"LB"},{label:"右部",value:"RT"},{label:"上部",value:"LT"},{label:"底部",value:"RB"}]},default:"LB"},width:{title:"宽度",type:"string","x-decorator":"FormItem","x-component":"Input",default:"500px"},height:{title:"高度",type:"string","x-decorator":"FormItem","x-component":"Input",default:"calc(100% - 80px)"},offset:{title:"偏移距离",type:"array","x-decorator":"FormItem","x-component":"Offset",default:[10,10]},animate:{title:"抽屉动画",type:"boolean","x-decorator":"FormItem","x-component":"Switch",default:!1}};return r||delete a.enableInfoDetect,a}},Oi={id:"Save",name:"保存分享",desc:"保存画布,并分享给其他人",icon:"icon-save",cover:"http://xxxx.jpg",category:"workbook",type:"GIAC_CONTENT",services:["Save"],docs:"https://www.yuque.com/antv/gi/kaz51vpwg3oa0i0b"},{deepClone:Ti,GIAC_CONTENT_METAS:Ai}=c.extra,Ni=Ti(Ai);Ni.GIAC_CONTENT.properties.GIAC_CONTENT.properties.title.default=Oi.name,Ni.GIAC_CONTENT.properties.GIAC_CONTENT.properties.icon.default=Oi.icon,Ni.GIAC_CONTENT.properties.GIAC_CONTENT.properties.tooltip.default=Oi.desc;const ki={info:Oi,component:e=>{const{serviceId:t}=e,{graph:n,GISDK_ID:r,config:o,services:i,schemaData:a}=(0,c.useContext)(),[s]=L.Form.useForm(),l=c.utils.getService(i,t);if(!l)return null;const u=n.toDataURL("image/jpeg","#fff");return m().createElement("div",null,m().createElement(L.Form,{form:s,name:"saveStyle",layout:"vertical"},m().createElement(L.Form.Item,{name:"name",label:"名称",rules:[{required:!0,max:50}],extra:"名称由中文、英文或数字组成"},m().createElement(L.Input,{maxLength:50})),m().createElement(L.Form.Item,{name:"description",label:"描述",extra:"描述由中文、英文或数字组成",rules:[{max:160}]},m().createElement(L.Input.TextArea,{row:4,maxLength:200})),m().createElement(L.Form.Item,{name:"cover",label:"缩略图"},m().createElement("img",{src:u,alt:"",width:"100%"})),m().createElement(L.Button,{onClick:()=>{const{name:e,description:t}=s.getFieldsValue(),r=n.save();l({name:e,description:t,data:r,config:o,services:i,schemaData:a,cover:u,gmtCreate:new Date}).then((e=>{e.success&&(L.notification.success({message:"保存成功",description:"3秒后将自动跳转到分享的画布页",duration:3}),setTimeout((()=>{let t=e.data;e.shareId&&(t=window.location.origin+"/#/share/"+e.shareId),window.open(t)}),3e3))}))},type:"primary",style:{width:"100%"}},"保存分享")))},registerMeta:({services:e})=>{const t=c.utils.getServiceOptions(e,Oi.services[0]);return Object.assign({serviceId:{title:"保存服务",type:"string","x-decorator":"FormItem","x-component":"Select","x-component-props":{options:t},default:t[0].value}},Ni)}},_i={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 000 13.8z"}}]},name:"menu-fold",theme:"outlined"};var ji=function(e,t){return h.createElement(bt,le(le({},e),{},{ref:t,icon:_i}))};ji.displayName="MenuFoldOutlined";const Fi=h.forwardRef(ji),Pi={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM142.4 642.1L298.7 519a8.84 8.84 0 000-13.9L142.4 381.9c-5.8-4.6-14.4-.5-14.4 6.9v246.3a8.9 8.9 0 0014.4 7z"}}]},name:"menu-unfold",theme:"outlined"};var Mi=function(e,t){return h.createElement(bt,le(le({},e),{},{ref:t,icon:Pi}))};Mi.displayName="MenuUnfoldOutlined";const Ri=h.forwardRef(Mi),Li=e=>{const{placement:t,offset:n,width:r,height:o,defaultVisible:i}=e,[a,s]=h.useState({visible:"boolean"!=typeof i||i}),l=c.utils.getPositionStyles(t,n),u=Object.assign(Object.assign({},l),{height:o,width:r,padding:"8px",transition:"all 0.3s ease",overflow:"visible"}),d=a.visible?u:Object.assign(Object.assign({},u),{width:"0px",padding:"0"}),{children:p}=e;return h.createElement("div",{style:d},h.createElement(Pr.Z,{type:"LB"===t||"LT"===t?"left":"right",handleClick:()=>{s((e=>({visible:!e.visible})))}}),h.createElement("div",{style:{overflowY:"auto",height:"100%"}},p))},Gi=e=>{const{children:t,width:n,visible:r,GISDK_ID:o,outSideFromCanvas:i,placement:a,height:s}=e,{graph:l}=(0,c.useContext)(),u=m().useRef(null);return m().useEffect((()=>{if(!i)return;const e=document.getElementById("".concat(o,"-graphin-container"));if(e)return e.addEventListener("transitionend",t),()=>{e.removeEventListener("transitionend",t)};function t(t){["right","left","top","bottom"].includes(t.propertyName)&&l.get("canvas")&&(l.changeSize(e.offsetWidth,e.offsetHeight),l.autoPaint())}}),[i]),m().useEffect((()=>{const e=document.getElementById(`${o}-container`),t=document.getElementById(`${o}-graphin-container`),l=u.current;if(!l)return;const c=document.querySelector(".gi-side-tabs .ant-tabs-nav-list");if(e&&l&&t){const o=r?n:`${c.offsetWidth||50}px`,u=r?s:`${c.offsetHeight||350}px`;i?(e.style.position="relative",t.style.position="absolute",t.style.transition="all 0.3s ease",l.style.transition="all 0.3s ease","LB"!==a&&"RT"!==a||(t.style.top="0px",t.style.bottom="0px",t.style.width="unset",l.style.position="absolute",l.style.top="0px",l.style.bottom="0px",l.style.width=o,"LB"===a&&(l.style.left="0px",t.style.left=o,t.style.right="0px"),"RT"===a&&(l.style.right="0px",t.style.left="0px",t.style.right=o)),"RB"!==a&&"LT"!==a||(t.style.right="0px",t.style.left="0px",t.style.height="unset",l.style.position="absolute",l.style.left="0px",l.style.right="0px",l.style.height=u,"LT"===a&&(l.style.top="0px",t.style.top=u,t.style.bottom="0px"),"RB"===a&&(l.style.bottom="0px",t.style.top="0px",t.style.bottom=u))):(e.className="",l.className="",l.style.width="unset",l.style.height="unset",t.style.left="unset",t.style.right="unset",t.style.transition="all 0.3s ease",l.style.transition="all 0.3s ease")}}),[l,r,i,a]),m().useEffect((()=>{const e=u.current,t=document.getElementById(`${o}-graphin-container`);if(e)return()=>{e.style.width="unset",e.style.height="unset",t.style.left="unset",t.style.right="unset",t.style.top="unset",t.style.width="100%",t.style.height="100%",e.style.top="unset",e.style.bottom="unset",e.style.right="unset",e.style.left="unset"}}),[a]),m().createElement("div",{className:"gi-side-tabs-container",ref:u},t)},Di=e=>{const{title:t,isShowTooltip:n,tooltip:r,tooltipPlacement:o,tooltipColor:i,children:a}=e;return n?m().createElement(L.Tooltip,{title:r||t,color:i,placement:o},a):m().createElement(m().Fragment,null,a)},Bi=e=>{const{GIAC_CONTENT:t}=e,{tooltip:n,tooltipColor:r,tooltipPlacement:o,hasDivider:i,isShowTitle:a,title:s,isShowIcon:l,icon:u,isVertical:d,isShowTooltip:p,disabled:f}=t,h={fontSize:"20px",marginRight:d?"0px":"12px"};return m().createElement(m().Fragment,null,m().createElement("div",null,m().createElement(Di,{title:s,tooltip:n,tooltipColor:r,tooltipPlacement:o,isShowTooltip:p},l&&m().createElement(c.Icon,{type:u,style:h}),d&&m().createElement("br",null),a&&s),i&&m().createElement(L.Divider,{type:"vertical"})))},{TabPane:zi}=L.Tabs,$i="side-tabs-default-visible",{deepClone:qi,GI_CONTAINER_METAS:Ui}=c.extra,Vi=qi(Ui);Vi.placement.default="LB",Vi.height.default="400px",Vi.width.default="400px";const Hi={info:{id:"SideTabs",name:"侧边栏",desc:"画布侧边导航栏，可集成分析组件",icon:"icon-sidebar",cover:"http://xxxx.jpg",category:"container-components",type:"GICC",docs:"https://www.yuque.com/antv/gi/to65w8"},component:e=>{const{components:t,assets:n,placement:r,offset:o,width:i,height:a,defaultVisible:s,outSideFromCanvas:l,GISDK_ID:c,tabPosition:u}=e,[d,p]=h.useState((()=>{const e=localStorage.getItem($i);return null===e?s:"true"===e})),f=h.useMemo((()=>t.sort(((e,t)=>e.props.GI_CONTAINER_INDEX-t.props.GI_CONTAINER_INDEX)).filter((e=>e&&e.props&&e.props.GIAC_CONTENT))),[t]),m=h.useMemo((()=>f.map(((e,t)=>{if(!e)return console.warn(`config not found, index: ${t}`),null;const{props:r,id:o}=e,i=n[o];if(!i)return console.warn(`asset: ${o} not found`),null;const{component:a}=i;return h.createElement(zi,{key:t,tab:h.createElement(Bi,Object.assign({},r))},h.createElement(a,Object.assign({},r)))}))),[f]),g=h.createElement(L.Tooltip,{placement:"right",title:"可展开收起导航栏"},h.createElement(L.Button,{type:"text",icon:d?h.createElement(Fi,null):h.createElement(Ri,null),onClick:()=>{p((e=>(localStorage.setItem($i,String(!e)),!e)))}})),y=h.createElement("div",{className:"gi-side-tabs",style:{borderRight:"LB"===r?"1px solid var(--border-color)":"unset",borderLeft:"RT"===r?"1px solid var(--border-color)":"unset",borderBottom:"LT"===r?"1px solid var(--border-color)":"unset",borderTop:"RB"===r?"1px solid var(--border-color)":"unset"}},h.createElement(L.Tabs,{tabPosition:u,tabBarExtraContent:l?g:null},m));return l?$r().createPortal(h.createElement(Gi,{visible:d,width:i,height:a,defaultVisible:s,placement:r,GISDK_ID:c,outSideFromCanvas:l},y),document.getElementById(`${c}-container`)):h.createElement(Li,{width:i,height:a,defaultVisible:s,placement:r,offset:o},y)},registerMeta:e=>{const{GIAC_CONTENT_ITEMS:t=[]}=e;return Object.assign({GI_CONTAINER:{title:"集成组件",type:"string","x-decorator":"FormItem","x-component":"Select","x-component-props":{mode:"multiple"},enum:t,default:[]},outSideFromCanvas:{title:"独立DOM",type:"boolean","x-decorator":"FormItem","x-component":"Switch",default:!0},tabPosition:{title:"导航布局",type:"string","x-decorator":"FormItem","x-component":"Select",enum:[{label:"left",value:"left"},{label:"right",value:"right"},{label:"top",value:"top"},{label:"bottom",value:"bottom"}],default:"left"},defaultVisible:{title:"默认展开",type:"boolean","x-decorator":"FormItem","x-component":"Switch",default:!0}},Vi)}},Wi=(e,t)=>{if(e.getSource().getModel().id!==e.getTarget().getModel().id)return e.getModel().source===t.getModel().id?e.getTarget():e.getSource()},Ki=e=>{const t=e.getEdges(),n=new Set;return t.forEach((t=>{const r=Wi(t,e);if(r){const t=(e=>{const t=e.getEdges(),n=new Set;return t.forEach((t=>{const r=Wi(t,e);r&&n.add(r)})),Array.from(n)})(r);t.find((t=>t.getModel().id!==e.getModel().id))||n.add(r)}})),Array.from(n)},Yi={},Xi=new Set,Qi={info:{id:"ToggleClusterWithMenu",name:"展开/收起",desc:"集成在右键菜单中，展开/收起节点",icon:"icon-toggle",cover:"http://xxx.jpg",category:"elements-interaction",type:"GIAC_MENU",docs:"https://www.yuque.com/antv/gi/wdg1kfpf0y7f77q3"},component:e=>{var t;const{contextmenu:n,isReLayout:r,degree:o,controlledValues:i}=e,{graph:a,updateContext:s,source:l,updateHistory:u}=(0,c.useContext)(),{item:d,id:p,onClose:f}=n,m=(e,t=[])=>{a.updateItem(e,{folded:!1}),t.forEach((e=>{a.showItem(e)}))},g=(e,t=[])=>{t.forEach((e=>{a.hideItem(e)})),Xi.add(p),Yi[p]=t,a.updateItem(e,{folded:!0})},y=()=>{if(r){let e=[];Array.from(Xi).forEach((t=>{const n=a.findById(t);if(n&&n.getModel().folded){const t=n.getModel().id;e=[...e,...Yi[t]]}}));const t=((e,t)=>{const{edges:n,nodes:r}=e,o=n.filter((e=>{const{source:n,target:r}=e;return-1===t.indexOf(n)&&-1===t.indexOf(r)}));return{nodes:r.filter((e=>-1===t.indexOf(e.id))),edges:o}})(l,e);s((e=>{e.data=t}))}},v=(e,t=!0,n)=>{u({componentId:"ToggleClusterWithMenu",type:"configure",subType:"收起/展开",statement:`${"fold"===e.action?"收起":"展开"} ${e.startId}`,success:t,errorMsg:n,params:e})};if(h.useEffect((()=>{if(i){const{startId:e,action:t}=i,n=a.findById(e);if(!n)return void v({startId:e,action:t},!1,"目标节点不存在");const r=Ki(n).map((e=>e.getModel().id));"fold"===t?g(r):m(r),y(),v({startId:e,action:t})}}),[i]),h.useEffect((()=>{if(i){const{startId:e,action:t}=i,n=a.findById(e);if(!n)return void v({startId:e,action:t},!1,"目标节点不存在");const r=Ki(n).map((e=>e.getModel().id));"fold"===t?g(n,r):m(n,r),y(),v({startId:e,action:t})}}),[i]),!d||d.destroyed||"node"!==(null===(t=d.getType)||void 0===t?void 0:t.call(d)))return null;const b=d.getModel();return h.createElement(L.Menu.Item,{key:"toggleClusterWithMenu",onClick:()=>{f();const e=null==d?void 0:d.getModel();if((null==e?void 0:e.id)&&1===o){const t=Ki(d).map((e=>e.getModel().id));let n="fold";e.folded?(n="unfold",m(d,t)):g(d,t),y(),v({startId:e.id,action:n})}}},b.folded?"展开节点":"收起节点")},registerMeta:()=>({isReLayout:{title:"重新布局",type:"boolean","x-decorator":"FormItem","x-component":"Switch",default:!1},degree:{title:"收起节点度数",type:"number","x-decorator":"FormItem","x-component":"NumberPicker","x-component-props":{min:1},default:1}})},Ji={},Zi=e=>{const{children:t,style:n={},direction:r="horizontal"}=e,o="horizontal"===r,i={position:"absolute"};return o?(i.right=0,i.top=0):(i.left=0,i.bottom=0),m().createElement("div",{style:Object.assign(Object.assign(Object.assign({},Ji),i),n),className:"graphin-components-toolbar"},m().createElement("ul",{className:"graphin-components-toolbar-content",style:{display:o?"flex":""}},t))},{getPositionStyles:ea}=c.utils,ta={info:{id:"Toolbar",name:"工具栏",desc:"画布工具栏，可集成画布交互组件",icon:"icon-tools",cover:"http://xxxx.jpg",category:"container-components",type:"GICC",docs:"https://www.yuque.com/antv/gi/gw3nz0u0zikn08uh"},component:e=>{const{direction:t="horizontal",components:n,assets:r,placement:o,offset:i}=e,a=ea(o,i),s=n.sort(((e,t)=>{var n,r;return(null===(n=e.props)||void 0===n?void 0:n.GI_CONTAINER_INDEX)-(null===(r=t.props)||void 0===r?void 0:r.GI_CONTAINER_INDEX)}));return h.createElement(h.Fragment,null,h.createElement(Zi,{direction:t,style:a},s.map((e=>{if(!e)return null;const{props:t,id:n}=e,o=r[n];if(!o)return console.warn(`asset: ${n} not found`),null;const{component:i}=o;return h.createElement("span",{key:n},h.createElement(i,Object.assign({},t)))}))))},registerMeta:e=>{const{GIAC_ITEMS:t=[]}=e;return{GI_CONTAINER:{title:"集成组件",type:"array",enum:t,"x-decorator":"FormItem","x-component":"Select","x-component-props":{mode:"multiple"},default:[]},direction:{title:"展示方向",type:"string","x-decorator":"FormItem"," x-component":"Radio.Group",enum:V,default:"vertical"},placement:{title:"组件位置",type:"string","x-decorator":"FormItem","x-component":"Select","x-component-props":{options:U},default:"LT"},offset:{title:"偏移量",type:"array","x-decorator":"FormItem","x-component":"Offset","x-component-props":{min:0,max:400},default:[24,64]}}}},{Tooltip:na}=p.Components,ra={info:{id:"Tooltip",name:"节点提示框",desc:"Hover 节点，展示其详细信息",cover:"http://xxxx.jpg",category:"elements-interaction",icon:"icon-tooltip",type:"AUTO",docs:"https://www.yuque.com/antv/gi/atogtq0417351bpq"},component:e=>{const{placement:t="top",hasArrow:n=!0,mappingKeys:r=["id"],background:o="#fff",color:i="black",width:a}=e;let s=r;var l;return l=s,"[object Array]"!==Object.prototype.toString.call(l)&&(s=[]),h.createElement(na,{bindType:"node",placement:t,hasArrow:n,style:{background:o,color:i,width:a}},(e=>{const{model:t}=e;return h.createElement("div",null,h.createElement("ul",{className:"tooltip-content"},s.map((e=>{const n=t.data[e];return void 0!==n?h.createElement("li",{key:e},e.toUpperCase()," : ",n):null}))))}))},registerMeta:e=>{const{schemaData:t,keys:n}=e;return{mappingKeys:{title:"文本",type:"string","x-decorator":"FormItem","x-component":"Select","x-component-props":{mode:"multiple",options:n.map((e=>({label:e,value:e})))},default:n},placement:{title:"位置",type:"Select","x-component":"Select","x-decorator":"FormItem","x-component-props":{options:[{value:"left",label:"左侧"},{value:"right",label:"右侧"},{value:"top",label:"上侧"},{value:"bottom",label:"下侧"}]},default:"top"},width:{title:"宽度",type:"string","x-decorator":"FormItem","x-component":"Input",default:"200px"},hasArrow:{title:"箭头",type:"boolean",default:!0,"x-decorator":"FormItem","x-component":"Switch"}}}},{debounce:oa}=c.utils,ia=e=>{const{data:t,xField:n,yField:r,highlight:o,height:i}=e,a=m().useRef(null);return t?((0,h.useEffect)((()=>{if(!a.current)return;const e=new Wt.Column(a.current,{data:t,xField:n,yField:r,height:i,brush:{enabled:!0,type:"x-rect",action:"highlight"},xAxis:{label:{autoRotate:!1}},slider:{start:0,end:1},minColumnWidth:12});return e.render(),e.on(Wt.G2.ELEMENT_RANGE_HIGHLIGHT_EVENTS.AFTER_HIGHLIGHT,oa((e=>{const{highlightElements:t=[]}=e.data,n=t&&t.map((e=>e.getData().id));o(n)}),250)),e.on(Wt.G2.ELEMENT_RANGE_HIGHLIGHT_EVENTS.AFTER_CLEAR,(()=>{})),()=>{e.destroy()}}),[t,n,r,i]),m().createElement("div",{ref:a})):null},{debounce:aa}=c.utils,sa=e=>{const{data:t,xField:n,yField:r,highlight:o}=e,i=m().useRef(null);return t?((0,h.useEffect)((()=>{if(!i.current)return;const e=new Wt.Line(i.current,{data:t,xField:n,yField:r,height:200,interactions:[{type:"brush-x"}],xAxis:{label:{autoRotate:!1}}});return e.render(),()=>{e.destroy()}}),[t,n,r]),m().createElement("div",{ref:i})):null},{highlightEdgeIds:la}=c.utils,ca={boolean:m().createElement(At,{style:{color:"rgb(39, 110, 241)",marginRight:"4px"}}),string:m().createElement(At,{style:{color:"rgb(39, 110, 241)",marginRight:"4px"}}),number:m().createElement(_t,{style:{color:"rgb(255, 192, 67)",marginRight:"4px"}})},ua=[{value:"lineChart",title:"折线图",label:m().createElement(mi,null)},{value:"columnChart",title:"柱状图",label:m().createElement(Lt,null)}],da=e=>{const{schemaData:t,source:n,graph:r,updateContext:o,sourceDataMap:i,transform:a}=(0,c.useContext)(),[s,l]=Fr({dataType:e.dataType||"edges",xField:e.xField,yField:e.yField,chartType:e.chartType,brushMode:e.brushMode}),{chartType:u,dataType:d,xField:p,yField:f,brushMode:g}=s,y=(0,h.useMemo)((()=>t[d].reduce(((e,t)=>Object.assign(Object.assign({},e),t.properties)),{})),[t,d]),v=(0,h.useMemo)((()=>{const e=n[d].map((e=>Object.assign(Object.assign({},e.data),{id:e.id}))).filter((e=>e[p]));try{const t=e[0][p];return isNaN(t)&&!isNaN(Date.parse(t))?e.sort(((e,t)=>new Date(e[p])-new Date(t[p]))):e}catch(t){return e}}),[n,d,p]),b=e=>{if("edges"===d)if("highlight"===g)la(r,e||[]);else{const t=[],r=[];n.edges.forEach((n=>{const{source:o,target:a,id:s}=n;e&&e.includes(s)&&(r.push(n),t.push(i.nodes[o]),t.push(i.nodes[a]))})),o((e=>{e.data=a({nodes:t,edges:r})}))}},x=m().createElement(m().Fragment,null,"  X轴：",m().createElement(L.Select,{placeholder:"X轴字段",onChange:e=>{l((t=>{t.xField=e}))},size:"small",style:{width:"120px",marginRight:"12px"},value:p},Object.keys(y).map((e=>m().createElement(L.Select.Option,{value:e},ca[y[e]],e)))),"Y轴：",m().createElement(L.Select,{placeholder:"Y轴字段",onChange:e=>{l((t=>{t.yField=e}))},size:"small",style:{width:"120px"},value:f},Object.keys(y).map((e=>m().createElement(L.Select.Option,{value:e},ca[y[e]],e)))),m().createElement(L.Select,{size:"small",value:u,style:{width:"120px",marginLeft:"10px"},onChange:e=>{l((t=>{t.chartType=e}))}},ua.map((e=>m().createElement(L.Select.Option,{value:e.value},e.title,e.label)))));return m().createElement("div",null,m().createElement(L.Card,{title:e.title,extra:x,bodyStyle:{padding:"12px 24px 0px 24px"}},"lineChart"===u&&m().createElement(sa,{xField:p,yField:f,data:v,highlight:b,height:e.height}),"columnChart"===u&&m().createElement(ia,{xField:p,yField:f,data:v,highlight:b,height:e.height})))},pa={id:"ChartAnalysis",name:"图表分析",desc:"图中数据通过统计图表展示分析",icon:"icon-barchart",cover:"http://xxxx.jpg",category:"data-analysis",type:"GIAC_CONTENT",docs:"https://www.yuque.com/antv/gi/pfhavf9e96n3n3a2"},{deepClone:fa,GIAC_CONTENT_METAS:ha}=c.extra,ma=fa(ha);ma.GIAC_CONTENT.properties.GIAC_CONTENT.properties.title.default=pa.name,ma.GIAC_CONTENT.properties.GIAC_CONTENT.properties.icon.default=pa.icon,ma.GIAC_CONTENT.properties.GIAC_CONTENT.properties.tooltip.default=pa.desc,ma.GIAC_CONTENT.properties.GIAC_CONTENT.properties.containerWidth.default="400px";const ga={component:e=>{const{chartType:t,height:n,dataType:r,title:o,brushMode:i}=e;return console.log(" props",e),m().createElement("div",null,m().createElement(da,{brushMode:i,title:o,height:n,xField:e[`xField_${r}`],yField:e[`yField_${r}`],chartType:t,dataType:r}))},registerMeta:({schemaData:e})=>{const t=e.nodes.reduce(((e,t)=>Object.assign(Object.assign({},e),t.properties)),{}),n=e.edges.reduce(((e,t)=>Object.assign(Object.assign({},e),t.properties)),{}),r=Object.entries(t).map((e=>{const[t,n]=e;return{label:t,value:t}})),o=Object.entries(n).map((e=>{const[t,n]=e;return{label:t,value:t}}));return Object.assign({title:{title:"图表标题","x-decorator":"FormItem","x-component":"Input",type:"string",default:"未命名图表"},chartType:{title:"图表类型",type:"string","x-decorator":"FormItem","x-component":"Select",enum:[{value:"columnChart",label:"柱状图"},{value:"lineChart",label:"折线图"}],default:"columnChart"},brushMode:{title:"交互模式",type:"string","x-decorator":"FormItem","x-component":"Select",enum:[{value:"highlight",label:"高亮"},{value:"filter",label:"过滤"}],default:"highlight"},height:{title:"图表高度","x-decorator":"FormItem","x-component":"NumberPicker",type:"number",default:void 0},dataType:{title:"数据类型",type:"string","x-decorator":"FormItem","x-component":"Select",enum:[{value:"nodes",label:"节点数据"},{value:"edges",label:"边数据"}],default:"edges","x-reactions":[{target:"xField_nodes",fulfill:{state:{visible:'{{$self.value==="nodes"?true:false }}'}}},{target:"yField_nodes",fulfill:{state:{visible:'{{$self.value==="nodes"?true:false }}'}}},{target:"xField_edges",fulfill:{state:{visible:'{{$self.value==="edges"?true:false }}'}}},{target:"yField_edges",fulfill:{state:{visible:'{{$self.value==="edges"?true:false }}'}}}]},xField_nodes:{title:"X轴字段","x-decorator":"FormItem","x-component":"Select",enum:[...r]},yField_nodes:{title:"Y轴字段","x-decorator":"FormItem","x-component":"Select",enum:[...r]},xField_edges:{title:"X轴字段","x-decorator":"FormItem","x-component":"Select",enum:[...o]},yField_edges:{title:"Y轴字段","x-decorator":"FormItem","x-component":"Select",enum:[...o]}},ma)},info:pa};var ya=u(479);const va={info:{id:"CommonNeighbor",name:"共同邻居",desc:"高亮展示选中节点的共同邻居",icon:"icon-addteam",cover:"http://xxxx.jpg",category:"elements-interaction",type:"GIAC_MENU",docs:"https://www.yuque.com/antv/gi/aomt7zl66pkxoz2g"},component:e=>{const{contextmenu:t,hop:n,controlledValues:r,selectedStatus:o="selected",activeStatus:i="active"}=e,{graph:a,updateHistory:s}=(0,c.useContext)(),l=a.findAllByState("node",o),u=(0,h.useCallback)((()=>{null==t||t.onClose(),d(l)}),[t,a,l]),d=e=>{a.getNodes().forEach((e=>{a.setItemState(e.getID(),i,!1)})),a.getEdges().forEach((e=>{a.setItemState(e.getID(),i,!1)}));const{nodes:t,edges:r}=function(e,t=1){const n=e.map((e=>[{node:e,visited:new Set([e])}]));for(;t>0;){const e=n.length;for(let t=0;t<e;t++){const e=n.shift().reduce(((e,t)=>((0,ya.uniq)(t.node.getNeighbors().filter((e=>!t.visited.has(e)))).forEach((n=>{e.push({node:n,visited:new Set([...Array.from(t.visited),n])})})),e)),[]);if(0===e.length)return{nodes:new Set,edges:new Set};n.push(e)}t--}const r=new Set((0,ya.intersectionWith)(...n,((e,t)=>e.node===t.node)).map((e=>e.node))),o=new Set;return(0,ya.union)(...n).map((e=>{if(r.has(e.node)){let t;e.visited.forEach((e=>{t?(t.getEdges().forEach((t=>{t.getTarget()!==e&&t.getSource()!==e||o.add(t)})),t=e):t=e}))}})),{nodes:r,edges:o}}(e,n);if(t.size<1)return L.message.warn("没有发现共同邻居！"),void p(e.map((e=>e.getID())),!1,"没有发现共同邻居！");r.forEach((e=>{a.setItemState(e.getID(),i,!0)})),t.forEach((e=>{a.setItemState(e.getID(),i,!0)})),p(e.map((e=>e.getID())))},p=(e,t=!0,n)=>{s({componentId:"CommonNeighbor",type:"configure",subType:"共同邻居",statement:`${e.join(", ")} 的共同邻居`,success:t,errorMsg:n,params:{startIds:e}})};return h.useEffect((()=>{if(r){const{startIds:e}=r,t=e.map((e=>a.findById(e)));if(!t.length)return void p(e,!1,"当前画布未找到相关节点");d(t)}}),[r]),h.createElement(L.Menu.Item,{disabled:l.length<2,key:"common-neighbor",eventKey:"common-neighbor",onClick:u},n>1?`共同邻居(${n}跳)`:"共同邻居")},registerMeta:()=>({hop:{title:"跳数",type:"number","x-decorator":"FormItem","x-component":"NumberPicker","x-component-props":{min:1},default:1}})},ba=(e,t,n,r)=>{const{x:o,y:i,dragNodeMass:a,isForce:s}=r||{},l=e.getModel();try{if("graphin-circle"!==l.type)return;const r=l.style||{badges:[]},{keyshape:u,icon:d}=r,p=[...r.badges],f=p.findIndex((({value:e})=>e===c.icons.pushpin));if(p.splice(f,1),p.push({position:"LB",fontFamily:"iconfont",type:"font",value:c.icons.pushpin,size:[15,15],color:u.fill,fill:d.fill,stroke:u.fill}),t.updateItem(e,{pinned:!0,mass:a,style:{badges:p}}),s){const r=e.get("model"),s=o&&i&&{x:o,y:i};n([Object.assign(Object.assign(Object.assign({},r),s),{pinned:!0,forceMass:a,mass:a,layout:{force:Object.assign(Object.assign({},r.force),{mass:a})}})],t)}}catch(e){console.log("error",e)}},{GIAComponent:xa,deepClone:Ea}=c.extra,Ia={id:"ForceSimulation",name:"力导控制器",desc:"可以停止/重启力导布局",icon:"icon-play-circle",cover:"http://xxxx.jpg",category:"system-interaction",type:"GIAC",docs:"https://www.yuque.com/antv/gi/oeunl5g60zkimsqw"},{deepClone:wa,GIAC_METAS:Ca}=c.extra,Sa=wa(Ca);Sa.GIAC.properties.GIAC.properties.title.default=Ia.name,Sa.GIAC.properties.GIAC.properties.icon.default=Ia.icon,Sa.GIAC.properties.GIAC.properties.isShowTitle.default=!1,Sa.GIAC.properties.GIAC.properties.tooltipPlacement.default="right";const Oa={info:Ia,component:e=>{const t=Ea(e.GIAC),{graph:n,layoutInstance:r,layout:o,restartForceSimulation:i,stopForceSimulation:a}=(0,c.useContext)(),s="graphin-force"===o.type||"force2"===o.type,{autoPin:l,dragNodeMass:u=1e10}=e;return m().useEffect((()=>{const e=()=>{s&&a()},t=e=>{s&&l&&e.item&&ba(e.item,n,i,{dragNodeMass:u,x:e.x,y:e.y,isForce:s})};return n.on("node:dragstart",e),n.on("node:dragend",t),n.on("canvas:click",e),()=>{n.off("node:dragstart",e),n.off("node:dragend",t),n.off("canvas:click",e)}}),[n,l,s,r,i]),t.icon="icon-play-circle",t.disabled=!0,t.tooltip="该功能仅在力导布局下才可使用",s&&(t.disabled=!1,t.tooltip="重启力导布局，点击画布可以暂停力导"),m().createElement(xa,{GIAC:t,onClick:()=>{s&&i([])}})},registerMeta:()=>Object.assign({autoPin:{title:"固定拖拽后的节点",type:"boolean","x-component":"Switch","x-decorator":"FormItem",default:!0},dragNodeMass:{title:"固定的质量","x-component":"NumberPicker","x-decorator":"FormItem",type:"number",default:1e10}},Sa)},Ta=e=>{const{title:t,content:n,height:r,disabled:o,loading:i,showTitle:a=!0,active:s}=e,l={};return["string","number"].includes(typeof r)&&(l.height=r),!0===o&&Object.assign(l,{color:"#a49b9b",cursor:"not-allowed"}),m().createElement("div",{className:"gi-assets-operator-item "+(s?"gi-assets-operator-item-active":""),style:l,onClick:t=>{!o&&e.onClick&&e.onClick(t)}},m().createElement("div",{className:"gi-assets-operator-item-content",onClick:t=>{!o&&e.onContentClick&&e.onContentClick(t)}},n),a?m().createElement("div",{className:"gi-assets-operator-item-title",onClick:t=>{!o&&e.onTitleClick&&e.onTitleClick(t)}},t):null,i?m().createElement(L.Spin,{className:"gi-assets-operator-item-loading",size:"small",spinning:!0}):null)};const Aa=e=>e.children,Na=e=>{const{Comp:t,$id:n}=e,r=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}(e,["Comp","$id"]),{GIAC_CONTENT:o}=r,i=ja(),{title:a,icon:s,disabled:l,containerWidth:u=450,isShowTitle:d=!0}=o,[p,f]=m().useState(!1),{isSideContent:h}=i||{},g=!!h&&i.activeItem===n;return m().createElement(Aa,{key:r.key},m().createElement(Ta,{disabled:l,showTitle:d,active:g,title:a,content:m().createElement(c.Icon,{type:s}),onClick:()=>{h?(null==i?void 0:i.activeItem)===n?null==i||i.closeItem(n):null==i||i.openItem(n):f(!0)}}),(()=>{const{contentContainer:e,activeItem:o="",isSideContent:s}=i||{};if(!s)return m().createElement(L.Drawer,{open:p,title:a,placement:"right",width:u,onClose:()=>{s?null==i||i.closeItem(n):f(!1)}},m().createElement(t,Object.assign({},r)));if(!e)return null;const l=o===n?m().createElement("div",{style:{width:u}},m().createElement(t,Object.assign({},r))):null;return $r().createPortal(l,e)})())},ka={isSideContent:!1,openItem(){},closeItem(){}},_a=m().createContext(ka),ja=()=>m().useContext(_a),Fa=e=>{const{vertical:t,items:n=[],className:r,style:o,wrapperStyle:i,isSideContent:a=!1}=e,s=(0,c.useContext)(),{config:l,assets:u}=s,d=m().useRef(),p=m().useMemo((()=>(null==l?void 0:l.components)?l.components.reduce(((e,t)=>(e[t.id]=t,e)),{}):{}),[null==l?void 0:l.components]),f=u.components||{},[h,g]=Fr(Object.assign({},ka)),y=m().useRef(null);m().useLayoutEffect((()=>{g((e=>{e.isSideContent=a}))}),[a]),m().useLayoutEffect((()=>{g((e=>{e.openItem=e=>{clearTimeout(d.current),g((t=>{t.closePending=!1,t.activeItem=e}))},e.closeItem=e=>{g((e=>{e.closePending=!0})),clearTimeout(d.current),d.current=setTimeout((()=>{g((t=>{t.closePending=!0,e&&t.activeItem!==e||(t.activeItem="")}))}),400)},e.contentContainer=y.current}))}),[y]);const v=Object.assign(Object.assign({width:"100%",height:"100%"},o),{display:"flex",flexDirection:t?"column":"row"}),b=!h.closePending&&h.activeItem,x={float:"left",maxWidth:b?"100vw":0,borderWidth:b?1:0},E={};return t?(E.height="100%",x.height="100%"):(x.width="100%",E.width="100%"),m().createElement(_a.Provider,{value:h},m().createElement("div",{className:"gi-group-container-wrapper",style:i},m().createElement("div",{className:`gi-group-container ${r||""}`,style:v,"data-vertical":String(!!t)},n.map(((e,n)=>{var r;const o={flex:1,background:e.background,color:e.color,flexDirection:t?"column":"row"};if(t){const t=e;o.width="100%",t.height&&(o.height=t.height,delete o.flex)}else{const t=e;o.height="100%",t.width&&(o.width=t.width,delete o.flex)}e.align&&(o.justifyContent=e.align);const i=e.drivers,a=null==i?void 0:i.map(((e,n)=>{const r=(null==e?void 0:e.size)||1,i="Start"===(null==e?void 0:e.position);t?i?o.paddingTop=r:o.paddingBottom=r:i?o.paddingLeft=r:o.paddingRight=r;let a={width:r,top:e.start||0,bottom:e.end||0};return t&&(a={height:r,left:e.start||0,right:e.end||0}),a.backgroundColor=e.color,t?i?a.top=0:a.bottom=0:i?a.left=0:a.right=0,m().createElement("i",{key:`driver_${n}`,className:"gi-group-container-driver",style:a})}));return m().createElement("div",{className:"gi-group-container-item",key:n,style:o},null===(r=e.components)||void 0===r?void 0:r.map(((e,t)=>{var n;const r=f[e];if(!r)return console.warn(`asset: ${e} not found`),null;const o=r.component,i=null===(n=null==p?void 0:p[e])||void 0===n?void 0:n.props;return(null==i?void 0:i.GIAC_CONTENT)?((e,t)=>m().createElement(Na,Object.assign({Comp:e},t)))(o,Object.assign({key:t,$id:e},i)):m().createElement(o,Object.assign({key:t},i))})),a)}))),m().createElement("div",{className:"gi-group-container-side-content",style:x},m().createElement("div",{style:E,ref:y}))))};let Pa=1;const Ma=h.memo((e=>{const{groups:t=[],size:n=60,position:r="Top",left:o,right:i,top:a,bottom:s,className:l,style:u,background:d,suspend:p}=e,f=(0,c.useContext)(),{GISDK_ID:m}=f,g=`${m}-container`,y=document.getElementById(g),v=`gi-group-bar ${l||""}`,b=h.useRef(null),[x]=h.useState((()=>"with-group-bar-"+Pa++));h.useLayoutEffect((()=>{if(p)return;let e=`padding-top:${n}px`;"Bottom"===r?e=`padding-bottom:${n}px`:"Left"===r?e=`padding-left:${n}px`:"Right"===r&&(e=`padding-right:${n}px`);const t=`\n    [${x}]{\n      position:relative !important;\n      ${e}\n    }\n    `;return y.setAttribute(x,""),b.current&&(b.current.textContent=t),()=>{y.removeAttribute(x)}}),[r,n,p]);const E={},I="Left"===r||"Right"===r;I?(E.flexDirection="column",E.width=n,E.top=a||0,E.bottom=s||0,"Left"===r?E.left=0:E.right=0):(E.flexDirection="row",E.height=n,E.left=o||0,E.right=i||0,"Top"===r?E.top=0:E.bottom=0);const w={background:d};return I?w.width=n:w.height=n,$r().createPortal(h.createElement("div",{className:v,style:Object.assign(Object.assign({},E),u)},h.createElement("style",{type:"text/css",ref:b}),h.createElement(Fa,{vertical:I,items:t,style:w})),y)})),Ra={type:"array","x-component":"ArrayItems","x-component-props":{},items:{type:"void","x-decorator":"FormItem","x-component":"FormCollapse","x-component-props":{className:"gi-assets-elements-advance-panel",ghost:!0},properties:{config:{type:"object","x-component":"FormCollapse.CollapsePanel","x-component-props":{header:"分割线配置"},properties:{remove:{"x-component":"ArrayItems.Remove","x-component-props":{style:{position:"absolute",right:14,top:15}}},position:{title:"位置","x-decorator":"FormItem","x-component":"Select","x-component-props":{mode:"single"},default:"End",enum:[{label:"开始",value:"Start"},{label:"结尾",value:"End"}]},start:{title:"起始边距","x-decorator":"FormItem","x-component":"NumberPicker",default:0},end:{title:"结束边距","x-decorator":"FormItem","x-component":"NumberPicker",default:0},color:{title:"颜色","x-decorator":"FormItem","x-component":"ColorInput",default:"#eee"},size:{title:"线宽","x-decorator":"FormItem","x-component":"NumberPicker",default:1}}}}},properties:{addGroup:{type:"void","x-component":"ArrayItems.Addition",title:"添加分割线"}}},La=({GIAC_ITEMS:e=[],GIAC_CONTENT_ITEMS:t=[]})=>({title:"分组",type:"array","x-component":"ArrayCollapse","x-component-props":{},enum:[...e,...t],default:[{components:[]}],properties:{addGroup:{type:"void","x-component":"ArrayCollapse.Addition",title:"添加分组"}},items:{type:"object",title:"分组配置","x-component-props":{style:{margin:"1px !important"}},properties:{remove:{"x-component":"ArrayCollapse.Remove"},components:{type:"array",title:"集成组件",enum:[...e,...t],"x-decorator":"FormItem","x-component":"Select","x-component-props":{mode:"multiple"},default:[]},width:{title:"宽度",type:"string","x-decorator":"FormItem","x-component":"Input","x-component-props":{placeholder:"字符串或数字类型"},default:"auto"},height:{title:"高度",type:"string","x-decorator":"FormItem","x-component":"Input","x-component-props":{placeholder:"字符串或数字类型"}},background:{title:"背景色",type:"string","x-decorator":"FormItem","x-component":"ColorInput"},color:{title:"文字颜色",type:"string","x-decorator":"FormItem","x-component":"ColorInput",default:"#000"},align:{title:"对齐方式","x-decorator":"FormItem","x-component":"Select","x-component-props":{mode:"single"},default:"Left",enum:[{label:"左对齐",value:"Left"},{label:"居中对齐",value:"Center"},{label:"右对齐",value:"Right"}]},drivers:Ra}}}),Ga={info:{id:"GroupBar",name:"分组操作栏",desc:"分组操作栏,分组形式集成资产",icon:"icon-tabs",cover:"http://xxxx.jpg",category:"container-components",type:"GICC"},component:Ma,registerMeta:e=>{const{GIAC_ITEMS:t=[],GIAC_CONTENT_ITEMS:n=[]}=e;return{GI_CONTAINER:{title:"集成组件",type:"array",enum:[...t,...n],"x-decorator":"FormItem","x-component":"Select","x-component-props":{mode:"multiple"},default:[]},background:{title:"背景色",type:"string","x-decorator":"FormItem","x-component":"ColorInput"},suspend:{title:"悬浮",type:"boolean","x-decorator":"FormItem","x-component":"Switch",default:!1},position:{title:"位置",type:"string","x-decorator":"FormItem","x-component":"Select",default:"Top",enum:[{label:"顶部",value:"Top"},{label:"底部",value:"Bottom"},{label:"左侧",value:"Left"},{label:"右侧",value:"Right"}]},size:{title:"大小",type:"number","x-decorator":"FormItem","x-component":"NumberPicker",default:60},left:{title:"Left",type:"string","x-decorator":"FormItem","x-component":"Input","x-reactions":{dependencies:[".position"],fulfill:{schema:{"x-visible":"{{$deps[0] === 'Top' || $deps[0] === 'Bottom'}}"}}}},right:{title:"Right",type:"string","x-decorator":"FormItem","x-component":"Input","x-reactions":{dependencies:[".position"],fulfill:{schema:{"x-visible":"{{$deps[0] === 'Top' || $deps[0] === 'Bottom'}}"}}}},top:{title:"Top",type:"string","x-decorator":"FormItem","x-component":"Input","x-reactions":{dependencies:[".position"],fulfill:{schema:{"x-visible":"{{$deps[0] === 'Left' || $deps[0] === 'Right'}}"}}}},bottom:{title:"Bottom",type:"string","x-decorator":"FormItem","x-component":"Input","x-reactions":{dependencies:[".position"],fulfill:{schema:{"x-visible":"{{$deps[0] === 'Left' || $deps[0] === 'Right'}}"}}}},groups:La(e)}}},{isPosition:Da,isStyles:Ba}=c.utils,za={id:"Initializer",name:"初始化器",desc:"必选！初始化查询图数据与图模型",cover:"http://xxxx.jpg",category:"system-interaction",type:"INITIALIZER",services:["GI_SERVICE_INTIAL_GRAPH","GI_SERVICE_SCHEMA"],docs:"https://www.yuque.com/antv/gi/eedyuy"},$a={info:za,component:e=>{const t=(0,c.useContext)(),{serviceId:n,schemaServiceId:r,aggregate:o}=e,{services:i,updateContext:a,transform:s,largeGraphLimit:l}=t;return h.useEffect((()=>{let e=i.find((e=>e.id===n)),t=i.find((e=>e.id===r));e||(L.notification.error({message:"画布渲染失败",description:`缺少 ${n} 服务，请检查相关资产是否加载成功`}),e={service:()=>new Promise((e=>{e({nodes:[],edges:[]})}))}),t||(L.notification.error({message:"图模型获取失败",description:`缺少 ${n} 服务，请检查相关资产是否加载成功`}),t={service:()=>new Promise((e=>{e({nodes:[],edges:[]})}))}),a((e=>{e.isLoading=!0})),Promise.all([t.service(),e.service()]).then((([e,t={nodes:[],edges:[]}])=>{const{nodes:n}=t;n.length>l&&L.notification.warn({message:"加载的数据量过大",description:"建议聚合数据，默认切换到网格布局。您也可以在「资产中心」中加载「大图组件」启用 3D 渲染"}),a((r=>{var i,a;const u=Da(n),d=Ba(n);if(r.initialized=!0,r.layoutCache=!1,e&&(r.schemaData=e),e&&(0===(null===(i=r.config.nodes)||void 0===i?void 0:i.length)||0===(null===(a=r.config.edges)||void 0===a?void 0:a.length))){const t=c.utils.generatorStyleConfigBySchema(e);r.config.nodes=t.nodes,r.config.edges=t.edges}if(u&&(r.layout.type="preset"),d)return r.data=t,r.source=t,void(r.isLoading=!1);if(n.length>l){const e=s(t,!0);return r.largeGraphMode=!0,r.largeGraphData=e,r.source=e,r.data={nodes:[],edges:[]},void(r.isLoading=!1)}if(o){const e=s(t,!0);return r.rawData=Object.assign({},t),r.source=e,r.largeGraphMode=!1,r.largeGraphData=void 0,r.data=s(c.utils.aggregateEdges(t),!0),void(r.isLoading=!1)}const p=s(t,!0);r.rawData=Object.assign({},t),r.data=p,r.source=p,r.largeGraphMode=!1,r.largeGraphData=void 0,r.isLoading=!1}))}))}),[l,o]),null},registerMeta:e=>{const{services:t,engineId:n}=e,{options:r,defaultValue:o}=c.utils.getServiceOptionsByEngineId(t,za.services[0],n),{options:i,defaultValue:a}=c.utils.getServiceOptionsByEngineId(t,za.services[1],n);return{serviceId:{title:"初始化查询",type:"string","x-decorator":"FormItem","x-component":"Select","x-component-props":{options:r},default:o},schemaServiceId:{title:"查询图模型",type:"string","x-decorator":"FormItem","x-component":"Select","x-component-props":{options:i},default:a},GI_INITIALIZER:{title:"默认启动",type:"boolean","x-decorator":"FormItem","x-component":"Switch","x-component-props":{disabled:!0},default:!0},aggregate:{title:"汇总边",type:"string","x-decorator":"FormItem","x-component":"Switch",default:!1}}}},qa=new class{constructor(){this.listener={}}on(e,t){this.listener[e]||(this.listener[e]=[]),this.listener[e].push(t)}off(e,t){let n=this.listener[e];if(!n)return!1;if(t){let e;for(let r=0,o=n.length;r<o;r++)if(e=n[r],e==t||e.fn==t){n.splice(r,1);break}}else n&&(n.length=0)}once(e,t){let n=()=>{this.off(e,n),t.apply(this,arguments)};n.fn=t,this.on(e,n)}emit(e,t){const n=this.listener[e];n&&n.forEach((e=>{e(t)}))}},Ua={LT:"top",LB:"left",RT:"right",RB:"bottom"},Va=e=>{const{title:t,isShowTooltip:n,tooltip:r,tooltipPlacement:o,tooltipColor:i,children:a}=e;return n?m().createElement(L.Tooltip,{title:r||t,color:i,placement:o},a):m().createElement(m().Fragment,null,a)},Ha=e=>{const{containerType:t="drawer",containerWidth:n="600px",containerHeight:r="calc(100vh-64px)",containerMask:o=!1,containerMaskClosable:i=!1,containerPlacement:a,children:s,visible:l,offset:c,onClose:u,title:d,GISDK_ID:p,getContainer:f,containerAnimate:h}=e,g=Ua[a],[y,v]=c||[0,0];return"drawer"==t?m().createElement(L.Drawer,{className:"gi-operator-header-drawer",title:d,mask:o,maskClosable:i,placement:g,width:n,getContainer:f,visible:l,onClose:u,drawerStyle:{height:r},style:{height:r,top:v,[g]:y}},s):"modal"==t?m().createElement(L.Modal,{getContainer:f,className:"gi-operator-header-modal",title:d,width:n,visible:l,onCancel:u},s):m().createElement(ui,{visible:l,onClose:u,title:d,containerHeight:r,containerWidth:n,offset:c,containerPlacement:a,animate:h},s)};const{deepClone:Wa,GI_CONTAINER_METAS:Ka}=c.extra,Ya=Wa(Ka);Ya.height.default="fit-content",Ya.width.default="100%",Ya.offset.default=[0,0],Ya.placement.default="LT";const Xa={info:{id:"OperatorBar",name:"操作栏",desc:"业务操作栏，可集成众多分析组件",icon:"icon-tabs",cover:"http://xxxx.jpg",category:"container-components",type:"GICC",docs:"https://www.yuque.com/antv/gi/egap0htkd75mo950"},component:e=>{const{assets:t,GISDK_ID:n,placement:r,offset:o,height:i,width:a}=e,s=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}(e,["assets","GISDK_ID","placement","offset","height","width"]),l=JSON.stringify(s),u=h.useMemo((()=>{const{components:r}=e,o=((e,t,n)=>e.sort(((e,t)=>{var n,r;return(null===(n=e.props)||void 0===n?void 0:n.GI_CONTAINER_INDEX)-(null===(r=t.props)||void 0===r?void 0:r.GI_CONTAINER_INDEX)})).map((e=>{if(!e)return console.warn("component config not found"),null;const{props:r,id:o}=e;if(!t[o])return console.warn(`asset: ${o} not found`),null;const{component:i}=t[o];let a=i;return r.GIAC_CONTENT&&(a=((e,t,n)=>r=>{const{GIAC_CONTENT:o}=r,{visible:i,tooltip:a,tooltipColor:s,tooltipPlacement:l,hasDivider:u,offset:d,isShowTitle:p,title:f,isShowIcon:h,icon:g,isVertical:y,isShowTooltip:v,disabled:b,containerType:x="drawer",containerWidth:E="600px",containerHeight:I="calc(100vh-64px)",containerMask:w=!1,containerMaskClosable:C=!1,containerPlacement:S,containerAnimate:O}=o,[T,A]=m().useState(i);m().useEffect((()=>{const e=({visible:e,id:n})=>{A(n===t&&e)};return qa.on(`${n}_GIAC_CONTENT:CLICK`,e),()=>{qa.off(`${n}_GIAC_CONTENT:CLICK`,e)}}),[]);const N=()=>{A(!1)},k=document.getElementById(`${n}-graphin-container`);return m().createElement(m().Fragment,null,m().createElement("div",null,m().createElement(Va,{title:f,tooltip:a,tooltipColor:s,tooltipPlacement:l,isShowTooltip:v},m().createElement(L.Button,{type:"text",style:y?{height:"60px"}:{},onClick:()=>{qa.emit(`${n}_GIAC_CONTENT:CLICK`,{visible:!T,id:t})},disabled:b},h&&m().createElement(c.Icon,{type:g}),y&&m().createElement("br",null),p&&f)),u&&m().createElement(L.Divider,{type:"vertical"})),$r().createPortal(m().createElement(Ha,{title:f,containerType:x,containerWidth:E,containerHeight:I,containerMask:w,containerMaskClosable:C,containerPlacement:S,visible:T,onClose:N,offset:d,GISDK_ID:n,getContainer:k,containerAnimate:O},m().createElement(e,Object.assign({},r,{visible:T,onClose:N,onOpen:()=>{A(!0)}}))),k))})(i,o,n)),h.createElement("div",{key:o},h.createElement(a,Object.assign({},r)))})).filter((e=>null!==e)))(r,t,n);return o}),[l]),d="LT"===r||"LB"===r,p="LT"===r||"RT"===r;return h.createElement("div",{className:"gi-operator-bar",style:{top:p?"0px":"unset",bottom:p?"unset":"0px",right:d?"unset":"0px",left:d?"0px":"unset",textAlign:d?"left":"right",marginLeft:d?o[0]:"unset",marginRight:d?"unset":o[0],marginTop:p?o[1]:"unset",marginBottom:p?"unset":o[1],width:a||"100%",height:i||"fit-content"}},h.createElement(L.Space,null,u))},registerMeta:e=>{const{GIAC_CONTENT_ITEMS:t=[],GIAC_ITEMS:n=[]}=e,r=n.map((e=>Object.assign(Object.assign({},e),{label:e.label+" (建议集成在工具栏) "})));return Object.assign({GI_CONTAINER:{title:"集成组件",type:"string","x-decorator":"FormItem","x-component":"Select","x-component-props":{mode:"multiple"},enum:[...t,...r],default:[]}},Ya)}},Qa={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M854.6 288.6L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0042 42h216v494zM514.1 580.1l-61.8-102.4c-2.2-3.6-6.1-5.8-10.3-5.8h-38.4c-2.3 0-4.5.6-6.4 1.9-5.6 3.5-7.3 10.9-3.7 16.6l82.3 130.4-83.4 132.8a12.04 12.04 0 0010.2 18.4h34.5c4.2 0 8-2.2 10.2-5.7L510 664.8l62.3 101.4c2.2 3.6 6.1 5.7 10.2 5.7H620c2.3 0 4.5-.7 6.5-1.9 5.6-3.6 7.2-11 3.6-16.6l-84-130.4 85.3-132.5a12.04 12.04 0 00-10.1-18.5h-35.7c-4.2 0-8.1 2.2-10.3 5.8l-61.2 102.3z"}}]},name:"file-excel",theme:"outlined"};var Ja=function(e,t){return h.createElement(bt,le(le({},e),{},{ref:t,icon:Qa}))};Ja.displayName="FileExcelOutlined";const Za=h.forwardRef(Ja);var es=u(84);const ts=(e,t="未命名")=>{const n=new es.Parser({delimiter:",",withBOM:!0}).parse(e),r=document.createElement("a");r.href="data:text/csv;charset=utf-8,"+encodeURI(`${n}`),r.download=`${t}.csv`,r.click()},ns=e=>{const{filterOptions:t,filterLogic:n}=e,{data:r}=(0,c.useContext)(),{nodes:o,edges:i}=r;if(!o)return null;const a=Object.values(t),s=h.createElement(L.List,{size:"small",bordered:!0,dataSource:a,renderItem:(e,t)=>{var n,r,o;const i=null===(n=e.elementType)||void 0===n?void 0:n.toUpperCase(),a="NODE"===i?"green":"blue";let s=e.selectValue;if("DATE"===e.analyzerType&&(s=null===(r=e.range)||void 0===r?void 0:r.join(" ~ ")),"HISTOGRAM"===e.analyzerType){const t=null===(o=e.range)||void 0===o?void 0:o.map((e=>e.join("~")));s=null==t?void 0:t.join(" 或 ")}return h.createElement(L.List.Item,{style:{maxWidth:"500px",overflow:"hidden",overflowWrap:"anywhere"}},h.createElement(L.Tag,{color:a},i," RULE "),e.prop," 为 ",s)}});return h.createElement("div",null,h.createElement(L.Row,{style:{padding:"12px"}},h.createElement(L.Col,{span:8},h.createElement("div",{className:"ant-statistic"},h.createElement("div",{className:"ant-statistic-title"},"数据操作"),h.createElement("div",{className:"ant-statistic-content"},h.createElement("span",{className:"ant-statistic-content-value"},h.createElement(L.Tooltip,{placement:"topLeft",title:"下载数据"},h.createElement(L.Button,{type:"text",icon:h.createElement(Za,null),onClick:()=>{const e=r.nodes.map((e=>e.data)),t=r.edges.map((e=>e.data));e.length>0&&ts(e,"nodes"),t.length>0&&ts(t,"edges")}})),h.createElement(L.Popover,{content:s,title:`当前筛选逻辑：${n.toUpperCase()}，筛选条件如下：`,trigger:"hover"},h.createElement(L.Button,{type:"text",icon:h.createElement(wo,null),onClick:()=>{}})))))),h.createElement(L.Col,{span:8},h.createElement(L.Statistic,{title:"当前节点",value:o.length})),h.createElement(L.Col,{span:8},h.createElement(L.Statistic,{title:"当前边",value:i.length}))))},{isStyles:rs}=c.utils,os=e=>{const{isFilterIsolatedNodes:t,limit:n,filterLogic:r}=e,[o,i]=(0,h.useState)({}),{updateContext:a,transform:s,schemaData:l,largeGraphData:u}=(0,c.useContext)(),d=l,[p,f]=m().useState({data:{nodes:[],edges:[]}}),g=(0,h.useMemo)((()=>d.nodes.reduce(((e,t)=>Object.assign(Object.assign({},e),t.properties)),{})),[d]),y=(0,h.useMemo)((()=>d.edges.reduce(((e,t)=>Object.assign(Object.assign({},e),t.properties)),{})),[d]),v=(e,t)=>{i((n=>Object.assign(Object.assign({},n),{[e]:t})))},b=e=>{delete o[e],i(Object.assign({},o))};return(0,h.useEffect)((()=>{if(!u)return;let e,i=u;if("and"===r)Object.values(o).map((e=>{i=on(i,e,t)}));else{const e={nodes:[],edges:[]};Object.values(o).map((n=>{const{isFilterReady:r,analyzerType:o}=n;let i;i=r&&"NONE"!==o?on(u,n,t):{nodes:[],edges:[]},e.nodes=[...e.nodes,...i.nodes],e.edges=[...e.edges,...i.edges]})),i={nodes:c.utils.uniqueElementsBy(e.nodes,((e,t)=>e.id===t.id)),edges:c.utils.uniqueElementsBy(e.edges,((e,t)=>e.id&&t.id?e.id===t.id:`${e.source}_${e.target}_${e.edgeType}`==`${t.source}_${t.target}_${t.edgeType}`))}}e=i,i.nodes.length>n&&(e={nodes:[],edges:[]}),a((t=>{u&&rs(u.nodes)?(t.data=e,t.source=e):(t.data=s(e),t.source=s(e)),t.layoutCache=!0}))}),[o]),m().createElement("div",{className:"gi-filter-panel"},m().createElement(ns,{filterOptions:o,filterLogic:r}),m().createElement(L.Button,{type:"primary",style:{width:"100%",borderRadius:"4px"},onClick:()=>{const e=St(),t={id:e,isFilterReady:!1};i((n=>Object.assign(Object.assign({},n),{[e]:t})))},icon:m().createElement(Et,null)},"增加筛选器"),m().createElement("div",{className:"gi-filter-panel-criteria-container"},Object.values(o).map((e=>m().createElement("div",null,m().createElement(cn,{source:u,filterCriteria:e,nodeProperties:g,edgeProperties:y,updateFilterCriteria:v,removeFilterCriteria:b}))))))},is={id:"Overview",name:"大图概览",desc:"大图概览",icon:"icon-dashboard",cover:"http://xxxx.jpg",category:"system-interaction",type:"GIAC_CONTENT",docs:"https://www.yuque.com/antv/gi/vwybfglsys8dv5gs"},{deepClone:as,GIAC_CONTENT_METAS:ss}=c.extra,ls=as(ss);ls.GIAC_CONTENT.properties.GIAC_CONTENT.properties.title.default=is.name,ls.GIAC_CONTENT.properties.GIAC_CONTENT.properties.icon.default=is.icon,ls.GIAC_CONTENT.properties.GIAC_CONTENT.properties.containerWidth.default="400px";const cs={info:is,component:e=>{const{limit:t,filterLogic:n}=e,r=(0,c.useContext)(),[o,i]=h.useState({visible:!1}),{source:a,updateContext:s,largeGraphData:l}=r,{visible:u}=o;h.useEffect((()=>{s((e=>{e.largeGraphLimit=t}))}),[t]);const d=`为了画布渲染性能 与 用户高效分析，对超过 ${t} 节点做了展示限制展示，可在属性面板中自定义。您可以通过下方的筛选面板，根据统计分析结果选择展示`,p=l||a;return h.createElement("div",null,h.createElement(L.Row,{style:{padding:"12px"}},h.createElement(L.Col,{span:8},h.createElement(L.Statistic,{title:"展示限制",value:t})),h.createElement(L.Col,{span:8},h.createElement(L.Statistic,{title:"载入节点数",value:p.nodes.length})),h.createElement(L.Col,{span:8},h.createElement(L.Statistic,{title:"载入边数",value:p.edges.length}))),h.createElement(L.Alert,{message:d,type:"info"}),l&&h.createElement(os,{isFilterIsolatedNodes:!0,highlightMode:!0,limit:t,filterLogic:n}))},registerMeta:()=>Object.assign({limit:{title:"限制展示数量（节点）",type:"string","x-decorator":"FormItem","x-component":"NumberPicker",default:600},filterLogic:{title:"筛选逻辑",type:"string","x-decorator":"FormItem","x-component":"Select",enum:[{value:"and",label:"and"},{value:"or",label:"or"}],default:"and"}},ls)},us={info:{id:"PinNodeWithMenu",name:"固定节点(MENU)",category:"elements-interaction",desc:"固定节点，常集成在右键菜单中",cover:"http://xxxx.jpg",icon:"icon-pushpin",type:"GIAC_MENU",docs:"https://www.yuque.com/antv/gi/qpuxagq0v56gng23"},component:e=>{const{contextmenu:t,controlledValues:n}=e,{graph:r,layout:o,restartForceSimulation:i,updateHistory:a}=(0,c.useContext)(),s="graphin-force"===o.type,[l,u]=(0,h.useState)(!1),[d,p]=(0,h.useState)(),f=(e,n)=>{var o;const a=t.item;if((!a||a.destroyed||"node"!==(null===(o=a.getType)||void 0===o?void 0:o.call(a)))&&!e)return g(void 0,void 0,!1,"节点不存在"),null;let l,d,p;if(t.onClose(),e){if(!r.findById(e))return void g(void 0,void 0,!1,"节点不存在");p=e,l=r.findById(e),d=n||"pin"}else{l=a;const e=a.getModel();p=e.id,d=e.pinned?"unpin":"pin",u(e.pinned)}"unpin"===d?((e,t,n,r)=>{try{const o=e.getModel();if("graphin-circle"!==o.type)return;const i=[...(o.style||{badges:[]}).badges],a=i.findIndex((({value:e})=>e===c.icons.pushpin));i.splice(a,1),t.updateItem(o.id,{layout:Object.assign(Object.assign({},o.layout),{force:{mass:null}}),mass:1,pinned:!1,style:{badges:i}}),r&&n([o],t)}catch(e){console.log(e)}})(l,r,i,s):ba(l,r,i,{dragNodeMass:1e5,isForce:s}),g(p,d,!0)},g=(e,t,n=!0,r)=>{a({componentId:"PinNodeWithMenu",type:"configure",subType:"固定节点",statement:`固定 ${e}`,success:n,errorMsg:r,params:{id:e,action:t}})};return(0,h.useEffect)((()=>{t.item&&!t.item.destroyed&&p(t.item)}),[t.item]),(0,h.useEffect)((()=>{if(n){const{id:e,action:t}=n;p(r.findById(e)),f(e,t)}}),[n]),!d||d.destroyed?null:m().createElement(L.Menu.Item,{key:"lock-node",eventKey:"lock-node",onClick:()=>f()},d.getModel().pinned?"解除固定":"固定节点")},registerMeta:()=>({})},ds={info:{id:"PropertyGraphInitializer",name:"属性图计算",desc:"辅助其他资产智能分析本地数据的属性图计算",cover:"http://xxxx.jpg",category:"system-interaction",type:"AUTO",services:[],docs:"https://www.yuque.com/antv/gi/eedyuy"},component:e=>{const t=(0,c.useContext)(),{data:n,schemaData:r,updateContext:o}=t;return h.useEffect((()=>{const e=c.utils.graphData2PropertyGraph(n,r);o((t=>{t.propertyGraphData=e}))}),[n]),null},registerMeta:()=>({})},ps={info:{id:"RemoveNodeWithMenu",name:"节点删除",desc:"节点删除-右键菜单集成",icon:"icon-minus-circle",cover:"http://xxxx.jpg",category:"elements-interaction",type:"GIAC_MENU",docs:"https://www.yuque.com/antv/gi/sumihx4ui152k2x3"},component:e=>{const{contextmenu:t,controlledValues:n}=e,{graph:r,updateHistory:o}=(0,c.useContext)(),{removeNodes:i}=(()=>{const e=(0,c.useContext)(),t=m().useCallback((t=>{var n,r;if(0===t.length)return;const o=e.graph.save(),i={},a=null===(n=o.nodes)||void 0===n?void 0:n.filter((e=>{const n=!t.includes(e.id);return n&&(i[e.id]=e),n})),s=null===(r=o.edges)||void 0===r?void 0:r.filter((e=>i[e.source]&&i[e.target]));e.updateData(Object.assign(Object.assign({},o),{nodes:a,edges:s}))}),[e]),n=m().useCallback((t=>{var n;if(0===t.length)return;const r=e.graph.save(),o=null===(n=r.edges)||void 0===n?void 0:n.filter((e=>!t.includes(e.id)));e.updateData(Object.assign(Object.assign({},r),{edges:o}))}),[e]);return m().useMemo((()=>({removeNodes:t,removeEdges:n})),[t,n])})(),a=(0,h.useCallback)((()=>{null==t||t.onClose(),(null==t?void 0:t.item)&&r.setItemState(t.item,"selected",!0);const e=(r.findAllByState("node","selected")||[]).map((e=>e.getID()));i(e),s(e)}),[i,t,r]),s=(e,t=!0,n)=>{o({componentId:"RemoveNodeWithMenu",type:"configure",subType:"删除节点",statement:`删除 ${e.length} 个节点`,success:t,errorMsg:n,params:{nodeIds:e}})};return(0,h.useEffect)((()=>{if(n){const{nodeIds:e}=n,t=e.filter((e=>r.findById(e)));t.length?(i(t),s(t)):s([],!1,"当前画布中未找到指定 id 的节点")}}),[n]),m().createElement(L.Menu.Item,{key:"node-remove",eventKey:"node-remove",onClick:a},"删除节点")},registerMeta:()=>({})},fs={id:"SankeyAnalysis",name:"桑基图分析",desc:"桑基图分析",icon:"icon-sankey",cover:"http://xxxx.jpg",category:"data-analysis",type:"GIAC_CONTENT",docs:"https://www.yuque.com/antv/gi/ut0gfkvkh3igtu43"},{deepClone:hs,GIAC_CONTENT_METAS:ms}=c.extra,gs=hs(ms);gs.GIAC_CONTENT.properties.GIAC_CONTENT.properties.title.default=fs.name,gs.GIAC_CONTENT.properties.GIAC_CONTENT.properties.icon.default=fs.icon,gs.GIAC_CONTENT.properties.GIAC_CONTENT.properties.containerWidth.default="400px";const ys={info:fs,component:e=>{const{weightField:t}=e,{data:n}=(0,c.useContext)(),r=h.useRef(null);return h.useEffect((()=>{const e=n.edges.map((e=>e.data)).filter((e=>"number"==typeof e[t]));if(!r.current)return;const o=new Wt.Sankey(r.current,{data:e,sourceField:"source",targetField:"target",weightField:t,nodeWidthRatio:.01,nodePaddingRatio:.03,nodeSort:(e,n)=>n[t]-e[t]});return o.render(),()=>{o.destroy()}}),[t,n]),h.createElement("div",null,h.createElement("div",{ref:r}))},registerMeta:({schemaData:e})=>{const t=e.edges.reduce(((e,t)=>Object.assign(Object.assign({},e),t.properties)),{}),n=Object.keys(t).filter((e=>"number"===t[e])).map((e=>({value:e,label:e})));return Object.assign({weightField:{title:"权重映射",type:"string","x-decorator":"FormItem","x-component":"Select",enum:n,default:""}},gs)}},vs=e=>{const{hash:t}=e,[n,r]=t.split("?");return{path:n,searchParams:new URLSearchParams(r)}},bs=e=>{const{items:t,queryKey:n="tab",style:r={},extra:o=h.createElement(h.Fragment,null),defaultActive:i}=e,[a,s]=h.useState((()=>{const{searchParams:e}=vs(window.location);return{active:e.get(n)||i||t[0].key}})),{active:l}=a,c=t.map((e=>({value:e.key,icon:e.icon})));return h.createElement("div",{style:{padding:"12px 12px"}},h.createElement("div",{style:{borderRadius:"8px",textAlign:"center",paddingBottom:"12px"}},h.createElement(L.Segmented,{options:c,value:l,onChange:e=>{const{searchParams:t,path:r}=vs(window.location);t.set(n,e),window.location.hash=`${r}?${t.toString()}`,s((t=>Object.assign(Object.assign({},t),{active:e})))}})),h.createElement("div",{className:"gi-segmented-tabs"},t.map((e=>{const{key:t,children:n}=e,r=t===l;return h.createElement("div",{className:r?"appear":"hidden",key:t},n)}))))},xs={info:{id:"SegmentedLayout",name:"分段布局",desc:"分段器布局",icon:"icon-pic-center",cover:"http://xxxx.jpg",category:"container-components",type:"GICC_LAYOUT"},component:e=>{const{children:t}=e,n=(0,c.useContext)(),{graph:r}=n,o=r&&!r.destroyed,{containers:i}=e,{config:a,assets:s}=n,l=a.components.reduce(((e,t)=>Object.assign(Object.assign({},e),{[t.id]:t})),{}),{GI_CONTAINER:u=[],width:d=360,padding:p=12}=i[0]||{},f=((e,t,n)=>m().useMemo((()=>{const r=[];e.forEach((e=>{"string"==typeof e?r.push(e):r.push(e.value)}));const o=r.map((e=>t[e])).filter((e=>e&&"GIAC_CONTENT"===e.type));if(!o||0===o.length)return[{id:"empty",icon:"icon-empty",props:{},children:m().createElement(L.Empty,{description:"当前容器中没用原子组件，请在左侧配置面板中添加"})}];const i=o.map(((e,t)=>{if(!e)return console.warn(`config not found, index: ${t}`),null;const{props:r,id:o}=e,i=n[o];if(!i)return console.warn(`asset: ${o} not found`),null;const{component:a}=i,{icon:s}=e.props.GIAC_CONTENT||{};return{id:o,icon:s,props:r,children:m().createElement(a,Object.assign({},r))}}));return i}),[e,t,n]))(u,l,s.components).map((e=>({icon:h.createElement(c.Icon,{type:e.icon}),key:e.id,children:o&&e.children})));return h.createElement("div",{style:{width:"100%",height:"100%",display:"flex"}},h.createElement("div",{style:{width:`${d}px`,marginRight:`${p}px`,background:"var(--background-color-transparent)",borderRadius:"8px",overflowY:"scroll"}},h.createElement(bs,{items:f})),h.createElement("div",{style:{width:`calc(100% - ${d+2*p}px)`}},t))},registerMeta:e=>{const{GIAC_CONTENT_ITEMS:t}=e;return{containers:[{id:"GI_CONTAINER_SIDE",name:"侧边容器",required:!0,GI_CONTAINER:{title:"集成组件",type:"string","x-decorator":"FormItem","x-component":"Select","x-component-props":{mode:"multiple"},enum:t,default:[]},width:{type:"number",title:"容器宽度","x-component":"NumberPicker","x-decorator":"FormItem",default:360},padding:{type:"number",title:"Padding","x-component":"NumberPicker","x-decorator":"FormItem",default:12}}]}}},Es={info:{id:"SelectExchangeMenuItem",name:"反选",desc:"反选已选择节点",icon:"icon-revert-select",cover:"http://xxxx.jpg",category:"canvas-interaction",type:"GIAC_MENU",docs:"https://www.yuque.com/antv/gi/nqffpzvargy7ahox"},component:e=>{const{contextmenu:t}=e,{graph:n}=(0,c.useContext)(),r=m().useCallback((e=>{var t,r;const o=n.save(),i={};null===(t=o.nodes)||void 0===t||t.forEach((t=>{n.clearItemStates(t.id);const r=!e.includes(t.id);r&&(i[t.id]=t),n.setItemState(t.id,"selected",r)})),null===(r=o.edges)||void 0===r||r.forEach((e=>{n.clearItemStates(e.id);let t=i[e.source]&&i[e.target];n.setItemState(e.id,"selected",!!t)}))}),[n]),o=m().useCallback((()=>{null==t||t.onClose(),(null==t?void 0:t.item)&&n.setItemState(t.item,"selected",!0);const e=(n.findAllByState("node","selected")||[]).map((e=>e.getID()));r(e)}),[t,n]);return m().createElement(L.Menu.Item,{key:"select-exchange",eventKey:"select-exchange",onClick:o},"反选节点")},registerMeta:()=>({})},Is={info:{id:"SideLayout",name:"侧边栏布局",desc:"侧边栏布局",icon:"icon-tabs",cover:"http://xxxx.jpg",category:"container-components",type:"GICC_LAYOUT"},component:e=>{const{children:t,containers:n}=e,{groups:r=[],background:o,width:i=60}=n.find((e=>"GI_SIDE_CONTAINER"===e.id))||{};return m().createElement("div",{className:"gi-side-layout"},m().createElement("div",{className:"gi-side-layout-item"},m().createElement(Fa,{vertical:!0,isSideContent:!0,items:r,style:{background:o,width:i},wrapperStyle:{height:"100%"}})),m().createElement("div",{className:"gi-side-layout-v"},m().createElement("div",{className:"gi-side-layout-canvas"},t)))},registerMeta:e=>{const{GIAC_ITEMS:t=[],GIAC_CONTENT_ITEMS:n=[]}=e;return{containers:[{id:"GI_SIDE_CONTAINER",name:"侧边栏",required:!0,background:{title:"背景色",type:"string","x-decorator":"FormItem","x-component":"ColorInput"},groups:La(e),GI_CONTAINER:{title:"集成组件",type:"array",enum:[...t,...n],"x-decorator":"FormItem","x-component":"Select","x-component-props":{mode:"multiple"},default:[]}}]}}},ws={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M840.4 300H183.6c-19.7 0-30.7 20.8-18.5 35l328.4 380.8c9.4 10.9 27.5 10.9 37 0L858.9 335c12.2-14.2 1.2-35-18.5-35z"}}]},name:"caret-down",theme:"outlined"};var Cs=function(e,t){return h.createElement(bt,le(le({},e),{},{ref:t,icon:ws}))};Cs.displayName="CaretDownOutlined";const Ss=h.forwardRef(Cs),Os={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M623.6 316.7C593.6 290.4 554 276 512 276s-81.6 14.5-111.6 40.7C369.2 344 352 380.7 352 420v7.6c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V420c0-44.1 43.1-80 96-80s96 35.9 96 80c0 31.1-22 59.6-56.1 72.7-21.2 8.1-39.2 22.3-52.1 40.9-13.1 19-19.9 41.8-19.9 64.9V620c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8v-22.7a48.3 48.3 0 0130.9-44.8c59-22.7 97.1-74.7 97.1-132.5.1-39.3-17.1-76-48.3-103.3zM472 732a40 40 0 1080 0 40 40 0 10-80 0z"}}]},name:"question-circle",theme:"outlined"};var Ts=function(e,t){return h.createElement(bt,le(le({},e),{},{ref:t,icon:Os}))};Ts.displayName="QuestionCircleOutlined";const As=h.forwardRef(Ts),Ns={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M724 218.3V141c0-6.7-7.7-10.4-12.9-6.3L260.3 486.8a31.86 31.86 0 000 50.3l450.8 352.1c5.3 4.1 12.9.4 12.9-6.3v-77.3c0-4.9-2.3-9.6-6.1-12.6l-360-281 360-281.1c3.8-3 6.1-7.7 6.1-12.6z"}}]},name:"left",theme:"outlined"};var ks=function(e,t){return h.createElement(bt,le(le({},e),{},{ref:t,icon:Ns}))};ks.displayName="LeftOutlined";const _s=h.forwardRef(ks),js={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M765.7 486.8L314.9 134.7A7.97 7.97 0 00302 141v77.3c0 4.9 2.3 9.6 6.1 12.6l360 281.1-360 281.1c-3.9 3-6.1 7.7-6.1 12.6V883c0 6.7 7.7 10.4 12.9 6.3l450.8-352.1a31.96 31.96 0 000-50.4z"}}]},name:"right",theme:"outlined"};var Fs=function(e,t){return h.createElement(bt,le(le({},e),{},{ref:t,icon:js}))};Fs.displayName="RightOutlined";const Ps=h.forwardRef(Fs),Ms=e=>{const{placement:t,offset:n,width:r,height:o,defaultVisible:i}=e,[a,s]=h.useState({visible:"boolean"!=typeof i||i}),l=c.utils.getPositionStyles(t,n),u=Object.assign(Object.assign({},l),{top:"0px",width:r,boxShadow:"0 2px 4px 0 rgba(0, 0, 0, 0.1)",transition:"all 0.1s ease"}),d=a.visible?u:Object.assign(Object.assign({},u),{left:"0px",width:"0px"}),{children:p}=e;return h.createElement("div",{style:d,className:"gi-side-select-tabs"},h.createElement("div",{style:{position:"absolute",left:"100%",top:"50%",height:"80px",width:"38px",borderStyle:"solid",borderWidth:"16px",borderColor:"transparent transparent transparent var(--background-color-2)"}}),h.createElement("div",{onClick:()=>{s((e=>({visible:!e.visible})))},style:{position:"absolute",left:"calc(100% - 1px)",top:"50%",height:"80px",width:"38px",cursor:"pointer",borderStyle:"solid",borderWidth:"16px",borderColor:"transparent transparent transparent var(--background-color-2)"}},h.createElement("span",{style:{position:"absolute",left:"-13px",top:"14px",fontSize:10}},a.visible?h.createElement(_s,null):h.createElement(Ps,null))),h.createElement("div",{className:"gi-side-select-tabs-content"},p))},{deepClone:Rs,GI_CONTAINER_METAS:Ls}=c.extra,Gs=Rs(Ls),{width:Ds,offset:Bs,placement:zs}=Gs;Ds.default="350px",Bs.default=[0,2];const $s={info:{id:"SideSelectTabs",name:"下拉导航栏",desc:"侧边下拉导航栏，可集成分析组件",icon:"icon-sidebar",cover:"http://xxxx.jpg",category:"container-components",type:"GICC"},component:e=>{const{components:t,assets:n,placement:r,offset:o,width:i,height:a,defaultVisible:s,outSideFromCanvas:l,GISDK_ID:c}=e,u=h.useMemo((()=>t.sort(((e,t)=>{var n,r;return((null===(n=e.props)||void 0===n?void 0:n.GI_CONTAINER_INDEX)||0)-((null===(r=t.props)||void 0===r?void 0:r.GI_CONTAINER_INDEX)||0)})).filter((e=>e&&e.props&&e.props.GIAC_CONTENT))),[t]),d=h.useMemo((()=>u.map((e=>{const t=n[e.id],r=null==t?void 0:t.info;if(r)return Object.assign(Object.assign({},r),{label:r.name,value:r.id,Cp:t.component,cpProps:e.props})}))),[u]),[p,f]=Fr({currentCp:d[0]||{}});if(h.useEffect((()=>{d.length>0&&f((e=>{e.currentCp=d[0]}))}),[d.length]),!d.length)return null;const{currentCp:m}=p,{cpProps:g,Cp:y}=m;if(!y)return null;const v=h.createElement("div",{className:"content"},h.createElement("div",{className:"content-title"},h.createElement(L.Select,{options:d,onChange:(e,t)=>{f((e=>{e.currentCp=t}))},defaultValue:d[0].value,bordered:!1,style:{width:200},suffixIcon:h.createElement(Ss,null)}),h.createElement(L.Tooltip,{title:m.desc,placement:"right"},h.createElement(As,null))),h.createElement("div",{className:"content-detail"},h.createElement(y,Object.assign({},g))));return l?$r().createPortal(h.createElement(Ms,{width:i,height:a,defaultVisible:s,placement:r,offset:o},v),document.getElementById(`${c}-container`)):h.createElement(Ms,{width:i,height:a,defaultVisible:s,placement:r,offset:o},v)},registerMeta:e=>{const{GIAC_CONTENT_ITEMS:t=[]}=e;return{GI_CONTAINER:{title:"集成组件",type:"string","x-decorator":"FormItem","x-component":"Select","x-component-props":{mode:"multiple"},enum:t,default:[]},width:Ds,offset:Bs,placement:{title:"放置方位",type:"string","x-decorator":"FormItem","x-component":"Select","x-component-props":{options:[{value:"LB",label:"左下 / left"}]},default:"LB"}}}},qs=(e,t,n)=>m().useMemo((()=>{const r=[];e.forEach((e=>{"string"==typeof e?r.push(e):r.push(e.value)}));const o=r.map((e=>t[e])).filter((e=>e&&e.props&&e.props.GIAC_CONTENT)).sort(((e,t)=>e.props.GI_CONTAINER_INDEX-t.props.GI_CONTAINER_INDEX));if(!o||0===o.length)return[{id:"empty",icon:"icon-empty",props:{},children:m().createElement(L.Empty,{description:"当前容器中没用原子组件，请在左侧配置面板中添加"})}];const i=o.map(((e,t)=>{if(!e)return console.warn(`config not found, index: ${t}`),null;const{props:r,id:o}=e,i=n[o];if(!i)return console.warn(`asset: ${o} not found`),null;const{component:a}=i,{icon:s}=e.props.GIAC_CONTENT||{};return{id:o,icon:s,props:r,children:m().createElement(a,Object.assign({},r))}}));return i.filter(Boolean)}),[e,t,n]),Us={info:{id:"UadLayout",name:"上下布局",desc:"上下布局，适用于图查询场景",icon:"icon-pic-center",cover:"http://xxxx.jpg",category:"container-components",type:"GICC_LAYOUT",docs:"https://www.yuque.com/antv/gi/ya1sna6e8w4opstp"},component:e=>{var t;const{children:n,containers:r=[]}=e,{config:o,assets:i,data:a,graph:s}=(0,c.useContext)(),l=s&&!s.destroyed,{GI_CONTAINER:u=[],height:d=251}=r.find((e=>"GI_CONTAINER_TOP"===e.id))||{},{GI_CONTAINER:p=[],tabPosition:f="right",padding:m="0px 0px"}=r.find((e=>"GI_CONTAINER_SIDE"===e.id))||{},g=o.components.reduce(((e,t)=>Object.assign(Object.assign({},e),{[t.id]:t})),{}),y=qs(u,g,i.components),v=qs(p,g,i.components),b=[{label:h.createElement(c.Icon,{type:"icon-layout-concentric",style:{fontSize:"30px"}}),key:"sdk",children:n,forceRender:!0},...v.map((e=>!!e&&{label:h.createElement(c.Icon,{type:e.icon,style:{fontSize:"30px"}}),key:e.id,children:l&&e.children}))].filter(Boolean),[x,E]=h.useState({activeKey:null===(t=null==b?void 0:b[0])||void 0===t?void 0:t.key});return h.useEffect((()=>{const{nodes:e,edges:t,tableResult:n}=a;if(!e.length&&!t.length&&n){const e=null==b?void 0:b.find((e=>"JSONMode"===e.key));e&&E({activeKey:e.key})}}),[a]),h.createElement("div",{style:{width:"100%",height:"100%"}},h.createElement("div",{style:{height:`${d}px`,borderBottom:"var(--primary-border)",padding:m}},y.map((e=>e.children))),h.createElement("div",{className:"gi-uad-layout-canvas-wrapper",style:{height:`calc(100% - ${d+16}px`}},h.createElement(L.Tabs,{tabBarStyle:{marginRight:" -12px"},activeKey:x.activeKey,onTabClick:e=>E({activeKey:e}),items:b,tabPosition:f,style:{height:"100%"},className:"gi-uad-layout-tabs"})))},registerMeta:e=>{const{GIAC_CONTENT_ITEMS:t}=e;return{containers:[{id:"GI_CONTAINER_TOP",name:"顶部容器",required:!0,GI_CONTAINER:{title:"顶部组件",type:"string","x-decorator":"FormItem","x-component":"Select","x-component-props":{},enum:t,default:[]},height:{type:"number",title:"顶部高度","x-component":"NumberPicker","x-decorator":"FormItem",default:251},padding:{type:"string",title:"内部间距","x-component":"Input","x-decorator":"FormItem",default:"0px 0px"}},{id:"GI_CONTAINER_SIDE",name:"侧边容器",required:!0,GI_CONTAINER:{title:"侧边组件",type:"string","x-decorator":"FormItem","x-component":"Select","x-component-props":{mode:"multiple"},enum:t,default:[]},tabPosition:{title:"Tab 位置",type:"string","x-decorator":"FormItem","x-component":"Select","x-component-props":{options:[{value:"left",label:"左边"},{value:"right",label:"右边"},{value:"top",label:"上方"},{value:"bottom",label:"下方"}]},default:"right"}}]}}};function Vs(){return window.devicePixelRatio||1}function Hs(e,t,n,r){e.translate(t,n),e.rotate(Math.PI/180*Number(r)),e.translate(-t,-n)}const Ws="gi-watermark";var Ks;!function(e){e.Canvas="canvas",e.Page="page"}(Ks||(Ks={}));const Ys={info:{id:"Watermark",name:"水印",desc:"添加水印",cover:"http://xxxx.jpg",category:"system-interaction",icon:"icon-placeholder",type:"AUTO",services:["WatermarkService"],docs:"https://www.yuque.com/antv/gi/atogtq0417351bpq"},component:e=>{var t,n;const{watermarkServiceId:r,renderMode:o,zIndex:i,rotate:a,width:s,height:l,fontColor:u,fontSize:d,gap:p,offset:f}=e,{GISDK_ID:g,services:y}=(0,c.useContext)(),[v,b]=(0,h.useState)(""),[x,E]=(0,h.useState)(""),I=c.utils.getService(y,r),w=document.getElementById(`${g}-container`),C=document.getElementsByClassName("gi-analysis-canvas")[0],S={[Ks.Canvas]:w,[Ks.Page]:C},[O,T]=p,A=O/2,N=T/2,k=null!==(t=null==f?void 0:f[0])&&void 0!==t?t:A,_=null!==(n=null==f?void 0:f[1])&&void 0!==n?n:N,j=(0,h.useRef)(null),F=(0,h.useRef)(!1),P=()=>{j.current&&(j.current=null)},M=(e,t)=>{j.current&&(F.current=!0,j.current.setAttribute("style",function(e){return Object.keys(e).map((t=>`${(0,ya.kebabCase)(t)}: ${e[t]};`)).join(" ")}(Object.assign(Object.assign({},(()=>{const e={zIndex:i,position:"absolute",left:0,top:0,width:"100%",height:"100%",pointerEvents:"none",backgroundRepeat:"repeat"};let t=k-A,n=_-N;return t>0&&(e.left=`${t}px`,e.width=`calc(100% - ${t}px)`,t=0),n>0&&(e.top=`${n}px`,e.height=`calc(100% - ${n}px)`,n=0),e.backgroundPosition=`${t}px ${n}px`,e})()),{backgroundImage:`url('${e}')`,backgroundSize:2*(O+t)+"px"}))),setTimeout((()=>{F.current=!1})))},R=(e,t,n,r,o)=>{const i=Vs(),a=Number(d)*i;e.font=`normal normal normal ${a}px/${o}px sans-serif`,e.fillStyle=u,e.textAlign="center",e.textBaseline="top",e.translate(r/2,0);const s=Array.isArray(v)?v:[v];null==s||s.forEach(((r,o)=>{e.fillText(null!=r?r:"",t,n+o*(a+3*i))}))},L=(e,t,n,r,o,i,s,l,c,u,d)=>{R(t,n,r,o,i),t.restore(),Hs(t,s,l,a),R(t,c,u,o,i),M(e.toDataURL(),d)},G=()=>{const e=document.createElement("canvas"),t=e.getContext("2d");if(!j.current){let e=document.getElementById(Ws);e||(e=document.createElement("div"),e.id=Ws,S[o].append(e)),j.current=e}if(t){const n=Vs(),[r,o]=(e=>{let t=120,n=64;if(!x&&e.measureText){e.font=`${Number(d)}px`;const r=Array.isArray(v)?v:[v],o=r.map((t=>e.measureText(t).width));t=Math.ceil(Math.max(...o)),n=16*r.length+3*(r.length-1)}return[null!=s?s:t,null!=l?l:n]})(t),i=(O+r)*n,c=(T+o)*n;e.setAttribute("width",2*i+"px"),e.setAttribute("height",2*c+"px");const u=O*n/2,p=T*n/2,f=r*n,h=o*n,m=(f+O*n)/2,g=(h+T*n)/2,y=u+i,b=p+c,E=m+i,I=g+c;if(t.save(),Hs(t,m,g,a),x){const n=new Image;n.onload=()=>{t.drawImage(n,u,p,f,h),t.restore(),Hs(t,E,I,a),t.drawImage(n,y,b,f,h),M(e.toDataURL(),r)},n.onerror=()=>L(e,t,u,p,f,h,E,I,y,b,r),n.crossOrigin="anonymous",n.referrerPolicy="no-referrer",n.src=x}else L(e,t,u,p,f,h,E,I,y,b,r)}};return(0,h.useEffect)((()=>{const e=new MutationObserver((e=>{F.current||e.forEach((e=>{e.removedNodes.length&&Array.from(e.removedNodes).some((e=>{e===j.current&&(P(),G(),j.current.setAttribute("style",e.attributes.style.value))})),"attributes"===e.type&&e.target===j.current&&(P(),G(),j.current.setAttribute("style",e.oldValue))}))}));return e.observe(document.body,{attributes:!0,childList:!0,subtree:!0,attributeOldValue:!0}),()=>{e.disconnect()}}),[]),(0,h.useEffect)((()=>{!function(e,t,n,r){new(n||(n=Promise))((function(o,i){function a(e){try{l(r.next(e))}catch(e){i(e)}}function s(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))}(void 0,void 0,void 0,(function*(){var e,t;if(I){const n=yield I();b(null===(e=null==n?void 0:n.data)||void 0===e?void 0:e.content),E(null===(t=null==n?void 0:n.data)||void 0===t?void 0:t.image)}}))}),[r]),(0,h.useEffect)((()=>(G(),()=>{P()})),[r,o,a,i,s,l,x,v,u,d,O,T,k,_]),$r().createPortal(m().createElement("div",{id:Ws,ref:j}),S[o])},registerMeta:({services:e})=>({renderMode:{title:"渲染模式",type:"string","x-decorator":"FormItem","x-component":"Select","x-component-props":{options:[{value:"page",label:"整个页面"},{value:"canvas",label:"仅画布"}]},default:"page"},watermarkServiceId:{title:"水印服务",type:"string","x-decorator":"FormItem","x-component":"Select","x-component-props":{options:c.utils.getServiceOptions(e,"WatermarkService")},default:"GI/WatermarkService"},width:{title:"宽度",type:"number","x-decorator":"FormItem","x-component":"NumberPicker",default:120},height:{title:"高度",type:"number","x-decorator":"FormItem","x-component":"NumberPicker",default:64},rotate:{title:"旋转角度",type:"number","x-decorator":"FormItem","x-component":"NumberPicker","x-component-props":{min:-90,max:90},default:-22},zIndex:{title:"z-index",type:"number","x-decorator":"FormItem","x-component":"NumberPicker",default:9},fontSize:{title:"字体大小",type:"number","x-decorator":"FormItem","x-component":"NumberPicker","x-component-props":{min:0},default:16},fontColor:{title:"字体颜色",type:"string","x-decorator":"FormItem","x-component":"ColorInput",default:"rgba(0,0,0,.15)"},gap:{title:"间距",type:"string","x-decorator":"FormItem","x-component":"Offset","x-component-props":{min:0,max:400},default:[100,100]},offset:{title:"偏移量",type:"string","x-decorator":"FormItem","x-component":"Offset","x-component-props":{min:0,max:400},default:[50,50]}})},{GIAComponent:Xs}=c.extra,Qs={id:"ZoomIn",name:"放大",desc:"点击可放大画布",cover:"http://xxxx.jpg",icon:"icon-zoomin",category:"canvas-interaction",type:"GIAC",docs:"https://www.yuque.com/antv/gi/mw2wxx9h6kz1lp0z"},{deepClone:Js,GIAC_METAS:Zs}=c.extra,el=Js(Zs);el.GIAC.properties.GIAC.properties.title.default=Qs.name,el.GIAC.properties.GIAC.properties.icon.default=Qs.icon,el.GIAC.properties.GIAC.properties.isShowTitle.default=!1,el.GIAC.properties.GIAC.properties.tooltipPlacement.default="right";const tl={info:Qs,component:e=>{const{GIAC:t}=e,{apis:n}=(0,c.useContext)();return h.createElement(Xs,{GIAC:t,onClick:()=>n.handleZoomOut()})},registerMeta:()=>el},{GIAComponent:nl}=c.extra,rl={id:"ZoomOut",name:"缩小",desc:"点击可缩小画布",icon:"icon-zoomout",cover:"http://xxxx.jpg",category:"canvas-interaction",type:"GIAC",docs:"https://www.yuque.com/antv/gi/mw2wxx9h6kz1lp0z"},{deepClone:ol,GIAC_METAS:il}=c.extra,al=ol(il);al.GIAC.properties.GIAC.properties.icon.default=rl.icon,al.GIAC.properties.GIAC.properties.title.default=rl.name,al.GIAC.properties.GIAC.properties.isShowTitle.default=!1,al.GIAC.properties.GIAC.properties.tooltipPlacement.default="right";const sl={info:rl,component:e=>{const{GIAC:t}=e,{apis:n}=(0,c.useContext)();return h.createElement(nl,{GIAC:t,onClick:()=>n.handleZoomIn()})},registerMeta:()=>al},ll={info:{id:"ZoomStatus",name:"缩放状态",desc:"缩放时到某个阈值添加状态",cover:"http://xxxx.jpg",category:"canvas-interaction",type:"AUTO",docs:"https://www.yuque.com/antv/gi/egs4rz70pc1anpsq"},component:e=>{const{minZoom:t=.6,statusName:n="minZoom"}=e,r=(0,c.useContext)().graph;return h.useEffect((()=>{let e;const o=()=>{e&&clearTimeout(e),e=setTimeout((()=>{(()=>{const e=r.getZoom()<=t;r.getNodes().forEach((t=>{r.setItemState(t,n,e)})),r.getEdges().forEach((t=>{r.setItemState(t,n,e)}))})(),e=0}),100)};return r.on("wheelzoom",o),()=>{r.off("wheelzoom",o),e&&clearTimeout(e)}}),[r,t,n]),null},registerMeta:()=>({minZoom:{title:"最小缩放",type:"number","x-decorator":"FormItem","x-component":"NumberPicker",default:.6},statusName:{title:"状态名",type:"string","x-decorator":"FormItem","x-component":"Input",default:"minZoom"}})},cl={donut:[],label:["id"],donutColors:"",size:void 0},ul={info:{id:"DonutNode",name:"甜甜圈",type:"NODE",category:"node",icon:"icon-piechart",desc:"甜甜圈组件，用于数据有分布的情况",cover:"https://gw.alipayobjects.com/mdn/rms_0d75e8/afts/img/A*dqQ0RrldWTAAAAAAAAAAAAAAARQnAQ"},registerShape:e=>{},registerMeta:e=>{try{const{keys:t}=e,n=t.filter((e=>"number"===e.type)).map((e=>e.id)),r=n.map((e=>({label:e,value:e})));return{type:"object",properties:{donut:{title:"环展示",type:"array",enum:r,default:[],"x-decorator":"FormItem","x-component":"Select","x-component-props":{mode:"multiple"}},donutColors:{title:"环色彩",type:"string","x-decorator":"FormItem","x-component":"Input",default:""},size:{title:"环大小",type:"string","x-decorator":"FormItem","x-component":"NumberPicker",default:void 0},label:{title:"文本",type:"array",enum:t.map((e=>({label:`${e.id} (${e.type})`,value:e.id}))),default:[],"x-decorator":"FormItem","x-component":"Select","x-component-props":{mode:"multiple"}}}}}catch(e){return{}}},registerTransform:(e,t)=>{try{const n=Object.assign({},cl,t.props),{donut:r,label:o,donutColors:i,size:a}=n;let s=["#61DDAA","#F08BB4","#65789B"];"string"==typeof i&&(s=i.split(",")||["#61DDAA","#F08BB4","#65789B"]);const l=r.reduce(((e,t,n)=>Object.assign(Object.assign({},e),{[t]:s[n]})),{}),c=e.map((e=>{const{id:t}=e,n=e.data||e,i=r.reduce(((e,t)=>Object.assign(Object.assign({},e),{[t]:n[t]})),{}),s=r.reduce(((e,t)=>e+n[t]),16),c=a||5*Math.sqrt(s);return{id:t,data:n,type:"donut",label:n[o],donutAttrs:i,donutColorMap:l,size:c,style:{lineWidth:0},labelCfg:{position:"bottom"}}}));return c}catch(t){return console.error("parse transform error:",t),e}}};var dl=u(876),pl=u.n(dl);const fl={primaryEdgeColor:"#ddd",edgeSize:1,mode:"light"},hl=p.Utils.getEdgeStyleByTheme(fl),{style:ml}=hl,{keyshape:gl,label:yl}=ml,vl={size:fl.edgeSize,color:fl.primaryEdgeColor,label:[],advanced:{keyshape:{customPoly:!1,poly:0,lineDash:[0,0],opacity:gl.strokeOpacity,hasArrow:!0},label:{visible:!0,fontSize:yl.fontSize,offset:[0,0],fill:yl.fill,backgroundEnable:!0,backgroundFill:"#fff",backgroundStroke:"#fff",backgroundOpaciy:1,opacity:1},animate:{visible:!1,type:"circle-running",dotColor:"red",repeat:!0,duration:3e3}},status:{minZoom:{label:{opacity:0},"label-background":{opacity:0}}}},{advanced:bl,color:xl,size:El}=vl,{keyshape:Il,label:wl,animate:Cl}=bl,Sl={info:{id:"SimpleEdge",category:"edge",name:"官方边",desc:"SimpleEdge",cover:"http://xxxx.jpg",type:"EDGE"},registerShape:e=>{},registerMeta:e=>{const{keys:t,schemaData:n}=e;return{type:"object",properties:{color:{title:"颜色",type:"string","x-decorator":"FormItem","x-component":"ColorInput",default:xl},size:{title:"大小",type:"number","x-decorator":"FormItem","x-component":"NumberPicker",default:El},label:{title:"文本",type:"string","x-decorator":"FormItem","x-component":"GroupSelect","x-component-props":{mode:"multiple",schemaData:n.edges}},advancedPanel:{type:"void","x-decorator":"FormItem","x-component":"FormCollapse","x-component-props":{className:"gi-assets-elements-advance-panel",ghost:!0},properties:{advanced:{type:"object","x-component":"FormCollapse.CollapsePanel","x-component-props":{header:"高级配置",key:"advanced-panel"},properties:{panel:{type:"void","x-decorator":"FormItem","x-component":"FormCollapse","x-component-props":{className:"gi-assets-elements-panel",style:{},ghost:!0},properties:{keyshape:{type:"object","x-decorator":"FormItem","x-component":"FormCollapse.CollapsePanel","x-component-props":{header:"形状",key:"icon-panel"},properties:{hasArrow:{type:"boolean",title:"箭头","x-decorator":"FormItem","x-component":"Switch",default:!0},customPoly:{type:"boolean",title:"定义弧度",default:Il.customPoly,"x-decorator":"FormItem","x-component":"Switch","x-reactions":[{target:"advanced.keyshape.poly",fulfill:{state:{visible:"{{$self.value}}"}}},{target:"advanced.icon.fill",fulfill:{state:{visible:"{{$self.value}}"}}},{target:"advanced.icon.size",fulfill:{state:{visible:"{{$self.value}}"}}}]},poly:{title:"弧度",type:"number","x-decorator":"FormItem","x-component":"NumberPicker",default:Il.poly},lineDash:{title:"虚线",type:"array","x-decorator":"FormItem","x-component":"Offset","x-component-props":{min:-100,max:100},default:Il.lineDash},opacity:{type:"string",title:"透明度","x-decorator":"FormItem","x-component":"NumberPicker",default:Il.opacity}}},label:{type:"object","x-decorator":"FormItem","x-component":"FormCollapse.CollapsePanel","x-component-props":{header:"标签",key:"keyshape-panel"},properties:{visible:{type:"boolean",title:"显隐","x-decorator":"FormItem","x-component":"Switch",default:wl.visible},fontSize:{type:"string",title:"大小","x-decorator":"FormItem","x-component":"NumberPicker",default:wl.fontSize},offset:{type:"string",title:"偏移","x-decorator":"FormItem","x-component":"Offset","x-component-props":{min:-100,max:100},default:wl.offset},fill:{type:"string",title:"颜色","x-decorator":"FormItem","x-component":"ColorInput",default:wl.fill},backgroundEnable:{type:"string",title:"背景","x-decorator":"FormItem","x-component":"Switch",default:wl.backgroundEnable},backgroundFill:{type:"string",title:"背景色","x-decorator":"FormItem","x-component":"ColorInput",default:wl.backgroundFill},backgroundStroke:{type:"string",title:"背景描边","x-decorator":"FormItem","x-component":"ColorInput",default:wl.backgroundStroke}}},animate:{type:"object","x-component":"FormCollapse.CollapsePanel","x-component-props":{header:"动画",key:"aniamte-panel"},properties:{visible:{type:"boolean",title:"开关","x-decorator":"FormItem","x-component":"Switch",default:Cl.visible,"x-reactions":[{target:"advanced.animate.type",fulfill:{state:{visible:"{{$self.value}}"}}},{target:"advanced.animate.dotColor",fulfill:{state:{visible:"{{$self.value}}"}}},{target:"advanced.animate.repeat",fulfill:{state:{visible:"{{$self.value}}"}}},{target:"advanced.animate.duration",fulfill:{state:{visible:"{{$self.value}}"}}}]},type:{title:"类型",type:"string","x-decorator":"FormItem","x-component":"Select",enum:[{label:"圆球",value:"circle-running"},{label:"虚线",value:"line-dash"},{label:"渐长",value:"line-growth"}],default:Cl.type},dotColor:{type:"string",title:"圆球颜色","x-decorator":"FormItem","x-component":"ColorInput",default:Cl.dotColor},repeat:{title:"重复",type:"string","x-decorator":"FormItem","x-component":"Switch",default:Cl.repeat},duration:{title:"时长",type:"string","x-decorator":"FormItem","x-component":"NumberPicker",default:Cl.duration}}}}}}}}}}}},registerTransform:(e,t,n)=>{try{const{color:r,size:o,label:i,advanced:a,status:s}=pl()(vl,t.props),{keyshape:l}=a,c=e.map(((e,t)=>{var c,u;const{source:d,target:p}=e,f=e.id||`${d}-${p}-${t}`,h=e.data||e.properties||e,m=e.source===e.target,g=e.isMultiple;let y={};const{customPoly:v,hasArrow:b}=l;b||(y={endArrow:{path:""}});const x={};m&&(x.type="loop",x.loop=Object.assign({},null===(c=e.style)||void 0===c?void 0:c.keyshape.loop)),g&&(x.type="poly",x.poly=Object.assign({},null===(u=e.style)||void 0===u?void 0:u.keyshape.poly)),g||m||(x.type="poly",x.poly={distance:a.keyshape.poly}),v&&(x.poly={distance:a.keyshape.poly});const E=i.map((t=>{const n=t.split("^^"),r=t.split(".");let[o,i,a]=n;if(1===n.length&&n[0].split(".").length>1&&(o=r[0],i=r[1],a=r[2]),e.edgeType||"UNKNOW"===o){if(a)return h[i][a];const{aggregate:e}=h;if(e){const t=e.reduce(((e,t)=>{const n=t.data[i];return"number"==typeof n?e+=n:""}),0);return""===t?h.aggregateCount:`(${e.length} 条)：${t.toFixed(2)}`}return h[i]}return h[o]})).filter((e=>e)).join("\n"),I={value:E,offset:a.label.offset,fontSize:a.label.fontSize,fill:a.label.fill,opacity:a.label.opacity};a.label.visible||(I.value=""),a.label.backgroundEnable&&(I.background={fill:a.label.backgroundFill,stroke:a.label.backgroundStroke,opacity:a.label.backgroundOpaciy});let w=e&&e.style||{};n&&(w={});const C=pl()({keyshape:Object.assign(Object.assign(Object.assign({},x),{lineWidth:o,stroke:r,opacity:l.opacity,lineDash:l.lineDash,lineAppendWidth:10}),y),label:I,animate:{visible:a.animate.visible,type:a.animate.type,color:a.animate.dotColor,repeat:a.animate.repeat,duration:a.animate.duration},status:Object.assign({},s)},w);return Object.assign(Object.assign({},e),{source:d,target:p,id:f,data:h,type:"graphin-line",edgeType:e.edgeType||"UNKOWN",style:C})}));return c}catch(t){return console.error("parse transform error:",t),e}}},Ol={primaryColor:"#FF6A00",nodeSize:26,mode:"light"},Tl=p.Utils.getNodeStyleByTheme(Ol),{style:Al,status:Nl}=Tl,{keyshape:kl,halo:_l,label:jl,icon:Fl}=Al,Pl={size:Ol.nodeSize,color:Ol.primaryColor,label:[],advanced:{keyshape:Object.assign(Object.assign({},kl),{fillOpacity:.8}),label:Object.assign(Object.assign({},jl),{opacity:1,visible:!0}),icon:Object.assign(Object.assign({},Fl),{fill:"#fff",type:"font",value:"",opacity:1,visible:!1}),badge:{visible:!1,position:"RT",type:"text",value:"",size:Math.round(kl.size/3),fill:"#fff",color:"#fff",stroke:kl.stroke,isMapping:!1},halo:Object.assign(Object.assign({},_l),{visible:!1,lineWidth:0})},status:{minZoom:{label:{opacity:0},icon:{opacity:0},badges:{opacity:0}}}},{icon:Ml,keyshape:Rl,label:Ll,badge:Gl}=Pl.advanced,Dl={info:{id:"SimpleNode",category:"node",type:"NODE",name:"官方节点",icon:"icon-smile",desc:"官方节点",cover:"https://gw.alipayobjects.com/mdn/rms_0d75e8/afts/img/A*myb8SrnSy0cAAAAAAAAAAAAAARQnAQ"},defaultProps:Pl,registerShape:e=>{},registerMeta:e=>{const{schemaData:t}=e;return{type:"object",properties:{size:{title:"大小",type:"number","x-decorator":"FormItem","x-component":"NumberPicker",default:Pl.size},color:{title:"颜色",type:"string","x-decorator":"FormItem","x-component":"ColorInput",default:Pl.color},label:{title:"文本",type:"string","x-decorator":"FormItem","x-component":"GroupSelect","x-component-props":{mode:"multiple",schemaData:t.nodes}},advancedPanel:{type:"void","x-decorator":"FormItem","x-component":"FormCollapse","x-component-props":{className:"gi-assets-elements-advance-panel",ghost:!0},properties:{advanced:{type:"object","x-component":"FormCollapse.CollapsePanel","x-component-props":{header:"高级配置",key:"advanced-panel"},properties:{panel:{type:"void","x-decorator":"FormItem","x-component":"FormCollapse","x-component-props":{className:"gi-assets-elements-panel",style:{},ghost:!0},properties:{icon:{type:"object","x-decorator":"FormItem","x-component":"FormCollapse.CollapsePanel","x-component-props":{header:"图标",key:"icon-panel"},properties:{visible:{type:"boolean",title:"显隐","x-decorator":"FormItem","x-component":"Switch","x-reactions":[{target:"advanced.icon.type",fulfill:{state:{visible:"{{$self.value}}"}}},{target:"advanced.icon.value",fulfill:{state:{visible:"{{$self.value}}"}}},{target:"advanced.icon.fill",fulfill:{state:{visible:"{{$self.value}}"}}},{target:"advanced.icon.size",fulfill:{state:{visible:"{{$self.value}}"}}}]},type:{type:"string",title:"类型","x-decorator":"FormItem","x-component":"Select",enum:[{label:"文本",value:"text"},{label:"字体图标",value:"font"}],default:Ml.type},value:{type:"string",title:"图标","x-decorator":"FormItem","x-component":"IconPicker",default:Ml.value},fill:{type:"string",title:"颜色","x-decorator":"FormItem","x-component":"ColorInput",default:Ml.fill}}},keyshape:{type:"object","x-decorator":"FormItem","x-component":"FormCollapse.CollapsePanel","x-component-props":{header:"节点",key:"keyshape-panel"},properties:{fillOpacity:{type:"string",title:"透明度","x-decorator":"FormItem","x-component":"NumberPicker",max:1,min:0,default:Rl.fillOpacity}}},label:{type:"object","x-component":"FormCollapse.CollapsePanel","x-component-props":{header:"文本",key:"label-panel"},properties:{visible:{type:"boolean",title:"开关","x-decorator":"FormItem","x-component":"Switch",default:Ll.visible,"x-reactions":[{target:"advanced.label.fill",fulfill:{state:{visible:"{{$self.value}}"}}},{target:"advanced.label.fontSize",fulfill:{state:{visible:"{{$self.value}}"}}},{target:"advanced.label.position",fulfill:{state:{visible:"{{$self.value}}"}}}]},fill:{title:"颜色",type:"string","x-decorator":"FormItem","x-component":"ColorInput",default:Ll.fill},fontSize:{type:"string",title:"大小","x-decorator":"FormItem","x-component":"NumberPicker",max:100,min:12,default:Ll.fontSize},position:{title:"位置",type:"string","x-decorator":"FormItem","x-component":"Select",enum:[{label:"顶部",value:"top"},{label:"底部",value:"bottom"},{label:"左侧",value:"left"},{label:"右侧",value:"right"},{label:"中间",value:"center"}],default:Ll.position}}},badge:{type:"object","x-component":"FormCollapse.CollapsePanel","x-component-props":{header:"徽标",key:"badge-panel"},properties:{visible:{type:"boolean",title:"显隐","x-decorator":"FormItem","x-component":"Switch",default:Gl.visible,"x-reactions":[{target:"advanced.badge.type",fulfill:{state:{visible:"{{$self.value}}"}}},{target:"advanced.badge.value",fulfill:{state:{visible:"{{$self.value}}"}}}]},type:{title:"类型",type:"string","x-decorator":"FormItem","x-component":"Select",enum:[{label:"字段映射",value:"mapping"},{label:"文本",value:"text"},{label:"字体图标",value:"font"}],default:Gl.type},value:{type:"string",title:"文本","x-decorator":"FormItem","x-component":"Input",default:Gl.value}}}}}}}}}}}},registerTransform:(e,t,n)=>{try{const{color:r,size:o,label:i,advanced:a,status:s}=pl()(Pl,t.props||{});let l=!1;Object.is(a)||(l=!0);const{halo:u}=l?Pl.advanced:a,d=e.map((e=>{const t=e.data||e.properties||e,l=Object.assign(Object.assign({},a.keyshape),{fill:r,stroke:r,size:o});a.keyshape=l;const d=((e,t)=>t.map((t=>{const[n,r]=t.split("^^"),[o,i]=t.split(".");return e[r||i||"id"]})).filter((e=>e)).join("\n"))(t,i),p=((e,t)=>{const{keyshape:n}=e;if(!e.icon||!n)return{};const r=Object.assign({},e.icon),{value:o}=r;return r.visible?"image"===r.type?{fill:"transparent",size:[n.size,n.size],type:"image",clip:{r:n.size/2},value:o}:"font"===r.type?Object.assign(Object.assign({},r),{size:n.size/2,type:"font",fontFamily:"iconfont",value:c.icons[o]||"",fill:r.fill||n.fill}):"text"===r.type?Object.assign(Object.assign({},r),{fontSize:n.size/4,fill:"#fff",value:o}):Object.assign({},r):Object.assign(Object.assign({},r),{visible:!1,value:""})})(a),f=((e,t)=>{const{badge:n,keyshape:r}=e;if(!n||!r)return[];const{visible:o,value:i,color:a}=n;if(o){const e=Math.round(r.size/3),o=e/2;return n.size=e,n.stroke=a||r.stroke,"mapping"===n.type?[{type:"text",size:e,stroke:r.stroke,fill:"#fff",color:r.fill,visible:Boolean(t[i]),value:t[i],fontSize:o}]:("font"===n.type&&(n.type="font",n.fontFamily="graphin",n.value=c.icons[i]||""),"text"===n.type&&(n.fill="#fff",n.color=a||r.fill,n.value=i,n.fontSize=o),[n])}return[]})(a,t),h=Object.assign(Object.assign({},a.label),{value:a.label.visible?d:""});let m=e&&e.style||{};n&&(m={});const g={keyshape:l,label:h,icon:p,halo:u,badges:f,status:Object.assign(Object.assign(Object.assign({},Nl),s),{highlight:{keyshape:{lineWidth:4,fillOpacity:.6}},active:{halo:{visible:!0},keyshape:{lineWidth:5}},query_start:{halo:{visible:!0,stroke:r,lineWidth:4,lineDash:[8,8]}},query_normal:{halo:{visible:!0,stroke:r,lineWidth:1,lineDash:[8,8]}}})};return Object.assign(Object.assign({},e),{id:e.id,data:t,nodeType:e.nodeType||"UNKNOW",type:"graphin-circle",style:pl()(g,m)})}));return d}catch(t){return console.error("parse transform error:",t),e}}},Bl={info:{id:"Circular",options:{type:"circular"},name:"圆形布局",category:"basic",type:"LAYOUT",desc:"圆形布局",icon:"icon-layout-circular",cover:"http://xxxx.jpg"},registerLayout:e=>{},registerMeta:e=>({radius:{type:"number",title:"半径","x-decorator":"FormItem","x-component":"NumberPicker","x-component-props":{step:1},default:300},divisions:{type:"number",title:"分段数","x-decorator":"FormItem","x-component":"NumberPicker","x-component-props":{step:1},default:1},ordering:{type:"string",title:"排序依据","x-decorator":"FormItem","x-component":"Select","x-component-props":{options:[{label:"Null",value:null},{label:"topology",value:"topology"},{label:"degree",value:"degree"}]},default:null},preventOverlap:{type:"switch",title:"防止重叠","x-decorator":"FormItem","x-component":"Switch",default:!0}})},zl={info:{id:"Concentric",options:{type:"concentric"},name:"同心圆布局",category:"basic",type:"LAYOUT",desc:"根据节点度数，可按照同心圆排布",icon:"icon-layout-concentric",cover:"http://xxxx.jpg"},registerLayout:e=>{},registerMeta:e=>({sortBy:{type:"string",title:"排序依据","x-decorator":"FormItem","x-component":"Select","x-component-props":{options:[{label:"Null",value:null},{label:"topology",value:"topology"},{label:"degree",value:"degree"}]},default:null},nodeSize:{type:"number",title:"节点大小","x-decorator":"FormItem","x-component":"NumberPicker","x-component-props":{step:1},default:80},minNodeSpacing:{type:"number",title:"最小间距","x-decorator":"FormItem","x-component":"NumberPicker","x-component-props":{step:1},default:40},equidistant:{type:"boolean",title:"是否等间距","x-decorator":"FormItem","x-component":"Switch",default:!0},preventOverlap:{type:"boolean",title:"防止重叠","x-decorator":"FormItem","x-component":"Switch",default:!0}})};var $l=u(835),ql=u.n($l);function Ul(e,t){for(var n in t)t.hasOwnProperty(n)&&"constructor"!==n&&void 0!==t[n]&&(e[n]=t[n])}const Vl=e=>function(t,n){const r=e.split(".");let o=0,i=0;return 1===r.length?(o=t[e],i=n[e]):(o=t[r[0]][r[1]],i=n[r[0]][r[1]]),o-i},Hl={info:{id:"ClusteringDagre",options:{type:"clusteringDagre"},name:"聚类分层布局",category:"basic",type:"LAYOUT",desc:"可聚类的有向分层布局",icon:"icon-layout-tree",cover:"http://xxxx.jpg"},registerLayout:e=>{e.registerLayout("clusteringDagre",{init(e){this.nodes=e.nodes,this.edges=e.edges},execute(){const e=this,{nodes:t,edges:n}=e,r={},o={};let i="nodeType";e.clusterAttr&&(i=e.clusterAttr),t.forEach((e=>{e.clusterAttr=e.data.properties?e.data.properties[i]:e.data[i]||e.nodeType,r[e.clusterAttr]?(r[e.clusterAttr].count++,r[e.clusterAttr].nodes.push(e)):r[e.clusterAttr]={count:1,indegree:0,outdegree:0,innerdegree:0,targetNeighbors:{},sourceNeighbors:{},nodes:[e],nodeType:e.nodeType,clusterAttr:e.clusterAttr},o[e.id]=e}));const a={},s={};if(n.forEach((e=>{s[e.source]?s[e.source].push(e.target):s[e.source]=[e.target],s[e.target]?s[e.target].push(e.source):s[e.target]=[e.source];const t=o[e.source],n=o[e.target];if(!t||!n)return;if(t.clusterAttr===n.clusterAttr)return void r[t.clusterAttr].innerdegree++;const i=r[t.clusterAttr],l=r[n.clusterAttr];i.outdegree++,i.targetNeighbors[n.clusterAttr]=1,l.indegree++,l.sourceNeighbors[t.clusterAttr]=1;const c=`${t.clusterAttr}|||${n.clusterAttr}`;a[c]?a[c]++:a[c]=1})),i){const e=Object.keys(r),t=(e,t)=>e!==r[e].nodeType&&t===r[t].nodeType?-1:e===r[e].nodeType&&t!==r[t].nodeType?1:isNaN(e)||isNaN(t)?r[e].nodes.length-r[t].nodes.length:Number(e)-Number(t);e.sort(t),e.forEach(((e,t)=>{r[e].rank=t}))}else{let t,n=1/0,o=[];Object.keys(r).forEach((e=>{0===r[e].indegree&&0===r[e].outdegree?(o.push(e),r[e].rank=0):r[e].indegree<n&&(n=r[e].indegree,t=e)})),o.push(t),Object.keys(r).forEach((e=>{r[e].indegree===n&&(e!==t&&o.push(e),r[e].rank=0)})),e.calcLevels(o,0,r,o.length)}const l=[];Object.keys(r).forEach((e=>{const t=r[e];l[t.rank]?l[t.rank].push(t):l[t.rank]=[t],t.nodes.forEach((e=>{e.cDagreLayoutInfo={rank:t.rank}}))})),e.sugiyamaGroup(l,a),e.sugiyamaNode(l,r,s,o);const c=e.width||500,u=e.height||500;let d=-1/0;if(l.forEach((e=>{let t=0;e.forEach((e=>{t+=e.nodes.length})),d<t&&(d=t)})),t.forEach((t=>{const{posIdx:n}=t.cDagreLayoutInfo;t.cDagreLayoutInfo.line=Math.floor(n/e.wrapThreshold),t.cDagreLayoutInfo.linePosIdx=n%e.wrapThreshold})),e.radial){const n=[c/2,u/2],r=e.ranksep?e.ranksep:.4*Math.min(c,u)/l.length||50;t.forEach((e=>{const{rank:t,posIdx:o}=e.cDagreLayoutInfo,i=(t+1)*r,a=2*Math.PI*o/d;e.x=i*Math.cos(a)+n[0],e.y=i*Math.sin(a)+n[1]}))}else{const n=e.begin||[50,50],r=e.rankdir?e.rankdir:"TB";let o=e.ranksep,i=e.nodesep;"TB"===r||"BT"===r?(o||(o=.8*u/l.length||150),i||(i=.8*c/d||150)):"LR"!==r&&"RL"!==r||(o||(o=.8*c/l.length||150),i||(i=.8*u/d||150));const a=e.wrapLineHeight;t.forEach((e=>{switch(r){case"TB":e.x=n[0]+i*e.cDagreLayoutInfo.linePosIdx,e.y=n[1]+o*e.cDagreLayoutInfo.rank+a*e.cDagreLayoutInfo.line;break;case"BT":e.x=n[0]+i*e.cDagreLayoutInfo.linePosIdx,e.y=u-(n[1]+o*e.cDagreLayoutInfo.rank+a*e.cDagreLayoutInfo.line);break;case"LR":e.x=n[0]+o*e.cDagreLayoutInfo.rank+a*e.cDagreLayoutInfo.line,e.y=n[1]+i*e.cDagreLayoutInfo.linePosIdx;break;case"RL":e.x=c-(n[0]+o*e.cDagreLayoutInfo.rank+a*e.cDagreLayoutInfo.line),e.y=n[1]+i*e.cDagreLayoutInfo.linePosIdx}}))}if(e.postForce){const e=new(ql().Layout.forceAtlas2)({center:[c/2,u/2],preventOverlap:!0,kr:15,maxIteration:50});e.init({nodes:t,edges:n}),e.execute()}},sugiyamaNode(e,t,n,r){Object.keys(t).forEach((e=>{const n=t[e];t[e].nodes.forEach(((e,t)=>{e.cDagreLayoutInfo.posIdx=n.beginIdx+t}))})),e.forEach(((t,o)=>{o!==e.length-1&&t.forEach((e=>{e.nodes.forEach(((t,o)=>{const i=n[t.id];let a=0,s=0;i&&i.forEach((t=>{const n=r[t];n.cDagreLayoutInfo.rank===e.rank+1&&(a+=n.cDagreLayoutInfo.posIdx,s++)})),t.cDagreLayoutInfo.posIdx=a/s||o}))}))}));for(let t=e.length-1;t>=0;t--)0!==t&&e[t].forEach((e=>{e.nodes.forEach(((t,o)=>{const i=n[t.id];let a=0,s=0;i&&i.forEach((t=>{const n=r[t];n.cDagreLayoutInfo.rank===e.rank-1&&(a+=n.cDagreLayoutInfo.posIdx,s++)})),t.cDagreLayoutInfo.posIdx=a/s||o}))}));Object.keys(t).forEach((e=>{const n=t[e].nodes;n.sort(Vl("cDagreLayoutInfo.posIdx"));const r=t[e].beginIdx;n.forEach(((e,t)=>{e.cDagreLayoutInfo.posIdx=r+t}))}))},sugiyamaGroup(e,t){const n=e.length;e.forEach(((r,o)=>{if(o===n-1);else{const n=e[o+1];r.forEach(((e,r)=>{let o=0,i=1;n.forEach(((n,r)=>{const a=`${e.clusterAttr}|||${n.clusterAttr}`;t[a]&&(i+=n.posIdx||r,o++)})),i/=2*o,e.posIdx=i||r}))}}));for(let r=n-1;r>=0;r--){if(0===r)continue;const n=e[r],o=e[r-1];n.forEach(((e,n)=>{let r=0,i=1;o.forEach(((n,o)=>{const a=`${e.clusterAttr}|||${n.clusterAttr}`;t[a]&&(i+=n.posIdx||o,r++)})),i/=2*r,e.posIdx=i||n}))}e.forEach((e=>{e.sort(Vl("posIdx"));let t=0;e.forEach((e=>{const n=e.nodes.length;e.posIdx=Math.round(t+n/2),e.beginIdx=t,e.endIdx=t+n,t=e.endIdx+1}))}))},calcLevels(e,t,n,r){if(r>=Object.keys(n).length)return;let o=[];e.forEach((e=>{o=o.concat(Object.keys(n[e].sourceNeighbors).concat(Object.keys(n[e].targetNeighbors)))}));for(let e=o.length-1;e>=0;e--)isNaN(n[o[e]].rank)?n[o[e]].rank=t+1:o.splice(e,1);this.calcLevels(o,t+1,n,o.length?r+o.length:1/0)},layout(e){this.init(e),this.execute()},updateCfg(e){var t,n;t=this,(n=e)&&Ul(t,n)},destroy(){const e=this;e.positions=null,e.nodes=null,e.edges=null,e.destroyed=!0}})},registerMeta:e=>{const{keys:t}=e,n=t.filter((e=>"nodeTypeKeyFromProperties"!==e));return{rankdir:{type:"string",title:"布局方向","x-decorator":"FormItem","x-component":"Select","x-component-props":{options:[{label:"自上而下",value:"TB"},{label:"自下而上",value:"BT"},{label:"自左而右",value:"LR"},{label:"自右而左",value:"RL"}]},default:"TB"},clusterAttr:{type:"string",title:"分层依据","x-decorator":"FormItem","x-component":"Select","x-component-props":{options:n.map((e=>({label:e,value:e})))},default:"nodeType"},wrapThreshold:{type:"number",title:"每层节点上限","x-decorator":"FormItem","x-component":"NumberPicker","x-component-props":{step:1},default:20},wrapLineHeight:{type:"number",title:"同层节点换行后多行之间的间距","x-decorator":"FormItem","x-component":"NumberPicker","x-component-props":{step:1},default:30},align:{type:"string",title:"对齐方式","x-decorator":"FormItem","x-component":"Select","x-component-props":{options:[{label:"Null",value:null},{label:"UL",value:"UL"},{label:"UR",value:"UR"},{label:"DL",value:"DL"},{label:"DR",value:"DR"}]},default:null},nodesep:{type:"number",title:"节点间距","x-decorator":"FormItem","x-component":"NumberPicker","x-component-props":{step:1},default:40},ranksep:{type:"number",title:"层间距","x-decorator":"FormItem","x-component":"NumberPicker","x-component-props":{step:1},default:80}}}},Wl={info:{id:"Dagre",options:{type:"dagre"},name:"有向分层",category:"basic",type:"LAYOUT",desc:"节点按照边的流向排布",icon:"icon-layout-tree",cover:"http://xxxx.jpg"},registerLayout:e=>{},registerMeta:e=>({rankdir:{type:"string",title:"布局方向","x-decorator":"FormItem","x-component":"Select","x-component-props":{options:[{label:"自上而下",value:"TB"},{label:"自下而上",value:"BT"},{label:"自左而右",value:"LR"},{label:"自右而左",value:"RL"}]},default:"TB"},align:{type:"string",title:"对齐方式","x-decorator":"FormItem","x-component":"Select","x-component-props":{options:[{label:"Null",value:null},{label:"UL",value:"UL"},{label:"UR",value:"UR"},{label:"DL",value:"DL"},{label:"DR",value:"DR"}]},default:null},nodesep:{type:"number",title:"节点间距","x-decorator":"FormItem","x-component":"NumberPicker","x-component-props":{step:1},default:40},ranksep:{type:"number",title:"层间距","x-decorator":"FormItem","x-component":"NumberPicker","x-component-props":{step:1},default:80}})},Kl={info:{id:"Force2",options:{type:"force2",animate:!1,preset:{type:"concentric",width:800,height:800,minNodeSpacing:10,nodeSize:10},clusterNodeStrength:35,minMovement:10,damping:.8,maxSpeed:1e3,distanceThresholdMode:"max"},name:"渐进力导(force2)",category:"basic",type:"LAYOUT",desc:"渐进式力导布局，可用于动态布局",icon:"icon-layout-force",cover:"http://xxxx.jpg"},registerLayout:e=>{},registerMeta:e=>{var t,n,r,o;return{stiffness:{type:"edgeStrength",title:"边引力系数","x-decorator":"FormItem","x-component":"NumberPicker","x-component-props":{step:1},default:200},nodeStrength:{title:"节点间斥力系数",type:"number","x-decorator":"FormItem","x-component":"NumberPicker","x-component-props":{},default:1e3},damping:{title:"阻尼系数",type:"number","x-decorator":"FormItem","x-component":"NumberPicker","x-component-props":{step:.1,min:0,max:1},default:.8},animate:{title:"启用动画",type:"boolean","x-decorator":"FormItem","x-component":"Switch",default:!((null===(n=null===(t=e.data)||void 0===t?void 0:t.nodes)||void 0===n?void 0:n.length)>800)},preset:{type:"object",properties:{type:{type:"string",title:"前置布局","x-component":"Select","x-decorator":"FormItem","x-component-props":{options:[{label:"网格布局",value:"grid"},{label:"环形布局",value:"circular"},{label:"同心圆布局",value:"concentric"},{label:"有向分层",value:"dagre"}]},default:"concentric"},width:{title:"预设布局宽度",type:"number","x-decorator":"FormItem","x-component":"NumberPicker",default:800},height:{title:"预设布局高度",type:"number","x-decorator":"FormItem","x-component":"NumberPicker",default:800}}},defSpringLenCfg:{type:"object",properties:{minLimitDegree:{title:"最小界限度数",type:"number","x-decorator":"FormItem","x-component":"NumberPicker",default:5},maxLimitLength:{title:"最大限制边长",type:"number","x-decorator":"FormItem","x-component":"NumberPicker",default:500},defaultSpring:{title:"默认边长",type:"number","x-decorator":"FormItem","x-component":"NumberPicker",default:100}}},clusterNodeStrength:{title:"节点聚类力强度",type:"number","x-decorator":"FormItem","x-component":"NumberPicker","x-component-props":{},default:35},minMovement:{title:"迭代停止最小距离",type:"number","x-decorator":"FormItem","x-component":"NumberPicker","x-component-props":{},default:(null===(o=null===(r=e.data)||void 0===r?void 0:r.nodes)||void 0===o?void 0:o.length)>200?10:2},distanceThresholdMode:{title:"迭代停止判断依据",type:"string","x-component":"Select","x-decorator":"FormItem","x-component-props":{options:[{label:"平均值",value:"mean"},{label:"最小值",value:"min"},{label:"最大值",value:"max"}]},default:"max"},maxSpeed:{title:"初始速度",type:"number","x-decorator":"FormItem","x-component":"NumberPicker","x-component-props":{},default:1e3},centripetalOptions:{type:"object",properties:{leaf:{title:"叶子节点",type:"number","x-decorator":"FormItem","x-component":"NumberPicker",default:2},single:{title:"孤立节点",type:"number","x-decorator":"FormItem","x-component":"NumberPicker",default:2},others:{title:"其他节点",type:"number","x-decorator":"FormItem","x-component":"NumberPicker",default:1}}}}}},Yl={info:{id:"FundForce",options:{type:"graphin-force",animation:!0,preset:{type:"concentric"}},name:"资金力导",category:"basic",type:"LAYOUT",desc:"基于节点字段大小的垂直力导布局",icon:"icon-layout-force",cover:"http://xxxx.jpg"},registerLayout:e=>{},registerMeta:({keys:e,schemaData:t})=>{var n,r;const o=t.nodes.reduce(((e,t)=>Object.assign(Object.assign({},e),t.properties)),{}),i=e.filter((e=>"number"===o[e])).map((e=>({label:e,value:e})));return{income:{title:"流入资金","x-component":"Select","x-decorator":"FormItem","x-component-props":{options:i},default:null===(n=i[0])||void 0===n?void 0:n.value},outcome:{title:"流出资金","x-component":"Select","x-decorator":"FormItem","x-component-props":{options:i},default:null===(r=i[0])||void 0===r?void 0:r.value},isLog:{title:"log 映射",type:"boolean","x-decorator":"FormItem","x-component":"Switch",default:!0},multiple:{title:"倍数映射",type:"string","x-decorator":"FormItem","x-component":"Input",default:"0.1"}}}},Xl={info:{id:"GraphinForce",options:{type:"graphin-force",animation:!1,preset:{type:"concentric"}},name:"力导布局",category:"basic",type:"LAYOUT",desc:"渐进式力导布局，可用于动态布局",icon:"icon-layout-force",cover:"http://xxxx.jpg"},registerLayout:e=>{},registerMeta:e=>({stiffness:{type:"number",title:"弹簧劲度系数","x-decorator":"FormItem","x-component":"NumberPicker","x-component-props":{step:1},default:200},repulsion:{title:"库伦常量Ke（斥力）",type:"number","x-decorator":"FormItem","x-component":"NumberPicker","x-component-props":{},default:1e3},damping:{title:"阻尼系数",type:"number","x-decorator":"FormItem","x-component":"NumberPicker","x-component-props":{step:.1,min:0,max:1},default:.9},animation:{title:"启用动画",type:"boolean","x-decorator":"FormItem","x-component":"Switch",default:!0},preset:{type:"object",properties:{type:{type:"string",title:"前置布局","x-component":"Select","x-decorator":"FormItem","x-component-props":{options:[{label:"网格布局",value:"grid"},{label:"环形布局",value:"circular"},{label:"同心圆布局",value:"concentric"},{label:"有向分层",value:"dagre"}]},default:"concentric"}}},defSpringLenCfg:{type:"object",properties:{minLimitDegree:{title:"最小界限度数",type:"number","x-decorator":"FormItem","x-component":"NumberPicker",default:5},maxLimitLength:{title:"最大限制边长",type:"number","x-decorator":"FormItem","x-component":"NumberPicker",default:500},defaultSpring:{title:"默认边长",type:"number","x-decorator":"FormItem","x-component":"NumberPicker",default:100}}},centripetalOptions:{type:"object",properties:{leaf:{title:"叶子节点",type:"number","x-decorator":"FormItem","x-component":"NumberPicker",default:2},single:{title:"孤立节点",type:"number","x-decorator":"FormItem","x-component":"NumberPicker",default:2},others:{title:"其他节点",type:"number","x-decorator":"FormItem","x-component":"NumberPicker",default:1}}}})},Ql={info:{id:"Grid",options:{type:"grid"},name:"网格布局",category:"basic",type:"LAYOUT",desc:"节点按照网格排布",icon:"icon-layout-grid-fill",cover:"http://xxxx.jpg"},registerLayout:e=>{},registerMeta:e=>({rows:{type:"number",title:"网格行数","x-decorator":"FormItem","x-component":"NumberPicker","x-component-props":{step:1}},cols:{type:"slider",title:"网格列数","x-decorator":"FormItem","x-component":"NumberPicker","x-component-props":{step:1}},sortBy:{type:"select",title:"排序依据","x-decorator":"FormItem","x-component":"Select","x-component-props":{options:[{label:"null",value:null},{label:"topology",value:"topology"},{label:"degree",value:"degree"}]},default:null}})},Jl={info:{id:"Radial",options:{type:"radial"},name:"径向布局",category:"basic",type:"LAYOUT",desc:"辐射布局",icon:"icon-layout-radial",cover:"http://xxxx.jpg"},registerLayout:e=>{},registerMeta:e=>({unitRadius:{type:"number",title:"层级距离","x-decorator":"FormItem","x-component":"NumberPicker","x-component-props":{step:1},default:200},linkDistance:{type:"number",title:"边长","x-decorator":"FormItem","x-component":"NumberPicker",default:200},nodeSize:{type:"number",title:"节点大小","x-decorator":"FormItem","x-component":"NumberPicker",default:60},focusNode:{type:"string",title:"中心节点","x-decorator":"FormItem","x-component":"Select"},nodeSpacing:{type:"number",title:"节点间距","x-decorator":"FormItem","x-component":"NumberPicker","x-component-props":{},default:30},preventOverlap:{type:"boolean",title:"防止重叠","x-decorator":"FormItem","x-component":"Switch",default:!0},strictRadial:{type:"boolean",title:"严格辐射","x-decorator":"FormItem","x-component":"Switch",default:!0}})};var Zl=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{l(r.next(e))}catch(e){i(e)}}function s(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))};const{getServerEngineContext:ec}=c.utils,tc={name:"初始化查询",method:"GET",req:"",res:"\n  export interface GIGraphData {\n    nodes: {\n      // 节点ID\n      id: string;\n      // 节点类型的枚举值。Property Graph 也称之为 node.label\n      nodeType: string;\n      // 业务数据,注意需要打平,暂不支持嵌套\n      data: {};\n      // 业务数据（data）中的哪个字段，用来映射节点类型\n      nodeTypeKeyFromProperties?: string;\n    }[];\n    edges: {\n      // 边ID\n      id: string;\n      // 边关联的 source 节点ID\n      source: string;\n      // 边关联的 target 节点ID\n      target: string;\n      // 边类型的枚举值。Property Graph 也称之为 edge.label\n      edgeType: string;\n      // 业务数据,注意需要打平,暂不支持嵌套\n      data: {};\n      // 业务数据（data）中的哪个字段，用来映射边类型\n      edgeTypeKeyFromProperties?: string;\n    }[];\n  }\n  ",service:()=>Zl(void 0,void 0,void 0,(function*(){ec();try{const{LOCAL_DATA_FOR_GI_ENGINE:e}=window;return e.data}catch(e){return{nodes:[],edges:[]}}}))},nc={name:"查询图模型",method:"GET",req:"",res:"\n export interface GraphSchemaData {\n  nodes: {\n    /** 节点类型 */\n    nodeType: string;\n    /** 节点类型，通过业务数据（data）中的哪个字段映射的 */\n    nodeTypeKeyFromProperties: string;\n    /** 业务数据（data）中的字段类型，目前不支持嵌套 */\n    properties: {\n      [key: string]: 'string' | 'number' | 'date';\n    };\n  }[];\n  edges: {\n    /** 边类型 */\n    edgeType: string;\n    /** 边类型，通过业务数据（data）中的哪个字段映射的 */\n    edgeTypeKeyFromProperties: string;\n    /** 边上开端节点类型 */\n    sourceNodeType?: string;\n    /** 边上目标节点类型 */\n    targetNodeType?: string;\n    /** 业务数据（data）中的字段类型，目前不支持嵌套 */\n    properties: {\n      [key: string]: 'string' | 'number' | 'date';\n    };\n  }[];\n  /** Schema 额外配置信息 */\n  meta?: {\n    /** 默认的标签映射字段 */\n    defaultLabelField: string;\n  };\n}\n",service:()=>Zl(void 0,void 0,void 0,(function*(){try{const{LOCAL_DATA_FOR_GI_ENGINE:e}=window;return e.schemaData}catch(e){return{nodes:[],edges:[]}}}))},rc={name:"邻居查询",method:"POST",req:"\n  export interface ReqNeighborsQuery {\n    //扩散的节点，是个节点ID数组\n    ids: string[];\n    //扩散的节点的全部信息\n    nodes: any[];\n    //扩散的度数\n    sep: number;\n  }  \n  ",res:"\n  export interface GIGraphData {\n    nodes: {\n      // 节点ID\n      id: string;\n      // 节点类型的枚举值。Property Graph 也称之为 node.label\n      nodeType: string;\n      // 业务数据,注意需要打平,暂不支持嵌套\n      data: {};\n      // 业务数据（data）中的哪个字段，用来映射节点类型\n      nodeTypeKeyFromProperties?: string;\n    }[];\n    edges: {\n      // 边ID\n      id: string;\n      // 边关联的 source 节点ID\n      source: string;\n      // 边关联的 target 节点ID\n      target: string;\n      // 边类型的枚举值。Property Graph 也称之为 edge.label\n      edgeType: string;\n      // 业务数据,注意需要打平,暂不支持嵌套\n      data: {};\n      // 业务数据（data）中的哪个字段，用来映射边类型\n      edgeTypeKeyFromProperties?: string;\n    }[];\n  }\n  ",service:e=>{const{ids:t,nodes:n}=e,r=n.map((e=>{const{id:t,nodeType:n}=e;return{nodes:[{id:t,nodeType:n},{id:`${t}-1`,nodeType:n},{id:`${t}-2`,nodeType:n},{id:`${t}-3`,nodeType:n}],edges:[{source:t,target:`${t}-1`},{source:t,target:`${t}-2`},{source:t,target:`${t}-3`}]}})).reduce(((e,t)=>({nodes:[].concat(e.nodes,t.nodes),edges:[].concat(e.edges,t.edges)})),{nodes:[],edges:[]});return new Promise((e=>e((e=>{const{nodes:t,edges:n}=e;return{nodes:t.map((e=>({id:e.id,nodeType:e.nodeType,data:e}))),edges:n.map(((e,t)=>({source:e.source,target:e.target,id:`${e.source}-${e.target}-${t}`,data:e,edgeType:"UNKOWN"})))}})(r))))}},oc={name:"查询属性详情",req:"\n  export interface ReqPropertiesPanel {\n    /** 节点 或者 边的详细信息 */\n    data: any;\n  }\n  ",res:"\n  export interface ResPropertiesPanel {\n    /** 节点 或 边的详细信息 */\n    [key: string]: any;\n  }\n  ",service:e=>{const{data:t}=e;return new Promise((e=>e(t)))}},ic={name:"保存分享",req:"\n  export interface SaveReqParams {\n    /** 保存的名称 */\n    name: string;\n    /** 保存的描述 */\n    description: string;\n    /** 保存的数据，带布局信息 **/\n    data: GraphinData;\n    /** GISDK的配置，可以还原画布状态 */\n    config: GIConfig;\n    /** 图的 Schema 结构 */\n    schemaData: GraphSchemaData;\n    /** 画布的截图 */\n    cover: string;\n    /** 保存的时间 */\n    gmtCreate: Date;\n  }\n  ",res:"\n  export interface SaveResParams {\n    /** 保存是否成功 */\n    success: boolean;\n    /** 保存跳转的URL地址 **/\n    data: string;\n    /** 保存后，生成的UUID */\n    shareId: string;\n  }\n  ",service:(e,t)=>{const n=`rp_${Math.random().toString(36).substr(2)}`,r=window.location.origin+"/#/share/"+n,{GI_REPORT_DB:o}=window;return o.setItem(n,{id:n,type:"save",params:JSON.stringify(e)}),new Promise((e=>e({success:!0,data:r,shareId:n})))}};const ac={name:"水印服务",req:"",res:"\n  export interface WatermarkResParams {\n    /** 保存是否成功 */\n    success: boolean;\n    /** 信息提示 **/\n    msg: string;\n    /** 返回数据 */\n    data: {\n      /** 水印文字内容 */\n      content ?: string[] | string;\n      /** 水印图片源\n       * 注意：优先级 image > content, 当使用图片水印且图片加载异常, 会使用 content */\n      image ?: string;\n    }\n  }\n  ",service:()=>function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{l(r.next(e))}catch(e){i(e)}}function s(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))}(void 0,void 0,void 0,(function*(){const{GI_USER_INFO:e}=window;let t={content:"这是一行水印"};if(e){const{realName:n,outUserNo:r,nickName:o}=e;t={content:`${n}(${o})${r}`}}return{success:!0,msg:"获取水印成功！",data:t}}))},sc={id:"GI",type:"file",name:"GraphJSON",desc:"G6VP 官方提供的本地文件导入服务，根据部署环境的不同，可以将数据存储在浏览器 IndexDB 或者 云端服务器中",cover:"https://gw.alipayobjects.com/mdn/rms_0d75e8/afts/img/A*3YEZS6qSRgAAAAAAAAAAAAAAARQnAQ",services:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},i),o),r),a),s)},{nodes:lc,edges:cc,layout:uc,components:dc}=c.template,pc={nodes:lc,edges:cc,layout:uc,components:[...dc,{id:"GremlinQuery",type:"GIAC_CONTENT",name:"Gremlin 查询",props:{serviceId:"GraphScope/GremlinQuery",isShowPublishButton:!1,saveTemplateServceId:"GI/PublishTemplate",initialValue:"g.V().limit(10)",height:200,GI_CONTAINER_INDEX:2,GIAC_CONTENT:{visible:!1,disabled:!1,isShowTitle:!0,title:"Gremlin",isShowIcon:!0,icon:"icon-query",isShowTooltip:!0,tooltip:"",tooltipColor:"#3056e3",tooltipPlacement:"right",hasDivider:!1,height:"60px",isVertical:!0,containerType:"div",containerAnimate:!1,containerPlacement:"RT",offset:[0,0],containerWidth:"350px",containerHeight:"calc(100% - 100px)",contaienrMask:!1}}},{id:"TableMode",type:"GIAC_CONTENT",name:"表格模式",props:{enableCopy:!0,isSelectedActive:!0,GI_CONTAINER_INDEX:2,GIAC_CONTENT:{visible:!1,disabled:!1,isShowTitle:!0,title:"表格模式",isShowIcon:!0,icon:"icon-table",isShowTooltip:!0,tooltip:"将画布中的节点和边以表格形式展示",tooltipColor:"#3056e3",tooltipPlacement:"right",hasDivider:!1,height:"60px",isVertical:!0,containerType:"div",containerAnimate:!1,containerPlacement:"RT",offset:[0,0],containerWidth:"400px",containerHeight:"calc(100% - 100px)",contaienrMask:!1}}},{id:"JSONMode",type:"GIAC_CONTENT",name:"代码模式",props:{theme:"rjv-default",GI_CONTAINER_INDEX:2,GIAC_CONTENT:{visible:!1,disabled:!1,isShowTitle:!0,title:"代码模式",isShowIcon:!0,icon:"icon-table",isShowTooltip:!0,tooltip:"将数据以代码形式展示",tooltipColor:"#3056e3",tooltipPlacement:"right",hasDivider:!1,height:"60px",isVertical:!0,containerType:"div",containerAnimate:!1,containerPlacement:"RT",offset:[0,0],containerWidth:"400px",containerHeight:"calc(100% - 100px)",contaienrMask:!1}}},{id:"SideTabs",type:"GICC",name:"侧边栏",props:{GI_CONTAINER:["FilterPanel","NodeImportance","CommunityDetection","PatternMatch"],outSideFromCanvas:!0,tabPosition:"left",defaultVisible:!0,placement:"LB",offset:[0,0],height:"400px",width:"400px"}},{id:"StructAnalysis",type:"GIAC_CONTENT",name:"路径结构分析",props:{GI_CONTAINER_INDEX:2,GIAC_CONTENT:{visible:!1,disabled:!1,isShowTitle:!0,title:"路径结构分析",isShowIcon:!0,icon:"icon-layout-tree",isShowTooltip:!0,tooltip:"自动解析画布所有路径，做聚合分析",tooltipColor:"#3056e3",tooltipPlacement:"right",hasDivider:!1,height:"60px",isVertical:!0,containerType:"div",containerAnimate:!1,containerPlacement:"RT",offset:[0,0],containerWidth:"400px",containerHeight:"calc(100% - 100px)",contaienrMask:!1}}},{id:"InfoDetection",type:"GIAC_CONTENT",name:"信息检测",props:{GI_CONTAINER_INDEX:2,GIAC_CONTENT:{visible:!1,disabled:!1,isShowTitle:!1,title:"信息检测",isShowIcon:!0,icon:"icon-infomation",isShowTooltip:!0,tooltip:"检测画布中孤立点、环等",tooltipColor:"#3056e3",tooltipPlacement:"right",hasDivider:!1,height:"60px",isVertical:!0,containerType:"div",containerAnimate:!1,containerPlacement:"RT",offset:[0,0],containerWidth:"400px",containerHeight:"calc(100% - 100px)",contaienrMask:!1}}},{id:"NodeImportance",type:"GIAC_CONTENT",name:"节点重要性",props:{GI_CONTAINER_INDEX:2,GIAC_CONTENT:{visible:!1,disabled:!1,isShowTitle:!1,title:"节点重要性",isShowIcon:!0,icon:"icon-rules",isShowTooltip:!0,tooltip:"",tooltipColor:"#3056e3",tooltipPlacement:"right",hasDivider:!1,height:"60px",isVertical:!0,containerType:"div",containerAnimate:!1,containerPlacement:"RT",offset:[0,0],containerWidth:"350px",containerHeight:"calc(100% - 100px)",contaienrMask:!1}}},{id:"CommunityDetection",type:"GIAC_CONTENT",name:"社区发现",props:{GI_CONTAINER_INDEX:2,GIAC_CONTENT:{visible:!1,disabled:!1,isShowTitle:!1,title:"社区发现",isShowIcon:!0,icon:"icon-associate",isShowTooltip:!0,tooltip:"",tooltipColor:"#3056e3",tooltipPlacement:"right",hasDivider:!1,height:"60px",isVertical:!0,containerType:"div",containerAnimate:!1,containerPlacement:"RT",offset:[0,0],containerWidth:"350px",containerHeight:"calc(100% - 100px)",contaienrMask:!1}}},{id:"PatternMatch",type:"GIAC_CONTENT",name:"模式匹配",props:{GI_CONTAINER_INDEX:2,GIAC_CONTENT:{visible:!1,disabled:!1,isShowTitle:!1,title:"模式匹配",isShowIcon:!0,icon:"icon-query-path",isShowTooltip:!0,tooltip:"",tooltipColor:"#3056e3",tooltipPlacement:"right",hasDivider:!1,height:"60px",isVertical:!0,containerType:"div",containerAnimate:!1,containerPlacement:"RT",offset:[0,0],containerWidth:"350px",containerHeight:"calc(100% - 100px)",contaienrMask:!1}}},{id:"CypherQuery",type:"GIAC_CONTENT",name:"Cypher 语句查询",props:{serviceId:"TuGraph/CypherQuery",isShowPublishButton:!1,saveCypherTemplateServceId:"GI/PublishTemplate",initialValue:"MATCH n RETURN LIMIT 100",GI_CONTAINER_INDEX:2,GIAC_CONTENT:{visible:!1,disabled:!1,isShowTitle:!0,title:"Cypher 语句查询",isShowIcon:!0,icon:"icon-query",isShowTooltip:!0,tooltip:"",tooltipColor:"#3056e3",tooltipPlacement:"right",hasDivider:!1,height:"60px",isVertical:!0,containerType:"div",containerAnimate:!1,containerPlacement:"RT",offset:[0,0],containerWidth:"350px",containerHeight:"calc(100% - 100px)",contaienrMask:!1}}},{id:"UadLayout",type:"GICC_LAYOUT",name:"上下布局",props:{containers:[{id:"GI_CONTAINER_TOP",GI_CONTAINER:["GremlinQuery"],height:251,padding:"0px 0px"},{id:"GI_CONTAINER_SIDE",GI_CONTAINER:["JSONMode"],tabPosition:"right"}]}}]},fc={elements:[...pc.nodes.map((e=>e.id)),...pc.edges.map((e=>e.id))],components:[...dc.map((e=>e.id))],layouts:["Force2","Concentric","Dagre","FundForce","GraphinForce"]},hc=Object.assign({name:"查询模版",id:"TP_QUERY",image:"/image/tp_query.png",desc:`以查询语句为主体的模版，包含 ${fc.components.length} 个分析资产，页面布局呈上下分布，最上方集成「Gremlin」或者「Cypher」查询语句，常用于数据库查询场景。`,activeAssetsKeys:fc},pc),mc={id:"SegmentedLayout",name:"分段布局",props:{containers:[{id:"GI_CONTAINER_SIDE",name:"侧边容器",required:!0,GI_CONTAINER:["FilterPanel"],display:!0}]}},gc=[...c.template.components,mc],yc={nodes:c.template.nodes,edges:c.template.edges,layout:c.template.layout,components:gc,pageLayout:mc},vc={elements:[...yc.nodes.map((e=>e.id)),...yc.edges.map((e=>e.id))],components:[...gc.map((e=>e.id))],layouts:["Force2","Concentric","Dagre","FundForce","GraphinForce"]},bc=Object.assign({name:"极简模版",id:"TP_SIMPLE",desc:`该模版是官方提供的极简模版，包含 ${vc.components.length} 个分析资产，提供常见的「交互分析」「筛选看数」等功能，页面布局上，画布展示空间较大，提供沉浸式分析体验`,image:"/image/tp_simple.png",activeAssetsKeys:vc},yc)})(),d})()));